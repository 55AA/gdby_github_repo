"use strict";function NewAddOrderListsController(e,t,i,a,n,s){function o(){e.page={currentPage:1,itemsPerPage:7}}function l(){function t(t){e.dataLists=t.list.list,e.page.total=t.list.total}function o(e){console.log(e)}var l=angular.extend({},{action:"get_new_add_orders",role_id:parseInt(n.get("role_id")),currentPage:e.page.currentPage,itemsPerPage:e.page.itemsPerPage},a);-1!==s&&(l.bd_id=s),i.load("statistics/index","POST",l).then(t,o)}o(),e.$watch("page.currentPage",function(){l()}),e.close=function(){t.close()}}function BackFlowWaterController(e,t,i,a,n){function s(){e.page={currentPage:1,itemsPerPage:7}}function o(){function t(t){e.dataLists=t.list.list,e.page.total=t.list.total}function s(e){console.log(e)}var o=angular.extend({},{action:"get_back_flow_water",role_id:parseInt(i.get("role_id")),currentPage:e.page.currentPage,itemsPerPage:e.page.itemsPerPage},n);a.load("statistics/index","POST",o).then(t,s)}s(),e.$watch("page.currentPage",function(){o()}),e.close=function(){t.close()}}function Analysis(e){function t(){function t(e){if(!e)return null;var t;for(t=0;t<s.length;t++)if(s[t].name===e)return s[t].event;return null}function i(e){return"pageViewStatistics"===e?!0:!1}function a(a){var n=t(a.event);if(n){var s=a.attr,o=a.duration;if(!s&&!o)return void e.jsInterface.onItemClick(n);s=s?function(e){var t;for(t in e)angular.isArray(e[t])||(e[t]=[e[t]]);return JSON.stringify(e)}(s):null,(!o||isNaN(o))&&(o=0),i(n)?e.jsInterface.onEventTime(n,s,o):e.jsInterface.onEventCompute(n,s,o)}}return{send:a}}function i(e,t,i){if(e){var a={};a.event=e,t&&(a.attr=t),i&&(a.duration=i),o.send(a)}}var a="yyx9y0ihl0mfwwyasaoy7kegavl9dztbejrwtj13r5xkc993",n="86ubaqohj3a99moyk6zar0rseamffrf3mwaxuvz46dbuiw0s",s=[{name:"页面访问记录",event:"pageViewStatistics"},{name:"新增下单数",event:"achStatistics_dataStatistics_newOrderNum"},{name:"新增回款流水",event:"achStatistics_dataStatistics_newBackAccount"},{name:"已下单客户数",event:"achStatistics_dataStatistics_orderedConNum"},{name:"未下单客户数",event:"achStatistics_dataStatistics_unorderedConNum"},{name:"业绩统计自选时间段",event:"achStatistics_dataStatistics_custom"},{name:"客户列表筛选",event:"consumerManagement_filter"},{name:"客户列表路线",event:"consumerManagement_PS_route"},{name:"客户列表电话",event:"consumerManagement_PS_phone"},{name:"历史移交记录",event:"consumerManagement_PS_conDetail_conInfo_history"},{name:"客户详情路线",event:"consumerManagement_PS_conDetail_conInfo_addDetail"},{name:"子母店铺切换",event:"consumerManagement_PS_conDetail_conOrder_resFilter"},{name:"客户订单时间筛选",event:"consumerManagement_PS_conDetail_conOrder_timeFilter"},{name:"查看订单详情",event:"consumerManagement_PS_conDetail_conOrder_checkOrderDetail"},{name:"对账管理筛选",event:"consumerManagement_PS_conDetail_checkAccountManagement_orderDetail"},{name:"录入潜在客户",event:"addCon_totalTime"},{name:"与客户信息一致",event:"addCon_consumerInfoCheckout"},{name:"更多-个人中心",event:"more_personalCenter"},{name:"更多-用户手册",event:"more_userSheet"},{name:"更多-离线地图",event:"more_offlineMap"},{name:"更多-检查更新",event:"more_checkUpdate"},{name:"业绩统计模块",event:"achievementStatistics_time"},{name:"客户管理模块",event:"consumerManagement_time"},{name:"添加客户模块",event:"addConsumer_time"},{name:"更多模块",event:"more_time"},{name:"客户拜访",event:"visitList"},{name:"客户订单分析",event:"customer_order_analysis"},{name:"客户拜访bdm界面",event:"bdmUI"}],o=function(e){return e.jsInterface&&e.jsInterface.onItemClick&&e.jsInterface.onEventCompute?t():e.AV.analytics({appId:a,appKey:n,version:"0.0.1",channel:"webApp"})}(e);return{send:i}}angular.module("dachuwang",["ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","infinite-scroll","bootstrapLightbox","chart.js"]).run(["$rootScope","$state","$templateCache","Analysis",function(e,t,i,a){var n=null;e.$on("$stateChangeStart",function(){e.showLoading=!0}),e.$on("$stateChangeSuccess",function(i,s,o,l){var r,c;e.showLoading=!1,e.$broadcast("pageChanged",t.current.data),r=(new Date).getTime(),n&&(c=r-n),c&&a.send("页面访问记录",{pageName:l.name},c),n=r}),i.put("lightbox.html","<div class=modal-body ng-swipe-left=Lightbox.nextImage() ng-swipe-right=Lightbox.prevImage()><div class='close_m_btn' ng-click='Lightbox.closeModal()'><span class='glyphicon glyphicon-remove'></span></div><div class=lightbox-image-container><span class='glyphicon glyphicon-menu-left' ng-show='imglength > 1'  ng-click=Lightbox.nextImage()></span><span class='glyphicon glyphicon-menu-right' ng-show='imglength > 1' ng-click=Lightbox.prevImage()></span><div class=lightbox-image-caption><span>{{    Lightbox.imageCaption}}</span></div><img lightbox-src={{Lightbox.imageUrl}}     class='' alt=\"\"></img></div></div>")}]),window.geoData={callback:null,setAddress:function(e){"string"==typeof e&&(e=JSON.parse(e)),this.callback&&this.callback(e)}},window.callback_function={},angular.module("dachuwang").controller("VisitModifyCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state","$filter",function(e,t,i,a,n,s){var o={init:function(){this.param(),this.scope()},param:function(){e.updateBeforeDate=n.params.date},request:{modify:function(e){t.load("customer_visit/update_visit_date","post",{visit_id:n.params.vid,visit_date:e}).then(function(e){console.log(e)})}},scope:function(){var t=function(){var e=this;if(void 0!=e){e=s("date")(e,"yyyy-MM-dd HH:mm");var t=s("date")(new Date,"yyyy-MM-dd");return t>e?void a.tips({bodyText:"修改日期不能小于当天日期!",actionText:"确定"}):void a.tips({bodyText:"确定修改日期为："+e,actionText:"确定",ok:function(){var t=+new Date(e)/1e3;o.request.modify(t),n.go("page.visit")}})}};e.cellClick=function(){return t}}};o.init()}]),angular.module("dachuwang").controller("VisitCustomerInfoCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state",function(e,t,i,a,n){var s={init:function(){this.param(),this.request.list(),this.scope()},param:function(){},request:{list:function(){t.load("customer_visit/view","post",{visit_id:n.params.vid}).then(function(t){e.info=t.info,e.focusCategories=t.info.focus_categories,e.suggestions=t.info.suggestion_type})}},scope:function(){}};s.init()}]),angular.module("dachuwang").controller("VisitCustomerCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state","daChuLocal","Analysis","$filter",function(e,t,i,a,n,s,o,l){var r={init:function(){this.param(),this.request.list(),this.scope()},param:function(){e.focusArr=[],e.suggestsArr=[],e.remark="",e.focusIDS=[],e.suggestIDS=[],e.stateVid=n.params.vid},request:{setCheckBox:function(){e.focusIDS=[],e.suggestIDS=[],e.focusArr.filter(function(t){e.focusIDS.push(t.id)}),e.suggestsArr.filter(function(t){e.suggestIDS.push(t.id)})},list:function(){var i=s.get("visit_add_date");t.load("customer_visit/for_visit","post",{user_id:n.params.uid,visit_id:n.params.vid,is_potential:n.params.pid}).then(function(t){e.info=t.data,0===n.params.vid&&(e.info.visit_date=i.visitDate),e.focusCategories=t.focus_categories,e.suggestions=t.suggestions},function(e){console.log(e)})},create:function(){r.request.setCheckBox();var i=l("date")(e.info.visit_date,"yyyy-MM-dd HH:mm");i=+new Date(i)/1e3;var a={type:1,visit_date:i,user_id:n.params.uid,is_potential:n.params.pid,focus_category:e.focusIDS.join(","),suggestion_type:e.suggestIDS.join(","),remarks:e.remark};o.send("客户拜访",{kind:"进店拜访提交"}),t.load("customer_visit/create","post",a).then(function(){s.remove("visit_add_date"),n.go("page.visit")},function(e){r.alert(e)})},update:function(){r.request.setCheckBox();var i={visit_id:n.params.vid,focus_category:e.focusIDS.join(","),suggestion_type:e.suggestIDS.join(","),remarks:e.remark,is_potential:n.params.pid};t.load("customer_visit/update","post",i).then(function(){n.go("page.visit")},function(e){r.alert(e)})}},alert:function(e){a.tips({bodyText:e,actionText:"确定",ok:function(){}})},setArr:function(e,t){t.indexOf(e)>-1?t.splice(t.indexOf(e),1):t.push(e)},scope:function(){e.checkClick=function(t,i){1==i?r.setArr(t,e.focusArr):2==i&&r.setArr(t,e.suggestsArr)},e.create=function(){r.request.create()},e.reset=function(){e.focusCategories.filter(function(e){e.checked=!1}),e.suggestions.filter(function(e){e.checked=!1}),r.param()},e.update=function(){return 0==e.focusArr.length?void r.alert("请先选择客户关注品类"):0==e.suggestsArr.length?void r.alert("请先选择意见类型"):void r.request.update()}}};r.init()}]),angular.module("dachuwang").controller("BdmIndexCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state","Analysis",function(e,t,i,a,n,s){var o={init:function(){this.param(),this.request.list(),this.scope()},param:function(){e.tabList=[{id:0,name:"今日",active:!0},{id:1,name:"本周",active:!1},{id:2,name:"本月",active:!1}],e.showItem=1},request:{list:function(){t.load("customer_visit/statistics","post",{date_type:e.showItem}).then(function(t){e.list=t.list})}},scope:function(){e.tabSwitch=function(t){s.send("客户拜访bdm界面",{kind:t.name}),e.tabList.filter(function(i){i.active=!1,t==i&&(i.active=!0,e.showItem=i.id)}),o.request.list()},e.statePath=function(e){n.go("page.visit-bd",{bd:e.bd_id})}}};o.init()}]),angular.module("dachuwang").controller("BdIndexCtrl",["$scope","rpc","$cookieStore","daChuDialog","$filter","$state","daChuLocal","pagination","Analysis",function(e,t,i,a,n,s,o,l,r){var c={init:function(){this.param(),this.initPage(),this.request.getVisitCalender(),this.scope()},initPage:function(){e.list=[],e.pagination=l,e.pagination.perPage=6,e.pagination.init(c.request.list)},param:function(){e.showItem=1,e.startTime="",e.endTime="",e.tabList=[{id:1,name:"拜访列表",active:!0},{id:2,name:"拜访日历",active:!1}],e.bd=void 0==s.params.bd?null:s.params.bd},request:{list:function(i){var a={currentPage:l.page,itemsPerPage:e.pagination.perPage,startTime:e.startTime,endTime:e.endTime};void 0!=e.bd&&(a.bd_id=e.bd),t.load("customer_visit/lists","post",a).then(function(t){e.list=e.list.concat(t.list),i(t.list.length<e.pagination.perPage?!0:!1)})},"delete":function(e){t.load("customer_visit/del","post",{visit_id:e}).then(function(){s.reload()})},getVisitCalender:function(){t.load("customer_visit/calendar","post",{bd_id:e.bd}).then(function(t){e.calendarLists=t.list})}},alert:function(e,t){return a.tips({bodyText:e,actionText:"确定",ok:function(){"function"==typeof t&&t.apply()}}),!1},scope:function(){e.tabSwitch=function(t){r.send("客户拜访",{kind:t.name}),e.tabList.filter(function(i){i.active=!1,t==i&&(i.active=!0,e.showItem=i.id)}),1==t.id&&(c.param(),c.initPage())};var t=function(){r.send("客户拜访",{kind:"日历日期"});var t=this,i=null;t=n("date")(t,"yyyy-MM-dd HH:mm");var a=n("date")(new Date,"yyyy-MM-dd");if(e.calendarLists.filter(function(e){var a=n("date")(e.date,"yyyy-MM-dd HH:mm");a==t&&(i=e)}),null==i){if(null!=e.bd)return void c.alert("该日无拜访记录");if(t>a)return void s.go("page.visit-add");if(t==a)return o.set("visit_add_customer",1),void s.go("page.visit-add");if(a>t)return void c.alert("该日无拜访记录")}else e.startTime=+new Date(t)/1e3,e.endTime=+new Date(t)/1e3,e.tabList[0].active=!0,e.tabList[1].active=!1,e.showItem=1,c.initPage(),c.request.getVisitCalender()};e.cellClick=function(){return t},e.delete=function(e){r.send("客户拜访",{kind:"删除"}),c.alert("确定要删除此条拜访记录吗？",function(){c.request.delete(e)})}}};e.analysis={visit:function(){r.send("客户拜访",{kind:"进店拜访"})},edit:function(){r.send("客户拜访",{kind:"修改日期"})},read:function(){r.send("客户拜访",{kind:"查看拜访记录"})}},c.init()}]),angular.module("dachuwang").controller("VisitAddCustomerCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state","$filter","pagination",function(e,t,i,a,n,s,o){var l={init:function(){this.param(),this.scope(),this.initPage()},param:function(){e.vm={searchKey:"",searchList:[]}},initPage:function(){e.dateList=[],e.pagination=o,e.pagination.perPage=15,e.pagination.init(l.request.list)},request:{list:function(i){var a={currentPage:o.page,itemsPerPage:e.pagination.perPage};t.load("customer_visit/get_private_sea","post",a).then(function(t){e.dateList=e.dateList.concat(t.list),e.vm.searchList=e.dateList,i(t.list.length<e.pagination.perPage?!0:!1)},function(e){console.log(e)})}},scope:function(){e.search=function(){if(e.vm.searchKey.length>0){var t=s("filter")(e.dateList,{shop_name:e.vm.searchKey});e.vm.searchList=t}else e.vm.searchList=e.dateList},e.selectItem=function(e){n.go("page.visit-add",{shop:encodeURIComponent(e.shop_name+"-"+e.id+"-"+e.is_potential)})}}};l.init()}]),angular.module("dachuwang").controller("VisitAddCtrl",["$scope","rpc","$cookieStore","daChuDialog","$state","$filter","daChuLocal","Analysis",function(e,t,i,a,n,s,o,l){var r=(new Date).valueOf(),c={init:function(){this.param(),this.scope()},param:function(){e.status={datePickOpen:!1},e.dateOptions={formatYear:"yy",startingDay:1},e.tabList=[{id:0,name:"添加拜访计划",active:!0},{id:1,name:"添加拜访记录",active:!1}];var t=decodeURIComponent(n.params.shop).split("-");e.vm={shopName:t[0]||"选择私海客户",userID:t[1],selectDate:""};var i=o.get("visit_add_customer");1==i&&(e.tabList[0].active=!1,e.tabList[1].active=!0,c.setChangeDate(i),o.remove("visit_add_customer")),e.showItem=1==i?1:0;var a=o.get("visit_add_date");0==e.showItem&&null!=a&&(e.vm.selectDate=a.visitDate,o.remove("visit_add_date"))},alert:function(e){a.tips({bodyText:e,actionText:"确定",ok:function(){}})},request:{create:function(){var i=s("date")(e.vm.selectDate,"yyyy-MM-dd HH:mm");""==i?c.alert("请先选择添加拜访日期!"):""==n.params.shop&&c.alert("请先选择拜访的私海客户!"),i=+new Date(i)/1e3;var a=decodeURIComponent(n.params.shop);if(n.params.shop.indexOf("-")>-1){var o=a.split("-"),l={type:e.showItem,visit_date:i,user_id:o[1],is_potential:parseInt(o[2])};t.load("customer_visit/create","post",l).then(function(e){0==e.status&&n.go("page.visit")})}}},setChangeDate:function(t){if(0===t)e.vm.selectDate="",e.status.datePickOpen=!1;else if(1===t){var i=new Date;e.vm.selectDate=s("date")(i,"yyyy-MM-dd")}},scope:function(){e.openDate=function(){setTimeout(function(){e.status.datePickOpen=!0,e.$apply()},100)},e.create=function(){var t=s("date")(e.vm.selectDate,"yyyy-MM-dd HH:mm"),i=s("date")(new Date,"yyyy-MM-dd");if(""==t)return void c.alert("请先选择添加拜访日期!");if(""==n.params.shop)return void c.alert("请先选择拜访的私海客户!");if(i>t)return void c.alert("拜访计划不能小于当天日期");if(0==e.showItem){var a=(new Date).valueOf();l.send("客户拜访",{kind:"添加拜访"},a-r),c.request.create()}else{var d=decodeURIComponent(n.params.shop).split("-");o.set("visit_add_date",{visitDate:t,shopName:d[0]}),n.go("page.visit-customer",{uid:parseInt(d[1]),vid:0,pid:parseInt(d[2])})}},e.statePath=function(){1==e.showItem?o.set("visit_add_customer",e.showItem):(o.remove("visit_add_customer"),null!=e.vm.selectDate&&o.set("visit_add_date",{visitDate:e.vm.selectDate})),n.go("page.visit-add-customer")},e.tabSwitch=function(t){l.send("客户拜访",{kind:t.name}),c.setChangeDate(t.id),e.tabList.filter(function(i){i.active=!1,t==i&&(i.active=!0,e.showItem=i.id)}),o.remove("visit_add_customer")}}};c.init()}]),angular.module("dachuwang").controller("UserEditCtrl",["$scope","rpc","$cookieStore","daChuDialog",function(e,t,i,a){if(void 0==i.get("token"))return rpc.redirect("/user/login"),!1;e.discard=function(){rpc.redirect("/user/center")},e.addr={province:"",city:"",county:"",market:""},e.reg={provinceId:"",name:"",cityId:"",countyId:"",marketId:"",detailAddress:""},e.normalUser=30==e.reg.type||20==e.reg.type?1:0,rpc.getdata("user/getinfo","POST",function(t){e.reg.detailAddress=t.info.detail_address,e.reg.name=t.info.name,e.markets=t.markets,e.provinces=t.provinces,e.citys=t.citys,e.countys=t.countys,angular.forEach(e.markets,function(i){i.id==t.info.market_id&&(e.addr.market=i)}),angular.forEach(e.provinces,function(i){i.id==t.info.province_id&&(e.addr.province=i)}),angular.forEach(e.citys,function(i){i.id==t.info.city_id&&(e.addr.city=i)}),null!=t.info.county_id&&angular.forEach(e.countys,function(i){i.id==t.info.county_id&&(e.addr.county=i)})}),localStorage.getItem("provinces")?e.provinces=JSON.parse(localStorage.getItem("provinces")):rpc.getdata("location/","GET",function(t){e.provinces=t.provinces,localStorage.setItem("provinces",JSON.stringify(t.provinces))}),e.get_child=function(t,i){rpc.getdata("location/children","POST",function(i){e[t]=i.children},{id:e.addr[i].id})};var n=0;e.get_market=function(t){(t="province")?e.addr.province.id<=4?(n=1,rpc.getdata("market/get_market","POST",function(t){e.markets=t},{type:"province",id:e.addr.province.id})):n=0:n||rpc.getdata("market/get_market","POST",function(t){e.markets=t},{type:"city",id:e.addr.city.id})},e.save=function(){e.reg.marketId=e.addr.market.id,e.reg.provinceId=e.addr.province.id,e.reg.cityId=e.addr.city.id,e.reg.countyId=e.addr.county.id,rpc.getdata("/user/update_myself","POST",function(e){e.status?(a.tips({bodyText:"更新个人资料成功！"}),rpc.redirect("/user/center")):a.tips({bodyText:"更新个人资料失败。"})},e.reg)}}]),angular.module("dachuwang").controller("UserRegisterCtrl",["$scope","rpc","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore","daChuLocal","daChuTimer",function(e,t,i,a,n,s,o,l,r){e.dialog=s.tips,e.addr={province:"",city:"",county:"",market:"",userType:""},e.reg={mobile:"",password:"",name:"",provinceId:"",cityId:"",countyId:"",marketId:"",detailAddress:"",type:"",vcode:"",inviteid:o.get("username")},l.get("regUserType")&&r.compare(l.get("regUserTypeTime"))?e.types=l.get("regUserType"):rpc.getdata("user/user_type","POST",function(t){e.types=t.user_type,l.set("regUserType",t.user_type),l.set("regUserTypeTime",r.getNow())}),rpc.getdata("user/register_options","GET",function(t){e.cities=t.list.cities,e.market=t.list.market}),e.getMarket=function(){e.markets=void 0!=e.addr.city?e.market[e.addr.city.id]:[]},e.sms=function(){if(""==e.reg.mobile)return e.dialog({bodyText:"请输入手机号后再选择发送验证短信!"}),!1;e.clock=60;var t=function(t){e.smsinfo="点此重发验证码",e.smsdis="",clearInterval(t)},i=function(){e.clock>=1?(e.clock--,e.smsinfo=e.clock+"秒后可以重发",e.smsdis="disabled"):t(a)},a=setInterval(function(){e.$apply(i)},1e3);rpc.getdata("user/smscode","POST",function(i){0===i.status?e.dialog({bodyText:"已经成功发送短信,请您注意查收。"}):(t(a),e.dialog({bodyText:"发送短信失败,请您检查手机号是否可用。"}))},e.reg)},e.register=function(){return e.regForm.$invalid?(e.regForm.submitted=!0,!1):(e.reg.provinceId=e.addr.province.id,e.reg.cityId=e.addr.city.id,e.reg.countyId=e.addr.county.id,e.reg.marketId=e.addr.market.id,e.reg.type=e.addr.userType.type,e.reg.codeInviteId=o.get("inviteId"),e.reg.codeInviteStoreNumber=o.get("inviteStoreNumber"),void rpc.getdata("user/register","POST",function(t){var i="恭喜您注册成功";0===t.status?(20==e.reg.type?o.put("type",20):i="恭喜您注册成功，请等待大厨网审核。有任何疑问请联系010-58298105。",e.dialog({bodyText:i,actionText:"确定",ok:function(){rpc.redirect(20==e.reg.type?"/user/center":"/")},closeText:"首页",close:function(){rpc.redirect("/")}})):e.dialog({bodyText:t.message})},e.reg))}}]),angular.module("dachuwang").controller("userPassCtrl",["$scope","rpc","$cacheFactory","$timeout","$location","daChuDialog","$cookieStore",function(e,t,i,a,n,s,o){e.reg={password:"",newPassword:"",newRePassword:""},e.dialog=s.tips,e.passwordCheck=function(){return e.reg.newPassword!=e.reg.newRePassword?(e.checked=1,e.dialog({bodyText:"两次输入密码不一致。"}),!1):void(e.checked=0)},e.changePassword=function(){e.passwordCheck(),t.load("user/update_password","POST",e.reg).then(function(e){alert(e.msg),t.load("user/logout","POST").then(function(){o.remove("token"),t.redirect("/user/login")})},function(e){alert(e)})}}]),angular.module("dachuwang").controller("loginCtrl",["$scope","$state","userAuthService","rpc","$cookieStore","daChuLocal","daChuDialog",function(e,t,i,a,n,s){return i.isLogined()?(a.redirect("/user/center"),!1):(e.user={mobile:"",password:""},e.message={text:"",status:""},void(e.login=function(){return e.show_error=!0,e.loginForm.$invalid?(e.loginForm.submitted=!0,e.isL=!1,!1):(e.isL=!0,void a.load("user/login","POST",e.user).then(function(e){window.jsInterface&&window.jsInterface.saveUserId&&window.jsInterface.saveUserId(""+e.info.id),s.set("token",e.token),s.set("role_id",e.info.type),s.set("site_id",e.info.site_id),s.set("city_id",e.info.city_id),a.refer&&"/"!=a.refer?a.redirect(a.refer):t.go("page.homemanage")},function(t){e.error={cls:"alert alert-danger",message:t}}))}))}]),angular.module("dachuwang").controller("UserCenterCtrl",["$scope","rpc","$cookieStore","daChuDialog","$filter","userAuthService","daChuLocal",function(e,t,i,a,n,s,o){s.checkLogin(),e.dialog=a.tips,e.logout=function(){e.dialog({bodyText:"确定要退出吗？",ok:function(){t.load("user/logout","POST",e.user).then(function(){o.remove("token"),o.remove("role_id"),o.remove("city_id"),o.remove("site_id"),t.redirect(t.refer&&"/"!=t.refer?t.refer:"user/login")},function(t){e.error={cls:"alert alert-danger",message:t}})},actionText:"确定",closeText:"取消"})},t.load("user/baseinfo","POST").then(function(t){e.uinfo=t.info})}]),angular.module("dachuwang").controller("MoreController",["$scope","$window","daChuDialog","Analysis",function(e,t,i,a){e.func={},e.func.manual=function(){a.send("更多-用户手册"),i.alert("正在开发中...")},e.func.map=function(){a.send("更多-离线地图"),t.jsInterface&&t.jsInterface.offlineMapManager?t.jsInterface.offlineMapManager():i.alert("请安装安卓客户端使用此功能")},e.func.refresh=function(){a.send("更多-检查更新"),t.location.reload(!0)},e.func.userCenter=function(){a.send("更多-个人中心")}}]),angular.module("dachuwang").controller("homeCtrl",["$scope","$state","$window","$log","$stateParams","$filter","$modal","daChuLocal","rpc","userAuthService","daChuDialog","Analysis",function(e,t,i,a,n,s,o,l,r,c,d,u){function p(e){var t,i=_.length;for(t=0;i>t;t++)if(_[t].key==e)return{time_type:_[t].val}}function m(e){o.open({animation:!0,templateUrl:"app/modals/home/newaddorderlists.html",controller:"NewAddOrderListsController",resolve:{time_type:function(){return p(e)},bd_id:function(){return n.bd_id?n.bd_id:-1}}})}function g(e){o.open({animation:!0,templateUrl:"app/modals/home/backflowwater.html",controller:"BackFlowWaterController",resolve:{time_type:function(){return p(e)},bd_id:function(){return n.bd_id?n.bd_id:-1}}})}function v(e){var i=p(e);l.set("time_type",i),l.set("filter_sift",{order_type:{value:1}});var a=parseInt(l.get("role_id"));16===a?t.go("page.crm",{invite_id:n.bd_id}):t.go("page.manage")}function f(e){var i=p(e);l.set("time_type",i),l.set("filter_sift",{order_type:{value:0}});var a=parseInt(l.get("role_id"));16===a?t.go("page.crm",{invite_id:n.bd_id}):t.go("page.manage")}function h(){var t={role_id:parseInt(l.get("role_id")),action:"get_statistics"};n.bd_id&&(t.bd_id=n.bd_id),r.load("statistics/index","POST",t).then(function(t){t.list.length>3?(e.statistics=t.list.splice(0,t.list.length-1),e.capacity=t.list.splice(t.list.length-1,1)):e.statistics=t.list,angular.forEach(e.statistics,function(e){e.data[3].val/=100})},function(e){console.error(e)}).then(function(){e.isloading=!1})}c.checkLogin();var b=[{index:2,func:m,analysis:"新增下单数"},{index:3,func:g,analysis:"新增回款流水"},{index:4,func:v,analysis:"已下单客户数"},{index:5,func:f,analysis:"未下单客户数"}],_=[{key:"今日",val:"by_day"},{key:"本周",val:"by_week"},{key:"本月",val:"by_month"}];e.tabLists=[{status:0,name:"数据统计"},{status:1,name:"本月业绩"}],e.showType=0,e.showTabs=!0,e.show_metabolic=!1,e.dpicker={begin:{},end:{}},e.format={min:new Date("2015-03-01"),max:new Date};var y="未知";e.statistics=[{heading:"今日",data:[{key:"新注册客户数",val:y},{key:"首单客户数",val:y}]},{heading:"本周",data:[{key:"新注册客户数",val:y},{key:"首单客户数",val:y}]},{heading:"本月",data:[{key:"新注册客户数",val:y},{key:"首单客户数",val:y}]}],e.openstatus={list:[!0,!0,!0,!0,!0,!0],query:!1,sum:!0},e.capacity_openstatus={list:[!0],query:!1,sum:!0},e.metabolic=[{key:"新注册客户数",val:y},{key:"首单客户数",val:y}],e.sum=[{key:"首单客户数",val:500}],e.begintime={},e.endtime={},e.date={},e.func={query:function(){if(!e.date.begin_time||!e.date.end_time)return d.alert("请选择时段"),!1;var t=new Date(e.date.begin_time).valueOf(),i=new Date(e.date.end_time).valueOf();if(t>i)return d.alert("起始时间不能大于结束时间"),!1;e.isquering=!0,e.show_metabolic=!1;var a={role_id:parseInt(l.get("role_id")),action:"get_query",begin_time:t/1e3,end_time:i/1e3};n.bd_id&&(a.bd_id=n.bd_id),u.send("业绩统计自选时间段"),r.load("statistics/index","POST",a).then(function(t){e.metabolic=t.list,e.show_metabolic=!0},function(e){d.alert("查询失败请稍候再试，原因: "+e)}).then(function(){e.isquering=!1})},openDatepicker:function(t,i){t.preventDefault(),t.stopPropagation(),1===i?(e.dpicker.end.status=!1,e.dpicker.begin.status=!0):(e.dpicker.begin.status=!1,e.dpicker.end.status=!0)},changeStatus:function(t){e.showType=t},showDetail:function(e,t,i){if(!(2>e||0>=i)){var a,n=b.length;for(a=0;n>a;a++)if(b[a].index==e)return u.send(b[a].analysis,{"时间":t}),void b[a].func(t)}}},e.isloading=!0,e.isquering=!1,h()}]),angular.module("dachuwang").controller("DblistController",["$scope","$window","$log","$state","rpc","daChuDialog","daChuLocal",function(e,t,i,a,n,s,o){function l(){e.isLoading=!0,e.showLists=!0,e.showTotal=!1,n.load("customer/list_group","POST").then(function(t){e.isLoading=!1,e.mygroup=t.list.list},function(){e.isLoading=!1,s.alert("哎呀，服务器连不通啊")})}function r(){e.isLoading=!0,e.showLists=!1,e.showTotal=!0;var t={action:"get_total_statistics",role_id:parseInt(o.get("role_id"))};n.load("statistics/index","POST",t).then(function(t){e.statistics=t.list,e.isLoading=!1,0==t.status?(e.today=t.list.today,e.all=t.list.all):s.alert("请求出错")},function(){s.alert("网络不好连不上啊")})}e.tabs=[{status:1,name:"组员业绩"},{status:0,name:"业绩汇总"}],e.timeTabs=[{status:0,name:"今日"},{status:1,name:"本周"},{status:2,name:"本月"},{status:3,name:"总计"},{status:4,name:"自选区间"}],e.showType=1,e.timeShowType=0,e.setStatus=function(t){e.showType=t,1==t?l():r()},e.setTimeStatus=function(t){e.timeShowType=t},e.viewStatistics=function(e){a.go("page.home",{bd_id:e})},l(),e.openstatus={list:[!0,!0,!0,!0,!0,!0],query:!1,sum:!0}}]),angular.module("dachuwang").controller("PotlistController",["$scope","$state","$stateParams","$log","$window","rpc","pagination","daChuDialog",function(e,t,i,a,n,s,o,l){function r(t){var n=3;a.debug(o.page),s.load("potential_customer/lists","POST",{itemsPerPage:n,currentPage:o.page,invite_id:i.invite_id}).then(function(i){angular.forEach(i.list,function(t){e.list.push(t)}),t(i.list.length<n?!0:!1),e.totalItems=i.total>0?i.total:0})}e.list=[],e.pagination=o,e.pagination.init(r),e.openUser=function(e){t.go("page.openpot",{potid:e})},e.editUser=function(e){t.go("page.editpot",{potid:e})},e.deleteUser=function(e){s.load("potential_customer/delete","POST",{id:e}).then(function(e){0==e.status?(l.alert("删除成功"),n.location.reload(!0)):l.alert("删除失败 "+e.msg)},function(e){l.alert("删除失败 "+e)})}}]),angular.module("dachuwang").controller("PotentialController",["$scope","$stateParams","$cookieStore","$window","rpc","geo","daChuDialog","urlHistoryService",function(e,t,i,a,n,s,o,l){function r(){var t,i;for(t=0;t<u.length;t++)if(i=u[t],e.basic_form[i.name].$invalid)return void o.alert(i.info)}e.addr={province:""};var c=function(t){var i=[];angular.forEach(t,function(t){1==e.site.id&&2!=t.id?i.push(t):2==e.site.id&&2==t.id&&i.push(t)}),e.tops=i};e.getSite=function(){void 0!==e.site&&c(e.shopType.top)};var d=function(){n.load("customer/create_input","GET").then(function(t){e.provinces=t.provinces,e.allLines=t.lines,e.sites=t.sites,e.site=e.sites[0],e.shopType=t.shop_type,c(e.shopType.top)},function(t){e.error={cls:"alert alert-danger",message:t}})};e.getShop=function(){if(void 0!==e.shop){var t=[];angular.forEach(e.shopType.child,function(i){parseInt(i.upid)==parseInt(e.shop.id)&&t.push(i)}),e.shopChilds=t}},e.getLines=function(){var t=0;e.info.province&&(t=e.info.province.id);var i=[];angular.forEach(e.allLines,function(e){t==e.location_id&&i.push(e)}),e.lines=i};var u=[{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"shop_name",info:"请填写商铺名"}];e.create=function(){if(e.basic_form.$invalid)return r(),!1;var t=0,i=0;void 0==e.shopChild?void 0!==e.shop&&(t=e.shop.id||0):(t=e.shopChild.id,i=e.shopChild.is_link);var a={id:e.site.id||0,name:e.info.name,shopType:t,isLink:i,mobile:e.info.mobile,provinceId:e.info.province?e.info.province.id:null,lineId:e.info.line?e.info.line.id:null,address:e.info.address,shopName:e.info.shop_name,remark:e.info.remark};n.load("potential_customer/create","POST",a).then(function(){alert("记录成功"),l.push(0),n.redirect("/crm")},function(e){alert(e)})},d()}]),angular.module("dachuwang").controller("OpenpotController",["$scope","$modal","$stateParams","$cookieStore","$window","$state","rpc","daChuDialog","geo","urlHistoryService","daChuLocal",function(e,t,i,a,n,s,o,l,r,c,d){function u(){var t,i;for(t=0;t<p.length;t++)if(i=p[t],e.basic_form[i.name].$invalid)return void l.alert(i.info);return 2===e.shop.id&&e.basic_form.shop_child.$invalid?void l.alert("请选择商家连锁类型"):void l.alert("something wrong")}e.urls=null,n.callback_function.upload=function(t){e.urls=JSON.parse(t)},e.suborderInfo=function(){t.open({templateUrl:"suborderInfo.html"})},e.upload=function(){n.jsInterface&&n.jsInterface.pictureUpload?n.jsInterface.pictureUpload("window.callback_function.upload"):l.alert("此版本无法上传图片,请安装安卓客户端")},e.getLines=function(){var t=0;e.info.province&&(t=e.info.province.id);var i=[];angular.forEach(e.allLines,function(e){t==e.location_id&&i.push(e)}),e.lines=i};var p=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择字母账号类型"},{name:"shop",info:"请选择商家类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请输入客户正确手机号"},{name:"username",info:"请输入客户姓名"},{name:"recievemobile",info:"请填写收货人联系方式"},{name:"recievename",info:"请输入收货人姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];e.show_more_account_option=function(){return e.account_type?void(e.show_account_son=1!==parseInt(e.account_type.value)?!0:!1):void(e.show_account_son=!1)},e.bindProperty=function(t,i){e[t]=i};var m=function(){var t={};i.potid&&(t.id=i.potid),o.load("potential_customer/edit_input","POST",t).then(function(t){e.provinces=t.provinces,e.allLines=t.lines,e.dOptions=t.directions,e.oDimensions=t.dimensions,e.types=t.types,e.is_uploaded=parseInt(t.info.is_uploaded),e.shopTypes=t.shop_type,e.shop=function(t){var i,a=parseInt(t),n=e.shopTypes.length;for(i=0;n>i;i++)if(e.shopTypes[i].id===a)return e.shopTypes[i];return null}(t.info.shop_type),e.info=t.info,e.userGeo={lng:t.info.lng,lat:t.info.lat},e.info.dimensions=function(t){if(!t)return null;var i,a=e.oDimensions.length;for(i=0;a>i;i++)if(t===e.oDimensions[i].value)return e.oDimensions[i];return null}(t.info.dimensions),e.info.province=function(t){var i,a=e.provinces.length;for(i=0;a>i;i++)if(e.provinces[i].id==t)return e.provinces[i]}(parseInt(t.info.province_id)),e.getLines(),e.info.line=function(t){var i,a=e.lines.length;for(i=0;a>i;i++)if(e.lines[i].id==t)return e.lines[i]}(parseInt(t.info.line_id)),e.info.direction=function(t){var i,a=e.dOptions.length;if(!t)return null;for(i=0;a>i;i++)if(e.dOptions[i].value==t)return e.dOptions[i]}(t.info.direction),e.urls=t.info.pic_urls,angular.forEach(e.types,function(i){i.value==t.info.customer_type&&(e.customerType=i)});var i=d.get("city_id");return i?(angular.forEach(e.provinces,function(t){t.id==i&&(e.info.province=t)}),e.getLines(),e.estimateds=t.estimated,e.info.estimateVegetable=function(t){var i,a;for(a=e.estimateds.length,i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.greens_meat_estimated),e.info.estimateRice=function(t){var i,a;for(a=e.estimateds.length,i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.rice_grain_estimated),e.account_types=t.account_types,e.account_type=function(t){var i,a;for(a=e.account_types.length,i=0;a>i;i++)if(e.account_types[i].value==t)return e.account_types[i]}(t.info.account_type),e.account_type&&1!==parseInt(e.account_type.value)&&(e.parent_mobile=t.info.parent_mobile,e.show_more_account_option()),e.info.recievename=t.info.recieve_name,void(e.info.recievemobile=t.info.recieve_mobile)):(l.alert("登录超时，请重新登录"),void o.redirect("user/login"))},function(t){e.error={cls:"alert alert-danger",message:t}})},g=!1;e.create=function(){if(e.basic_form.$invalid)return u(),!1;if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void l.alert("请填写关联母账号");var t=0,a=0;if(void 0==e.shopChild?void 0!==e.shop&&(t=e.shop.id||0):(t=e.shopChild.id,a=e.shopChild.is_link),!(g||e.userGeo.lat&&e.userGeo.lng))return void l.alert("请定位此用户位置信息，再提交！");
if(null===e.urls&&0===e.is_uploaded)return void l.alert("请上传至少一张商家门店图片");var n=e.info.dimensions||{value:""},r=e.info.direction||{value:""},c={id:i.potid,name:e.info.name,shopType:t,isLink:a,dimensions:n.value,mobile:e.info.mobile,provinceId:e.info.province.id,lineId:e.info.line.id,lat:e.userGeo.lat,lng:e.userGeo.lng,address:e.info.address,direction:r.value,shopName:e.info.shop_name,customerType:e.customerType.value,remark:e.info.remark,is_located:function(){return e.userGeo.lat&&e.userGeo.lng||1==e.info.is_located?1:0}(),greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value,recieve_mobile:e.info.recievemobile,recieve_name:e.info.recievename};null!==e.urls&&(c.pic_urls=e.urls),e.parent_mobile&&(c.parent_mobile=e.parent_mobile),e.isRequesting=!0,o.load("potential_customer/enable","POST",c).then(function(){l.alert("开通成功"),e.isRequesting=!1,s.go("page.manage")},function(t){l.alert("开通潜在客户失败，失败原因:"+t),e.isRequesting=!1})},n.geoData.callback=function(t){e.userGeo.lat=t.latitude,e.userGeo.lng=t.longitude,e.info.address=t.address,e.$apply()},e.choosePlace=function(){if(n.jsInterface&&n.jsInterface.findRestaurantOnMap)n.jsInterface.findRestaurantOnMap();else{var t=r.info();t.then(function(t){e.userGeo={},e.userGeo.lat=t.lat,e.userGeo.lng=t.lng,l.alert("客户地址定位成功！")},function(e){l.alert("获取位置错误, "+e),g=!0})}},m(),e.getRecieveInfo=function(){e.info.recievename=e.info.name,e.info.recievemobile=e.info.mobile}}]),angular.module("dachuwang").controller("MyCustomerController",["$scope",function(e){e.showType=0,e.setStatus=function(t){e.showType=t},e.tabs=[{status:0,href:"",name:"当前客户"},{status:1,href:"",name:"潜在客户"}]}]),angular.module("dachuwang").controller("manageController",["$scope","$state","$window","daChuLocal","daChuDialog","rpc",function(e,t,i,a,n,s){e.isLoading=!0,s.load("customer/list_group","POST").then(function(t){e.isLoading=!1,e.my=t.list.customer,e.mygroup=t.list.list},function(){n.alert("无法连接服务器，可能是网络较差")}),e.viewCustom=function(e){t.go("page.crm",{invite_id:e})}}]),angular.module("dachuwang").controller("FilterController",["$scope","$modalInstance","$window","rpc","daChuDialog","daChuLocal",function(e,t,i,a,n,s){function o(e,t){if(null===e)return null;var i,a={},n=t.length;for(i=0;n>i;i++)e[t[i]]&&(a[t[i]]=e[t[i]]);return a}function l(e){var t;for(t in e)return!1;return!0}function r(e,t){return parseInt(e)===parseInt(t)?!0:!1}var c;e.order_lists=[{name:"注册时间",val:"created_time"},{name:"下单时间",val:"order_time"}],e.order={by:null,way:null},e.property={dimensions:[],order_type:[{name:"从未下单",value:0},{name:"有下单记录",value:1}]},e.sift={},e.isloading=!0,function(){a.load("customer/create_input","GET").then(function(t){if(0===parseInt(t.status)){e.property.provinces=function(e){var t,i=[],a=e.length;for(t=0;a>t;t++)i.push(o(e[t],["id","name","path"]));return i}(t.provinces),c=t.lines;var i=s.get("city_id");if(!i)return n.alert("登录超时，请重新登录"),void a.redirect("user/login");angular.forEach(e.property.provinces,function(t){t.id==i&&(e.sift.province=t)}),e.func.getLines(),e.property.dimensions=t.dimensions,e.property.shop_types=t.shop_type,e.property.types=t.types;var l=s.get("filter_sift");l&&l.line&&l.line.id&&angular.forEach(e.property.lines,function(t){t.id==l.line.id&&(e.sift.line=t)}),l&&l.dimensions&&angular.forEach(e.property.dimensions,function(t){t.value==l.dimensions.value&&(e.sift.dimensions=t)}),l&&l.shop_type&&angular.forEach(e.property.shop_types,function(t){t.id==l.shop_type.id&&(e.sift.shop_type=t)}),l&&l.customer_type&&angular.forEach(e.property.types,function(t){t.value==l.customer_type.value&&(e.sift.customer_type=t)}),l&&l.order_type&&angular.forEach(e.property.order_type,function(t){t.value==l.order_type.value&&(e.sift.order_type=t)})}},function(e){n.alert(e)}).then(function(){e.isloading=!1})}(),e.func={ensure:function(){var i={order:e.order,sift:e.sift};return l(i.sift)?(this.cancel(),!1):(s.set("filter_sift",e.sift),void t.close(i))},cancel:function(){s.remove("filter_sift"),s.remove("time_type"),t.close(null)},getLines:function(){if(!e.sift.province)return!1;e.property.lines=[];var t,i=c.length;for(t=0;i>t;t++)r(c[t].location_id,e.sift.province.id)&&e.property.lines.push({id:c[t].id,name:c[t].name})},reset:function(){var t=e.sift.province;e.sift={province:t},s.remove("filter_sift"),s.remove("time_type")}}}]),angular.module("dachuwang").controller("EditpotController",["$scope","$modal","$stateParams","$cookieStore","$window","$state","rpc","daChuDialog","geo","daChuLocal",function(e,t,i,a,n,s,o,l,r,c){function d(){var t,i;for(t=0;t<u.length;t++)if(i=u[t],e.basic_form[i.name].$invalid)return void l.alert(i.info)}e.urls=null,n.callback_function.upload=function(t){e.urls=JSON.parse(t)},e.suborderInfo=function(){t.open({templateUrl:"suborderInfo.html"})},e.upload=function(){n.jsInterface&&n.jsInterface.pictureUpload?n.jsInterface.pictureUpload("window.callback_function.upload"):l.alert("此版本无法上传图片,请安装安卓客户端","customer_shop")},e.getLines=function(){var t=0;e.info.province&&(t=e.info.province.id);var i=[];angular.forEach(e.allLines,function(e){t==e.location_id&&i.push(e)}),e.lines=i},e.bindProperty=function(t,i){e[t]=i},e.get_cycle=function(){if(e.billing_cycle){var t=e.billing_cycle.value;e.m_check_dates=e.check_dates[t],e.m_invoice_dates=e.invoice_dates[t],e.m_pay_dates=e.pay_dates[t]}};var u=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择字母账号类型"},{name:"shop",info:"请选择商家类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请输入客户正确手机号"},{name:"username",info:"请输入客户姓名"},{name:"recievemobile",info:"请填写收货人联系方式"},{name:"recievename",info:"请输入收货人姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];e.show_more_account_option=function(){return e.account_type?void(e.show_account_son=1!==parseInt(e.account_type.value)?!0:!1):void(e.show_account_son=!1)};var p=function(){var t={};i.potid&&(t.id=i.potid),o.load("potential_customer/edit_input","POST",t).then(function(t){e.provinces=t.provinces,e.allLines=t.lines,e.dOptions=t.directions,e.oDimensions=t.dimensions,e.types=t.types,e.is_uploaded=parseInt(t.info.is_uploaded),e.shopTypes=t.shop_type,e.shop=function(t){var i,a=parseInt(t),n=e.shopTypes.length;for(i=0;n>i;i++)if(e.shopTypes[i].id===a)return e.shopTypes[i];return null}(t.info.shop_type),e.info=t.info,e.userGeo={lng:t.info.lng,lat:t.info.lat},e.info.dimensions=function(t){if(!t)return null;var i,a=e.oDimensions.length;for(i=0;a>i;i++)if(t===e.oDimensions[i].value)return e.oDimensions[i];return null}(t.info.dimensions),e.info.province=function(t){var i,a=e.provinces.length;for(i=0;a>i;i++)if(e.provinces[i].id==t)return e.provinces[i]}(parseInt(t.info.province_id)),e.getLines(),e.info.line=function(t){var i,a=e.lines.length;for(i=0;a>i;i++)if(e.lines[i].id==t)return e.lines[i]}(parseInt(t.info.line_id)),e.info.direction=function(t){var i,a=e.dOptions.length;if(!t)return null;for(i=0;a>i;i++)if(e.dOptions[i].value==t)return e.dOptions[i]}(t.info.direction),e.urls=t.info.pic_urls,angular.forEach(e.types,function(i){i.value==t.info.customer_type&&(e.customerType=i)});var i=c.get("city_id");return i?(angular.forEach(e.provinces,function(t){t.id==i&&(e.info.province=t)}),e.getLines(),e.estimateds=t.estimated,e.info.estimateVegetable=function(t){var i,a;for(a=e.estimateds.length,i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.greens_meat_estimated),e.info.estimateRice=function(t){var i,a;for(a=e.estimateds.length,i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.rice_grain_estimated),e.account_types=t.account_types,e.account_type=function(t){t=parseInt(t);var i,a;for(a=e.account_types.length,i=0;a>i;i++)if(e.account_types[i].value==t)return e.account_types[i]}(t.info.account_type),e.account_type&&1!==parseInt(e.account_type.value)&&(e.parent_mobile=t.info.parent_mobile,e.show_more_account_option()),e.info.recievename=t.info.recieve_name,void(e.info.recievemobile=t.info.recieve_mobile)):(l.alert("登录超时，请重新登录"),void o.redirect("user/login"))},function(t){e.error={cls:"alert alert-danger",message:t}})},m=!1;e.create=function(){if(e.basic_form.$invalid)return d(),!1;if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void l.alert("请填写关联母账号");var t=0,a=0;if(t=e.shop.id||0,!(m||e.userGeo.lat&&e.userGeo.lng))return void l.alert("请定位此用户位置信息，再提交！");if(null===e.urls&&0===e.is_uploaded)return void l.alert("请上传至少一张商家门店图片");var n=e.info.dimensions||{value:""},r=e.info.direction||{value:""},c={id:i.potid,name:e.info.name,shopType:t,isLink:a,dimensions:n.value,mobile:e.info.mobile,provinceId:e.info.province.id,lineId:e.info.line.id,lat:e.userGeo.lat,lng:e.userGeo.lng,address:e.info.address,direction:r.value,customerType:e.customerType.value,shopName:e.info.shop_name,remark:e.info.remark,is_located:function(){return e.userGeo.lat&&e.userGeo.lng||1==e.info.is_located?1:0}(),greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value,recieve_mobile:e.info.recievemobile,recieve_name:e.info.recievename};null!==e.urls&&(c.pic_urls=e.urls),e.parent_mobile&&(c.parent_mobile=e.parent_mobile),e.isRequesting=!0,o.load("potential_customer/edit","POST",c).then(function(){l.alert("修改成功"),e.isRequesting=!1,s.go("page.manage")},function(t){l.alert(t),e.isRequesting=!1})},n.geoData.callback=function(t){e.userGeo.lat=t.latitude,e.userGeo.lng=t.longitude,e.info.address=t.address,e.$apply()},e.choosePlace=function(){if(n.jsInterface&&n.jsInterface.findRestaurantOnMap)n.jsInterface.findRestaurantOnMap();else{var t=r.info();t.then(function(t){e.userGeo={},e.userGeo.lat=t.lat,e.userGeo.lng=t.lng,l.alert("客户地址定位成功！")},function(e){l.alert("获取位置错误, "+e),m=!0})}},p(),e.getRecieveInfo=function(){e.info.recievename=e.info.name,e.info.recievemobile=e.info.mobile}}]),angular.module("dachuwang").controller("EditCustomerController",["$scope","$state","$stateParams","$window","rpc","daChuDialog",function(e,t,i,a,n,s){function o(){var t;for(t=0;t<c.length;t++)if(e.basic_form[c[t].name].$invalid)return void s.alert(c[t].info)}var l,r=i.customer_id;e.is_uploaded=0,e.userGeo={lat:null,lng:null},e.isRequesting=!1,e.func={},e.urls=null,function(i){var a={id:i};n.load("customer/edit_input","POST",a).then(function(t){e.oDimensions=t.dimensions,e.dimensions=function(t){if(!t)return null;var i,a=e.oDimensions.length;for(i=0;a>i;i++)if(t===e.oDimensions[i].value)return e.oDimensions[i];return null}(t.info.dimensions),e.urls=t.info.pic_urls,e.shop_types=t.shop_type,angular.forEach(e.shop_types,function(i){i.id==t.info.shop_type&&(e.shop_type=i)}),e.estimateds=t.estimated,e.greens_meat_estimated=function(t){var i,a=e.estimateds.length;for(i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.greens_meat_estimated),e.rice_grain_estimated=function(t){var i,a=e.estimateds.length;for(i=0;a>i;i++)if(e.estimateds[i].value==t)return e.estimateds[i]}(t.info.rice_grain_estimated);var i,a=["address","remark"];for(i=0;i<a.length;i++)e[a[i]]=t.info[a[i]];e.recieve_name=t.info.recieve_name?t.info.recieve_name:t.info.name,e.recieve_mobile=t.info.recieve_mobile?t.info.recieve_mobile:t.info.mobile,l=e.address,e.userGeo={lat:t.info.lat,lng:t.info.lng}},function(e){s.alert(e),t.go("page.manage")})}(r);var c=[{name:"shop_type",info:"餐饮类型不能为空"},{name:"dimensions",info:"店铺规模不能为空"},{name:"recieve_name",info:"收货人姓名不能为空"},{name:"recieve_mobile",info:"收货人电话不能为空"},{name:"greens_meat_estimated",info:"预估日均采购量不能为空"},{name:"rice_grain_estimated",info:"预估日均采购量不能为空"},{name:"address",info:"地址不能为空"}];e.func.create=function(){if(e.basic_form.address.$dirty&&""==e.address)return s.alert("地址信息不能为空"),e.address=l,!1;if(e.basic_form.$invalid)return o(),!1;var i={id:r,shopType:e.shop_type.id,dimensions:e.dimensions.value,recieve_name:e.recieve_name,recieve_mobile:e.recieve_mobile,greens_meat_estimated:e.greens_meat_estimated.value,rice_grain_estimated:e.rice_grain_estimated.value,address:e.address,remark:e.remark};null!==e.urls&&(i.pic_urls=e.urls),(null!==e.userGeo.lat||null!==e.userGeo.lng)&&(i.is_located=1,i.lat=e.userGeo.lat,i.lng=e.userGeo.lng),e.isRequesting=!0,n.load("customer/edit","POST",i).then(function(){s.alert("修改成功"),e.isRequesting=!1,t.go("page.manage")},function(t){s.alert("修改失败："+t),e.isRequesting=!1})},a.geoData.callback=function(t){e.userGeo.lat=t.latitude,e.userGeo.lng=t.longitude,e.address=t.address,e.$apply()},a.callback_function.upload=function(t){e.urls=JSON.parse(t),e.$apply()},e.func.choosePlace=function(){return a.jsInterface&&a.jsInterface.findRestaurantOnMap?void a.jsInterface.findRestaurantOnMap():void s.alert("请使用安卓客户端")},e.func.upload=function(){a.jsInterface&&a.jsInterface.pictureUpload?a.jsInterface.pictureUpload("window.callback_function.upload"):s.alert("无法上传图片,请安装安卓客户端","customer_shop")}}]),angular.module("dachuwang").controller("custormCtrl",["$scope","$modal","$state","$stateParams","$cookieStore","$window","$interval","rpc","daChuDialog","geo","urlHistoryService","daChuLocal","Analysis",function(e,t,i,a,n,s,o,l,r,c,d,u,p){function m(){var t,i;for(t=0;t<y.length;t++)if(i=y[t],e.basic_form[i.name].$invalid)return void r.alert(i.info)}function g(){return s.jsInterface&&s.jsInterface.findRestaurantOnMap?!0:!1}var v=null;e.$watch("basic_form.$dirty",function(e){!v&&e&&(v=(new Date).getTime())}),e.urls=null,s.callback_function.upload=function(t){e.urls=JSON.parse(t),e.$apply()},e.upload=function(){s.jsInterface&&s.jsInterface.pictureUpload?s.jsInterface.pictureUpload("window.callback_function.upload"):r.alert("此版本无法上传图片,请安装安卓客户端")},e.addr={province:""},e.direction=null,e.addPotential=function(){i.go("page.potential")},e.userGeo={lat:0,lng:0,addr:""},e.suborderInfo=function(){t.open({templateUrl:"suborderInfo.html"})};var f=!1;s.geoData.callback=function(t){e.userGeo.lat=t.latitude,e.userGeo.lng=t.longitude,e.userGeo.addr=t.address,e.$apply()};var h=function(){e.addr.province="",e.lines=""},b=function(){var t=0;e.addr.province&&(t=e.addr.province.id);var i=[];angular.forEach(e.allLines,function(e){t==e.location_id&&i.push(e)}),e.lines=i};e.storeLine=function(){var t={id:e.addr.line.id};u.set("last_line",t)},e.show_ka=function(){e.show_ka_option=e.customerType&&"KA客户"===e.customerType.name&&2===parseInt(e.customerType.value)?!0:!1},e.show_more_account_option=function(){return e.account_type?void(e.show_account_son=1!==parseInt(e.account_type.value)?!0:!1):void(e.show_account_son=!1)};var _=function(){l.load("customer/create_input","GET").then(function(t){e.provinces=t.provinces,e.allLines=t.lines,e.dOptions=t.directions,e.oDimensions=t.dimensions;var i=u.get("city_id");return i?(angular.forEach(e.provinces,function(t){t.id==i&&(e.addr.province=t)}),e.shopTypes=t.shop_type,e.types=t.types,e.account_types=t.account_types,e.estimateds=t.estimated,void b()):(r.alert("登录超时，请重新登录"),void l.redirect("user/login"))},function(t){e.error={cls:"alert alert-danger",message:t}})};e.getProvince=function(){h()},e.getLines=function(){b()},e.testnum=10,e.choosePlace=function(){if(s.jsInterface&&s.jsInterface.findRestaurantOnMap)s.jsInterface.findRestaurantOnMap();else{var t=c.info();t.then(function(t){e.userGeo.lat=t.lat,e.userGeo.lng=t.lng,r.alert("客户地址定位成功！")},function(e){r.alert("获取位置错误, "+e),f=!0})}},e.bindProperty=function(t,i){e[t]=i},e.get_cycle=function(){if(e.billing_cycle){var t=e.billing_cycle.value;e.m_check_dates=e.check_dates[t],e.m_invoice_dates=e.invoice_dates[t],e.m_pay_dates=e.pay_dates[t]}};var y=[{name:"customerType",info:"请选择客户类型"},{name:"accountType",info:"请选择子母账号类型"},{name:"shop",info:"请选择餐饮类别"},{name:"dimensions",info:"请选择店铺规模"},{name:"estimateVegetable",info:"请选择预估日均果蔬采购量"},{name:"estimateRice",info:"请选择预估日均米面粮油采购量"},{name:"mobile",info:"请填写客户正确手机号"},{name:"username",info:"请输入客户姓名"},{name:"recievemobile",info:"请填写收货人联系方式"},{name:"recievename",info:"请输入收货人姓名"},{name:"province",info:"请选择省市信息"},{name:"line",info:"请选择配送线路"},{name:"address",info:"请填写详细地址"},{name:"direction",info:"请选择商家方位"},{name:"shop_name",info:"请填写商铺名"}];e.create=function(){if(e.basic_form.$invalid)return m(),!1;if(1!==parseInt(e.account_type.value)&&!e.parent_mobile)return void r.alert("请填写关联母账号");var t=0,a=0;if(void 0==e.shopChild?t=e.shop.id:(t=e.shopChild,a=e.shopChild.is_link),!(f||e.userGeo.lat&&e.userGeo.lng))return void r.alert("请定位此用户位置信息，再提交！");if(null===e.urls)return void r.alert("请上传至少一张商家门店图片");var n=e.info.dimensions||{value:""},s=e.direction||{value:""},o={name:e.info.name,shopType:t,isLink:a,dimensions:n.value,mobile:e.info.mobile,provinceId:e.addr.province.id,lineId:e.addr.line.id,address:e.userGeo.addr,lat:e.userGeo.lat,lng:e.userGeo.lng,shopName:e.info.shop_name,direction:s.value,customerType:e.customerType.value,remark:e.info.remark,pic_urls:e.urls,is_located:g()===!0?1:0,greens_meat_estimated:e.info.estimateVegetable.value,rice_grain_estimated:e.info.estimateRice.value,account_type:e.account_type.value,recieve_mobile:e.info.recievemobile,recieve_name:e.info.recievename};e.parent_mobile&&(o.parent_mobile=e.parent_mobile),e.isRequesting=!0,p.send("录入潜在客户",null,(new Date).getTime()-v),l.load("potential_customer/create","POST",o).then(function(){return r.alert("恭喜，潜在客户添加成功！请在客户管理中开通和编辑客户"),e.isRequesting=!1,i.go("page.manage"),!1},function(t){r.alert("潜在客户添加失败，失败原因:"+t),e.isRequesting=!1})},_(),e.getRecieveInfo=function(){p.send("与客户信息一致"),e.info.recievename=e.info.name,e.info.recievemobile=e.info.mobile}}]),angular.module("dachuwang").controller("crmCtrl",["$scope","$state","$stateParams","$log","$window","$modal","rpc","pagination","daChuDialog","geo","urlHistoryService","daChuLocal","Analysis",function(e,t,i,a,n,s,o,l,r,c,d,u,p){function m(t){function a(){var t;return e.key?e.key:(t=u.get("search_key"),null!==t?t:null)}var n=10,s={itemsPerPage:n,currentPage:l.page,key:a(),order_field:e.order_field.value};if(i.invite_id&&(s.invite_id=i.invite_id),!e.filter){var r=u.get("filter_sift");r&&(e.filter={sift:r})}!function(e){if(null!==e){var t={};e.sift&&!g(e.sift)&&(t.sift={},function(){var i,a,n;for(n=["line","site","province"],a=n.length,i=0;a>i;i++)e.sift[n[i]]&&(t.sift[n[i]]=parseInt(e.sift[n[i]].id));e.sift.dimensions&&(t.sift.dimensions=e.sift.dimensions.value),e.sift.shop_type&&(t.sift.shop_type=e.sift.shop_type.id),e.sift.customer_type&&(t.sift.customer_type=parseInt(e.sift.customer_type.value)),e.sift.order_type&&(t.sift.order_type=parseInt(e.sift.order_type.value))}()),g(t)||(s.conditions=t)}}(e.filter),function(){var e,t=u.get("time_type");if(t)for(e in t)s[e]=t[e]}(),o.load(f[e.showType],"POST",s).then(function(i){angular.forEach(i.list,function(t){if(0===e.showType)try{var i=JSON.parse(t.geo);t.geo=i}catch(a){t.geo=null}e.list.push(t)}),t(i.list.length<n?!0:!1),e.siftNumber=i.total,e.totalNumber=i.total_number})}function g(e){var t;for(t in e)return!1;return!0}function v(){e.key=u.get("search_key")}e.loadingGeo=!1;var f=["potential_customer/lists","customer/register_lists","customer/undone_lists","customer/after_sale_lists","shared_customer/potential_lists","shared_customer/new_register_lists"];e.oSea=[{name:"私海潜在客户",value:0},{name:"私海注册客户",value:1},{name:"公海潜在客户",value:4},{name:"公海注册客户",value:5}],e.order_fields=[{name:"按下单时间排序",value:"latest_ordered_time"},{name:"按创建时间排序",value:"created_time"}],e.order_field=e.order_fields[0],e.show_order_field=function(){e.list=[],e.pagination=l,e.pagination.init(m),e.pagination.nextPage()},e.seachange=function(t){u.remove("search_key"),u.remove("time_type"),u.remove("filter_sift"),e.changeStatus(t.value)},e.role_id=!0,e.role_id13=!0;var h=parseInt(u.get("role_id"));12==h&&(e.role_id=!1),13==e.role_id13&&(e.role_id13=!1),e.list=[],e.func={shopInfosea:function(i){d.push(e.showType),t.go("page.seainfodetail",{uid:parseInt(i.id)})},shopInfo:function(i){d.push(e.showType),t.go("page.customerdetail",{uid:parseInt(i.id)})},potential_change_shared:function(t){r.tips({bodyText:"是否确定要把客户放到公海?",actionText:"确定",ok:function(){e.change_button=!0;var i=parseInt(t.id);o.load("shared_customer/potential_change_shared","POST",{cid:i}).then(function(){for(var t=0;t<e.list.length;t++)parseInt(e.list[t].id)===i&&e.list.splice(t,1);r.alert("操作成功"),e.change_button=!1},function(t){r.alert(t),e.change_button=!1})}})},potential_change_private:function(t){var i=parseInt(t.id);e.change_button=!0,o.load("shared_customer/potential_change_private","POST",{cid:i}).then(function(){for(var t=0;t<e.list.length;t++)parseInt(e.list[t].id)===i&&e.list.splice(t,1);r.alert("操作成功"),e.change_button=!1},function(t){r.alert(t),e.change_button=!1})},new_register_change_private:function(t){var i=parseInt(t.id);e.change_button=!0,o.load("shared_customer/new_register_change_private","POST",{cid:i}).then(function(){for(var t=0;t<e.list.length;t++)parseInt(e.list[t].id)===i&&e.list.splice(t,1);r.alert("操作成功"),e.change_button=!1},function(t){r.alert(t),e.change_button=!1})}};var h=parseInt(u.get("role_id"));e.showTabs=function(){return!0}(parseInt(u.get("role_id"))),e.showType=function(){var e=d.pop();return e&&e>=0?e:1}(),e.defaultsea=function(t){for(var i=0;i<e.oSea.length;i++)if(t===e.oSea[i].value)return e.oSea[i];return e.oSea[1]}(e.showType),e.filter=null,e.pagination=l,e.pagination.init(m),e.pagination.nextPage(),e.changeStatus=function(t){e.showType!==t&&(u.remove("filter_sift"),e.filter=null,e.showType=t,e.key="",e.list=[],e.pagination.init(m),e.list.length<1&&e.pagination.nextPage())},e.search=function(){u.set("search_key",e.key),e.list=[],e.pagination.init(m),e.pagination.nextPage()},e.resetPass=function(t){e.resetClk=!0,r.tips({bodyText:"是否要重置该用户密码",actionText:"确定",ok:function(){var i={uid:t};o.load("customer/update_password","POST",i).then(function(t){e.resetClk=!1,r.alert(t.content)},function(){r.alert("重置密码失败，请联系技术人员")})}})},e.setStatus=function(t,i){e.list[t].status=i;var a=e.list[t].id,n={uid:a,status:i};o.load("customer/set_status","POST",n).then(function(){r.alert(0==i?"禁用成功":"启用成功")},function(e){r.alert(e)})};var b=null;n.geoData.callback=function(e){if(null===b)return r.alert("你必须选择一个用户"),!1;var t={id:b.id,geo:{lat:e.latitude,lng:e.longitude}};o.load("customer/edit","POST",t).then(function(t){0==t.status?(b.geo.lat=e.latitude,b.geo.lng=e.longitude,b.is_located=1,r.alert("更新成功")):r.alert("更新失败")},function(e){r.alert("更新失败 "+e)})},e.analysisPhone=function(){p.send("客户列表电话")},e.viewMap=function(e){p.send("客户列表路线"),e.lat&&e.lng?n.jsInterface&&n.jsInterface.searchLine?n.jsInterface.searchLine(JSON.stringify({latitude:e.lat,longitude:e.lng})):r.alert("lat:"+e.lat+", lng:"+e.lng+" 暂不支持查看地图"):r.alert("位置信息不全无法查看,请更新位置信息")},e.updateGeo=function(t){var i=t.id;if(!i)return r.alert("出错了"),!1;if(n.jsInterface&&n.jsInterface.findRestaurantOnMap)b=t,n.jsInterface.findRestaurantOnMap();else{e.loadingGeo=!0;var a=null;c.info().then(function(e){var t={id:i,geo:{lat:e.lat,lng:e.lng}};return a=e,o.load("customer/edit","POST",t)}).then(function(i){e.loadingGeo=!1,0==i.status?(t.geo=a,t.is_located=1,r.alert("更新成功")):r.alert("更新失败")},function(t){e.loadingGeo=!1,r.alert("更新失败 "+t)})}},e.openUser=function(e){t.go("page.openpot",{potid:e})},e.editUser=function(e){t.go("page.editpot",{potid:e})},e.deleteUser=function(e){r.tips({bodyText:"确定要删除客户?",actionText:"确定",ok:function(){o.load("potential_customer/delete","POST",{id:e}).then(function(e){0==e.status?(r.alert("删除成功"),n.location.reload(!0)):r.alert("删除失败 "+e.msg)},function(e){r.alert("删除失败 "+e)})}})},e.editCustomer=function(e){t.go("page.editcustomer",{customer_id:e})},e.filterfunc=function(){function t(e){if(!e)return null;var t={},i=[];return angular.forEach(e,function(e,t){i.push(t)}),i.length>0?(t.sift=i,t):null}var i=(new Date).getTime(),a=!0,n=s.open({animation:a,templateUrl:"app/modules/custorm/filter.html",controller:"FilterController"});n.result.then(function(a){e.filter=a;var n=null,s=(new Date).getTime();e.filter&&(n=t(e.filter.sift)),p.send("客户列表筛选",n,s-i),e.list=[],e.pagination.init(m),e.list.length<1&&e.pagination.nextPage()},function(e){console.log(e)})},v(),n.callback_function.sellerRequest=function(e){o.load("customer/nearby_lists","POST",e).then(function(e){n.jsInterface.onReceiveSellers(JSON.stringify(e.list))})},n.callback_function.cdetail=function(e){t.go("page.customerdetail",{uid:parseInt(e)})}}]),angular.module("dachuwang").directive("mdDate",["$compile",function(e){return{restrict:"EA",scope:{tdCallBack:"=tdCallBack",listTags:"=listTags",isNormal:"@isNormal"},transclude:!0,replace:!0,link:function(t,i){i.prepend('<style type="text/css">.mdCurrentDate{font-weight:bold;color:#ff6601;letter-spacing:2px;}.td_bg_hover{color:#009688;font-weight:bold;}#templateCustomerDate{margin:10px 24px;} #templateCustomerDate table td{border:1px solid #f3f3f3;background:white;;text-align:center}#templateCustomerDate table thead tr td {font-weight:bold;color:#009688;} #templateCustomerDate table tr td{position:relative;line-height:40px;}#templateCustomerDate table tr:nth-child(even) td{background-color:none;}#templateCustomerDate ul{margin:0 auto;padding:0px;text-align:center;}#templateCustomerDate ul li{list-style-type:none;display:inline-block;padding:5px 20px;margin:10px 0;}#templateCustomerDate ul>li:nth-child(1),#templateCustomerDate ul>li:nth-last-child(1){ color:white;background:#009688}.triangle-topright-blue {width: 0;height: 0;border-top: 18px solid #5bc0de;border-left: 18px solid transparent;right:0;top:0;position:absolute;}.triangle-topright-red {width: 0;height: 0;border-top: 18px solid red;border-left: 18px solid transparent;right:0;top:0;position:absolute;}<style>');{var a={currentMonth:0,currentYear:0,init:function(){return this.currentMonth=(new Date).getMonth(),this.currentYear=(new Date).getFullYear(),this.ShowMonthDetail((new Date).getFullYear(),(new Date).getMonth()+1)},ShowMonthDetail:function(e,i){return t.currentMonth=i,t.currentYear=e,this.monthCreate(e,i,20)},monthCreate:function(a,n,s){var o=['<table cellpadding="0" cellspacing="0" width="100%" border="1" style="border-collapse: collapse;">','<thead><tr> <td class="timer_td1"> 日</td><td> 一</td><td> 二</td><td>三 </td> <td>四</td><td>五</td><td>六</td></tr></thead>',"<tbody>"],l=new Date(a,n-1,1),r=l.getDay();r>0&&(o[o.length]=new Array(r+1).join('<td class="td_bg_none"></td>'));var c=new Date(a,n,0).getDate(),d=new Date,u=-1;d.getFullYear()===l.getFullYear()&&d.getMonth()==l.getMonth()&&(u=d.getDate());var p=this.ToMonthAry(s),m="";n=n>0&&9>=n?"0"+n:n;for(var g=1;c>=g;++g){var v=g>0&&9>=g?"0"+g:g,f=a+"-"+n+"-"+v;if(0==r&&(o[o.length]="<tr>"),0==t.isNormal){var h="";void 0!=t.listTags&&t.listTags.filter(function(e){e.date==f&&(h=e)}),1==h.value&&f==h.date&&u===g?o[o.length]="<td data-date="+f+' class="td_bg_hover">'+g+'<span class="triangle-topright-red"></span></td>':1==h.value&&f==h.date?o[o.length]="<td data-date="+f+">"+g+'<span class="triangle-topright-red"></span></td>':0==h.value&&f==h.date&&u===g?o[o.length]="<td data-date="+f+' class="td_bg_hover">'+g+'<span class="triangle-topright-blue"></span></td>':0==h.value&&f==h.date?o[o.length]="<td data-date="+f+">"+g+'<span class="triangle-topright-blue"></span></td>':(m=u===g?"td_bg_hover":"td_bg_none",o[o.length]="<td data-date="+f+" class="+m+">"+g+"</td>")}else 1==t.isNormal&&(p[g]===!0?o[o.length]="<td data-date="+f+">"+g+"</td>":(m=u===g?"td_bg_hover":"td_bg_none",o[o.length]="<td data-date="+f+' class="tdDay '+m+'">'+g+"</td>"));6==r?(o[o.length]="</tr>",r=0):++r}r>0&&(o[o.length]=new Array(8-r).join('<td class="td_bg_none"></td>'),o[o.length]="</tr>"),o[o.length]="</tbody>",o[o.length]="</table>";var b=o.join("");i.find("table").remove();var _=e(b)(t);return i.append(_),i.find("td").on("click",function(){var e=angular.element(this).attr("data-date");"function"==typeof t.tdCallBack&&t.tdCallBack.apply(e)}),b},lastMonth:function(){0===this.currentMonth&&(this.currentMonth=12,this.currentYear=this.currentYear-1),this.currentMonth=this.currentMonth-1,this.ShowMonthDetail(this.currentYear,this.currentMonth+1)},nextMonth:function(){11===this.currentMonth?(this.currentMonth=0,this.currentYear=this.currentYear+1):this.currentMonth=this.currentMonth+1,this.ShowMonthDetail(this.currentYear,this.currentMonth+1)},ToMonthAry:function(e){for(var t=new Array(32),i=0,a=e.length;a>i;++i)t[e[i]]=!0;return t}};a.init()}t.last=function(){a.lastMonth()},t.next=function(){a.nextMonth()}},template:'<div id="templateCustomerDate"><div><ul><li ng-click="last()">上月</li><li class="mdCurrentDate">{{currentYear}}年{{currentMonth}}月</li><li ng-click="next()">下月</li></ul></div><div ng-transclude></div></div>'}}]),angular.module("dachuwang").controller("showDetailsController",["$scope","$modalInstance","rpc","daChuDialog","account_id",function(e,t,i,a,n){e.func={close:function(){t.close()}},i.load("accheck/showConstitute","POST",{id:n}).then(function(t){e.shopLists=t.list},function(e){a.alert(e)})}]),angular.module("dachuwang").controller("SeainfoController",["$rootScope","$scope","$state","$window","rpc","daChuDialog","Lightbox","urlHistoryService","daChuLocal",function(e,t,i,a,n,s,o,l,r){t.customer={},t.history={},t.baseinfo={},t.isLoading=!0,t.historymsg=t.basemsg=!0,t.userinfo={newmsg:"最新短信",history:"历史信息",baseinfo:"基本信息"},n.load("cdetail/index","POST",{action:"get_all",uid:i.params.uid}).then(function(e){t.isLoading=!1,t.imgurl=e.list.basic_info.urls,t.customer.sms=e.list.sms,t.history=e.list.his_data,t.baseinfo=e.list.basic_info}),t.openmodal=function(i){for(var a=[],n=0;n<t.imgurl.length;n++)a.push({url:t.imgurl[n].url});e.imglength=a.length,o.openModal(a,i)},t.role_id=!0;var c=parseInt(r.get("role_id"));12!=c&&(t.role_id=!1),t.func={new_register_change_private:function(){var e=parseInt(t.baseinfo.id);t.change_button=!0,n.load("shared_customer/new_register_change_private","POST",{cid:e}).then(function(){a.alert("操作成功"),t.change_button=!1,l.push(5),i.go("page.manage")},function(e){a.alert(e),t.change_button=!1})},history_detail:function(){i.go("page.cdetailhistory",{uid:t.baseinfo.id})}}}]),angular.module("dachuwang").controller("HisController",["$scope","$state","rpc",function(e,t,i){e.func={goback:function(){t.go("page.customerdetail")}},e.isLoading=!0,e.historylist={},i.load("cdetail/index","POST",{action:"get_history_belong_detail",uid:t.params.uid}).then(function(t){e.isLoading=!1,e.data=t.list,e.historylist.list=e.data;for(var i in e.historylist.list)e.historylist.list[i].time=1e3*e.historylist.list[i].time})}]),angular.module("dachuwang").controller("CtrendsController",["$scope","$state","$window","rpc","pagination","daChuDialog","daChuLocal","Analysis",function(e,t,i,a,n,s,o,l){function r(e){return new Date(e).valueOf()/1e3}function c(t){e.isloading=!0;var i,s=10,o={action:"get_customer_orders",uid:e.currentShop.id,itemsPerPage:s,currentPage:n.page};null!==e.startTime&&(o.begin_time=r(e.startTime)),null!==e.endTime&&(o.end_time=r(e.endTime)),a.load("cdetail/index","POST",o).then(function(a){for(e.isloading=!1,i=0;i<a.list.length;i++)a.list[i].created_time*=1e3,e.orderlist.push(a.list[i]);t(a.list.length<s?!0:!1)})}function d(){var t,i=o.get("currentShop"),a=e.shopLists.length;if(i)for(t=0;a>t;t++)if(e.shopLists[t].id==i)return e.shopLists[t];return e.shopLists[0]}function u(){var i={action:"get_sub_accounts",id:parseInt(t.params.uid)};a.load("cdetail/index","POST",i).then(function(i){e.shopLists=i.list,e.shopLists.unshift({id:parseInt(t.params.uid),shop_name:"母账号店铺"}),e.currentShop=d(),e.pagination=n,e.pagination.init(c),e.pagination.nextPage()},function(){})}e.startTime=null,e.endTime=null,e.dateOptions={formatYear:"yy",startingDay:1},e.endDateOptions={formatYear:"yy",startingDay:1},e.endOpened=e.opened=!1,e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0,e.endOpened=!1},e.endOpen=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!1,e.endOpened=!0},e.func={orderinfo:function(e){l.send("查看订单详情"),t.go("page.customerdetail.orderdetail",{order_number:e.order_number})
},sift:function(){var t=null,i=null;return e.startTime&&(t=r(e.startTime)),e.endTime&&(i=r(e.endTime)),null===t&&null===i?void s.alert("起始时间和结束时间至少选一项"):null!==t&&null!==i&&t>i?void s.alert("最早时间不能大于最晚时间"):(l.send("客户订单时间筛选"),e.orderlist=[],e.pagination.init(c),void e.pagination.nextPage())},clear:function(){e.startTime=null,e.endTime=null,e.orderlist=[],e.pagination.init(c),e.pagination.nextPage()},changeShop:function(){o.set("currentShop",e.currentShop.id),e.orderlist=[],l.send("子母店铺切换"),e.pagination.init(c),e.pagination.nextPage()},getStatusClass:function(e){switch(e){case"待审核":return"my-label-waited";case"待生产":case"波次中":case"带分拣":case"已复核":case"已分拨":case"已出库":case"已装车":case"待收货":return"my-label-process";case"已签收":case"已完成":case"已关闭":return"my-label-finish";case"已退货":return"my-label-back";default:return"my-label-none"}}},e.orderlist=[],u()}]),angular.module("dachuwang").controller("CtrendsOrderController",["$scope","$state","rpc",function(e,t,i){function a(e){switch(e){case"待审核":return"my-label-waited";case"待生产":case"波次中":case"带分拣":case"已复核":case"已分拨":case"已出库":case"已装车":case"待收货":return"my-label-process";case"已签收":case"已完成":case"已关闭":return"my-label-finish";case"已退货":return"my-label-back";default:return"my-label-none"}}function n(e,t){return parseInt(e)/t}function s(e,t,i){return e?t||e:i||""}e.func={userback:function(){t.go("page.customerdetail.trends")}},e.isLoading=!0,e.customerlist={},i.load("cdetail/index","POST",{action:"get_order_detail",order_number:t.params.order_number}).then(function(t){e.isLoading=!1,e.data=t.list,angular.forEach(e.data.content,function(e){e.sum_price=n(e.sum_price,100)}),e.data.deal_price=n(e.data.deal_price,100),e.data.final_price=n(e.data.final_price,100),e.data.total_price=n(e.data.total_price,100),e.data.created_time=n(e.data.created_time,.001),e.data.deliver_date=n(e.data.deliver_date,.001),e.data.driver_name=s(e.data.driver_name,null,"暂无"),e.data.driver_mobile=s(e.data.driver_mobile,null,"暂无"),e.data.status_class=a(e.data.status)})}]),angular.module("dachuwang").controller("CdetailNavController",["$scope","$state","daChuLocal",function(e,t,i){e.showType=0,e.statusopen=!0,e.func={historyGo:function(){t.go("page.customerdetail.cdetailhistory")}},e.newmsg=e.historymsg=e.basemsg=!0,e.setStatus=function(t){i.remove("ac_filter"),e.showType=t},e.tabs=[{status:0,href:"page.customerdetail",name:"客户信息"},{status:1,href:"page.customerdetail.trends",name:"客户订单"},{status:2,href:"page.customerdetail.accountChecking",name:"对账管理"}],e.userinfo={newmsg:"最新短信",history:"历史信息",baseinfo:"基本信息"}}]),angular.module("dachuwang").controller("CdetailInfoController",["$rootScope","$scope","$state","$window","$modal","rpc","daChuDialog","Lightbox","urlHistoryService","daChuLocal","Analysis",function(e,t,i,a,n,s,o,l,r,c,d){function u(){s.load("cdetail/index","POST",{action:"get_sub_accounts",id:i.params.uid}).then(function(e){t.statistics.analysis_shops=[],angular.forEach(e.list,function(e){t.statistics.analysis_shops.push({name:e.shop_name,value:e.id})}),t.statistics.analysis_shops.unshift({name:"本店",value:i.params.uid}),t.statistics.analysis_shop=t.statistics.analysis_shops[0]}),t.statistics.analysis_time=t.statistics.analysis_times[0]}function p(e){if(!e||"all"===e)return null;var t,i;return t="week"===e?function(){var e=new Date;return Math.floor(new Date(e-864e5*(e.getDay()-1)).valueOf()/1e3)}():function(){var e=new Date;return Math.floor(new Date(e.getFullYear(),e.getMonth(),1).valueOf()/1e3)}(),i=Math.floor((new Date).valueOf()/1e3),{start:t,end:i}}function m(){var e=0;angular.forEach(t.statistics.analysis_table,function(t){e+=t.value}),angular.forEach(t.statistics.analysis_table,function(t){t.rate=Math.round(t.value/e*1e4)/100,t.rate=""+t.rate+"%"})}function g(){t.statistics.analysis_data=[],t.statistics.analysis_labels=[],angular.forEach(t.statistics.analysis_table,function(e){0!=e.value&&(t.statistics.analysis_data.push(e.value/100),t.statistics.analysis_labels.push(e.name))})}t.customer={},t.history={},t.baseinfo={},t.isLoading=!0,t.ka_info=!0,t.analysis_open=!0,t.statistics={analysis_times:[{name:"本周",value:"week"},{name:"本月",value:"month"},{name:"总计",value:"all"}],analysis_time:null,analysis_shop:null},t.is_show_analysis=!1,u(),s.load("cdetail/index","POST",{action:"get_all",uid:i.params.uid}).then(function(e){t.isLoading=!1,t.imgurl=e.list.basic_info.urls,t.customer.sms=e.list.sms,t.history=e.list.his_data,t.baseinfo=e.list.basic_info}),t.openmodal=function(i){for(var a=[],n=0;n<t.imgurl.length;n++)a.push({url:t.imgurl[n].url});e.imglength=a.length,l.openModal(a,i)},t.role_id=!0;var v=parseInt(c.get("role_id"));12!=v&&(t.role_id=!1),t.func={edit_customer:function(){return t.baseinfo.ka_info?void o.alert("不允许编辑KA客户"):void i.go("page.editcustomer",{customer_id:i.params.uid})},buy_analysis:function(e,i){if(!e||!i)return void o.alert("请选择查询条件");d.send("客户订单分析",{kind:"查询"}),t.is_req_loading=!0,t.is_show_analysis=!0;var a,n;a=p(e.value),n=i.value;var l={action:"get_buy_analysis",uid:n};a&&(l.start_time=a.start,l.end_time=a.end),s.load("cdetail/index","POST",l).then(function(e){t.is_req_loading=!1,0===e.list.length?(t.is_show_analysis=!1,t.is_show_none=!0):(t.is_show_none=!1,t.statistics.analysis_table=e.list.buy_consist,t.statistics.buy_data=e.list.buy_data,m(),g())},function(e){t.is_req_loading=!1,t.is_show_analysis=!1,o.alert("请求出错，请联系管理员 "+e)})},reset_password:function(){t.resetClk=!0,o.tips({bodyText:"是否要重置该用户密码",actionText:"确定",ok:function(){var e={uid:i.params.uid};s.load("customer/update_password","POST",e).then(function(e){t.resetClk=!1,o.alert(e.content)},function(){o.alert("重置密码失败，请联系技术人员")})}})},history_detail:function(){d.send("历史移交记录"),i.go("page.customerdetail.cdetailhistory")},view_map:function(){var e={lat:t.baseinfo.lat,lng:t.baseinfo.lng};d.send("客户详情路线"),e.lat&&e.lng?a.jsInterface&&a.jsInterface.searchLine?a.jsInterface.searchLine(JSON.stringify({latitude:e.lat,longitude:e.lng})):o.alert("lat:"+e.lat+", lng:"+e.lng+" 暂不支持查看地图"):o.alert("位置信息不全无法查看,请更新位置信息")},new_register_change_shared:function(){o.tips({bodyText:"是否确定要把客户放到公海?",actionText:"确定",ok:function(){t.change_button=!0;var e=parseInt(t.baseinfo.id);s.load("shared_customer/new_register_change_shared","POST",{cid:e}).then(function(e){0==e.status?(o.alert("操作成功"),r.push(1),i.go("page.manage")):o.alert("操作失败："+e.msg)}).then(function(){t.change_button=!1},function(){o.alert("操作失败：网络不好或服务器内部错误"),t.change_button=!1})}})},ask_dialog:function(){n.open({templateUrl:"app/modals/home/askdialog.html",controller:"AskDialogController"})}},t.btnAnalysis=function(e){1==e?d.send("客户订单分析",{kind:"时间选择"}):d.send("客户订单分析",{kind:"子母店选择"})}}]),angular.module("dachuwang").controller("CdetailHisController",["$scope","$state","rpc",function(e,t,i){e.func={goback:function(){t.go("page.customerdetail")}},e.isLoading=!0,e.historylist={},i.load("cdetail/index","POST",{action:"get_history_belong_detail",uid:t.params.uid}).then(function(t){e.isLoading=!1,e.data=t.list,e.historylist.list=e.data;for(var i in e.historylist.list)e.historylist.list[i].time=1e3*e.historylist.list[i].time})}]),angular.module("dachuwang").controller("acSiftController",["$scope","$modalInstance","daChuDialog","daChuLocal",function(e,t,i,a){function n(){var t=a.get("sift_start_time");t&&(e.start_time=t);var i=a.get("sift_end_time");i&&(e.end_time=i)}function s(){if(!e.start_time||!e.end_time)return!1;var t,i;return t=new Date(e.start_time).valueOf(),i=new Date(e.end_time).valueOf(),t>i?!1:!0}e.datepicker={start:{open:!1},end:{open:!1},open:function(t,i){i.preventDefault(),i.stopPropagation(),e.datepicker[t].open=!0}},e.func={ensure:function(){if(!s())return void i.alert("起始时间不能晚于结束时间");a.set("sift_start_time",e.start_time),a.set("sift_end_time",e.end_time);var n=new Date(e.start_time).valueOf(),o=new Date(e.end_time).valueOf();t.close({start_time:n,end_time:o})},cancel:function(){a.remove("sift_start_time"),a.remove("sift_end_time"),t.dismiss("cancel")}},n()}]),angular.module("dachuwang").controller("AcdetailController",["$scope","$state","$modal","rpc","daChuDialog","Lightbox",function(e,t,i,a,n,s){function o(){e.isLoading=!0,a.load("accheck/view","POST",{id:parseInt(t.params.account_id)}).then(function(t){e.billing_info=t.billing_info,e.customer_info=t.customer_info,e.isLoading=!1},function(e){n.alert(e)})}e.func={showGraph:function(){var t=[{url:e.billing_info.payment_evidence}];s.openModal(t,0)},showDetails:function(){i.open({animation:!0,templateUrl:"app/modules/cdetail/showdetails.html",controller:"showDetailsController",resolve:{account_id:function(){return parseInt(e.billing_info.id)}}})},getStatusClass:function(e,t){if(1===parseInt(t))return"label-default";switch(e=parseInt(e)){case 2:return"label-warning";case 3:return"label-info";case 4:return"label-danger";case 5:return"label-success"}},getStatus:function(e,t){return 1===parseInt(t)?"逾期未付":e},getLaterDate:function(e,t){t>1||(t=1);var i=new Date(e).valueOf(),a=new Date(i+864e5*t);return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}},o()}]),angular.module("dachuwang").controller("AccountCheckingController",["$scope","$state","rpc","pagination","daChuLocal","$modal","Analysis","daChuDialog",function(e,t,i,a,n,s,o){function l(a){function s(t){var i,n=t.list.length;for(a(n<e.itemsPerPage?!0:!1),i=0;n>i;i++)e.accountLists.push(t.list[i])}function o(t){console.log(t),e.isParent=!1,e.pagination.isProcessing=!1}if(e.isParent){var l={currentPage:e.pagination.page,itemsPerPage:e.itemsPerPage,customer_ids:[parseInt(t.params.uid)],status:function(){var e=n.get("ac_filter");return e?e:null}()};e.sift_start_time&&e.sift_end_time&&(l.start_time=e.sift_start_time,l.end_time=e.sift_end_time),i.load("accheck/lists","POST",l).then(s,o)}}e.isParent=!0,e.itemsPerPage=10,e.accountLists=[],e.filter={index:function(){var e=n.get("ac_filter");return null!==e?e:0}(),changeIndex:function(t){e.filter.index=t,n.set("ac_filter",t),e.accountLists=[],e.pagination.init(l),e.pagination.nextPage()}},e.pagination=a,e.pagination.init(l),e.pagination.nextPage(),e.func={filterStatus:function(e,t){return 1===parseInt(t)?"逾期未付":e},goDetail:function(e){t.go("page.customerdetail.acdetail",{account_id:e.id})},getStatusClass:function(e,t){if(1===parseInt(t))return"label-default";switch(e||(e=2),e=parseInt(e)){case 2:return"label-warning";case 3:return"label-info";case 4:return"label-danger";case 5:return"label-success"}},sift:function(){var t=(new Date).getTime(),i=s.open({templateUrl:"app/modules/cdetail/sift.html",animation:!0,controller:"acSiftController",size:"sm"});i.result.then(function(i){var a=(new Date).getTime();o.send("对账管理筛选",null,a-t),e.sift_start_time=i.start_time/1e3,e.sift_end_time=i.end_time/1e3,e.pagination.init(l),e.accountLists=[],e.pagination.nextPage()},function(){e.sift_start_time=null,e.sift_end_time=null,e.pagination.init(l),e.accountLists=[],e.pagination.nextPage()})},getMore:function(){e.pagination.isDone||e.pagination.nextPage()}}}]),angular.module("dachuwang").controller("NewAddOrderListsController",["$scope","$modalInstance","rpc","time_type","daChuLocal","bd_id",NewAddOrderListsController]),angular.module("dachuwang").controller("BackFlowWaterController",["$scope","$modalInstance","daChuLocal","rpc","time_type",BackFlowWaterController]),angular.module("dachuwang").controller("AskDialogController",["$scope","$modalInstance",function(e,t){e.close=function(){t.close()}}]),angular.module("dachuwang").controller("pageCtrl",["$scope",function(){}]),angular.module("dachuwang").controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(e,t,i){e.items=i,e.selected={item:e.items[0]},e.ok=function(){t.close(e.selected.item)},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("dachuwang").controller("headerCtrl",["$scope","$state","$window","daChuLocal",function(e,t,i,a){e.$state=t;var n=parseInt(a.get("role_id"));e.roleID=n,e.showMap=function(){i.jsInterface&&i.jsInterface.cloudMap?i.jsInterface.cloudMap(n):i.alert("请使用客户端操作！")},e.addCustomer=function(){t.go("page.custorm")},e.addVisit=function(){t.go("page.visit-add")}}]),angular.module("dachuwang").controller("footerCtrl",["$scope","$state","daChuLocal","$cookieStore","daChuDialog","Analysis",function(e,t,i,a,n,s){function o(t){e.showType!==e.tabList[t].status&&(e.showType=e.tabList[t].status,1!==t&&r())}function l(e){if(!d)return void(d=(new Date).getTime());var t=function(){var t;for(t=0;t<c.length;t++)if(c[t].href===e)return c[t].name+"模块";return null}();if(t){var i=(new Date).getTime(),a=i-d;d=i,s.send(t,null,a),console.log(t+"  "+a)}}function r(){i.remove("filter_sift"),i.remove("search_key"),i.remove("time_type")}var c=[{name:"业绩统计",glyphicon:"glyphicon-home",href:"page.homemanage",status:"home"},{name:"客户管理",glyphicon:"glyphicon-cloud",href:"page.manage",status:"crm",showBadge:!0},{name:"拜访",glyphicon:"glyphicon-calendar",href:"page.visit",status:"visit"},{name:"更多",glyphicon:"glyphicon-option-horizontal",status:"more",href:"page.more"}],d=null;e.$on("pageChanged",function(e,t){-1!==[0,1,2,3].indexOf(t.tabIndex)&&o(t.tabIndex)}),e.tabList=c,e.collen=12/e.tabList.length,e.showType=function(t){return e.tabList[t].status}(t.current.data.tabIndex),e.changeState=function(e){t.current.name!==e&&("page.custorm"===t.current.name?n.tips({bodyText:"返回将不保存本次编辑的内容",actionText:"确定",ok:function(){l(t.current.name),t.go(e)}}):(l(t.current.name),t.go(e)))}}]),angular.module("dachuwang").factory("userAuthService",["rpc","$cookieStore","daChuLocal",function(e,t,i){var a=function(){var t=i.get("token");t||e.redirect("user/login")},n=function(){var e=i.get("token");return!!e};return{checkLogin:a,isLogined:n}}]),angular.module("dachuwang").factory("userService",["$http","$q","appConfigure","daChuLocal",function(e,t,i,a){var n=i.url,s=3e4,o=function(){var i=new Date,o=a.get("baseInfo");if(o&&!isNaN(o.pro_time)&&o.pro_time+s>i.getTime())return t.when(o.data);var l=t.defer();return e.get(n+"/customer/baseinfo").success(function(e){var t=[];if(0===e.status){var t=e.info;a.set("packaged_cate",{pro_time:i.getTime(),data:t}),l.resolve(t)}else l.reject("status not equals 0")}).error(function(e){l.reject(e)}),l.promise},l=function(e){var i=t.defer(),n={topName:"",list:[]},s=a.get("cateArr");if(s&&s.list.top.length>0){var o=!1;angular.forEach(s.list.second,function(t){angular.forEach(t,function(t){return t.id===e?(n.topName=t.name,void(o=!0)):void 0}),o===!0}),o===!1&&i.reject("error parent category id"),angular.forEach(s.list.second_child[e],function(e){n.list.push({pro_name:e.name,pro_id:e.id,pro_upid:e.upid})}),i.resolve(n)}else i.reject("you must load home page first");return i.promise};return{baseInfo:o,changePassword:l}}]),angular.module("dachuwang").factory("urlHistoryService",function(){function e(e){a.length>=n&&a.shift(),a.push(e)}function t(){if(a.length<=0)return null;var e=a.pop();return e}function i(){return a.length<=0?null:a[a.length-1]}var a=[],n=20;return{push:e,pop:t,getLast:i}}),angular.module("dachuwang").factory("daChuTimer",function(){var e={getNow:function(){return parseInt((new Date).getTime()/1e3)},cacheTime:30};return{getNow:e.getNow,setCacheTime:function(t){e.cacheTime=parseInt(t)},compare:function(t){var i=this.getNow();return parseInt(t)+e.cacheTime>i?!0:!1}}}),angular.module("dachuwang").factory("rpc",["$http","$q","$location","$cookieStore","appConfigure","daChuLocal",function(e,t,i,a,n,s){return{load:function(i,a,o){var l=this,r=t.defer();return void 0==a&&(a="POST"),e({url:n.url+"/"+i+"?r="+Math.random(),method:a,cache:!1,withCredentials:!0,data:o,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){e&&-100===e.status?(s.remove("token"),r.reject("您还未登录，请先登录。"),l.redirect("/user/login",l.refer)):e&&0===e.status?r.resolve(e):r.reject(e&&0!==e.status?e.msg+" 服务器拒绝添加":"请求失败，请检查网络。")}).error(function(){r.reject("请求无法发送到服务器")}),r.promise},init:i,refer:"/",redirect:function(e,t){return void 0!=t?this.refer=t:""==e&&i.path(this.refer),i.path(e),!1}}}]),angular.module("dachuwang").factory("pagination",function(){var e={page:0,isProcessing:!1,processingText:"努力加载中...",isDone:!1,more:"点击加载更多",callback:null};return e.nextPage=function(){e.isProcessing||e.isDone||(e.more="正在加载更多...",e.isProcessing=!0,e.page++,e.callback&&e.callback(function(t){t?(e.isDone=!0,e.more="没有更多了"):e.more="点击加载更多",e.isProcessing=!1}))},e.init=function(t){e.page=0,e.isProcessing=!1,e.isDone=!1,e.more="点击加载更多",e.callback=t},e}),angular.module("dachuwang").factory("notifyService",["$http",function(){var e=function(){return[{title:"您的订单201502280123已经在配送路上",content:"这里是详情"},{title:"您的订单201502280188已经在配送路上",href:"这里是详情"}]};return{getAll:e}}]),angular.module("dachuwang").factory("daChuLocal",function(){var e={get:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null},set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},remove:function(e){localStorage.removeItem(e)}};return e}),angular.module("dachuwang").factory("geo",["$q",function(e){var t=function(){var t={lat:"",lng:""},i=e.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t.lat=e.coords.latitude,t.lng=e.coords.longitude,i.resolve(t)},function(e){i.reject("ERROR("+e.code+"):"+e.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):i.reject("未开启GPS定位，请先打开手机的GPS定位功能"),i.promise};return{info:t}}]),angular.module("dachuwang").factory("daChuDialog",["$modal","$window",function(e,t){var i=function(t,i){var a={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},n={templateUrl:"myModalContent.html"};angular.extend(n,i),angular.extend(a,t);e.open({templateUrl:n.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return a}}})},a=function(e){t.jsInterface?t.jsInterface&&t.jsInterface.toast&&t.jsInterface.toast(e):t.alert(e)};return{tips:i,alert:a}}]),angular.module("dachuwang").factory("Analysis",["$window","daChuDialog",Analysis]),angular.module("ngLocale",[],["$provide",function(e){var t={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ERANAMES:["公元前","公元"],ERAS:["公元前","公元"],FIRSTDAYOFWEEK:6,MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],WEEKENDRANGE:[5,6],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"y年M月d日",mediumTime:"ah:mm:ss","short":"yy/M/d ah:mm",shortDate:"yy/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ -",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"zh-cn",pluralCat:function(){return t.OTHER}})}]),angular.module("dachuwang").filter("money",function(){return function(e,t){return e=parseFloat(e)||0,t=0/0!=parseInt(t)?parseInt(t):1,e.toFixed(t)}}),angular.module("dachuwang").directive("updateTitle",["$rootScope","$timeout",function(e,t){return{link:function(i,a){var n=function(e,i){var n="大厨网";i.data&&i.data.pageTitle&&(n=i.data.pageTitle),t(function(){a.text(n)},0,!1)};e.$on("$stateChangeSuccess",n)}}}]),angular.module("dachuwang").directive("updateBackstack",["$rootScope","req",function(e){return{link:function(t,i){var a=function(e,t){var a="page";t.backPath&&(a=t.backPath),i.attr("ui-sref",a)};e.$on("$stateChangeSuccess",a)}}}]),angular.module("dachuwang").directive("reback",["$state","daChuDialog",function(e,t){function i(e,t){t&&(e?t.go(e):history.go(-1))}return{link:function(a,n){n.bind("click",function(){var a=e.current.data;a.showTips?t.tips({bodyText:"返回将不保存本次编辑的内容",actionText:"确定",ok:function(){i(a.backState,e)}}):i(a.backState,e)})}}}]),angular.module("dachuwang").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,i){function a(e){var t=localStorage.getItem(e);return t?parseInt(JSON.parse(t)):null}function n(){var e=a("role_id");return null===e||-1!==r.indexOf(e)?!0:!1}var s="app/modules/",o="components/",l="大厨CRM",r=[12,14],c={home:0,crm:1,visit:2,more:3};e.state("page",{url:"/",data:{pageTitle:l,tabIndex:c.home},views:{"":{templateUrl:o+"page/page.html",controller:"pageCtrl"},"@page":{templateUrl:function(){return n()?s+"home/home.html":s+"home/dblist.html"},controllerProvider:function(){return n()?"homeCtrl":"DblistController"}}}}).state("page.home",{url:"home/{bd_id:.*}",templateUrl:s+"home/home.html",controller:"homeCtrl",data:{pageTitle:l,tabIndex:c.home,showBack:n()?!1:!0}}).state("page.homemanage",{url:"statistic",templateUrl:function(){return n()?s+"home/home.html":s+"home/dblist.html"},controllerProvider:function(){return n()?"homeCtrl":"DblistController"},data:{pageTitle:l,tabIndex:c.home}}).state("loginpage",{url:"/user/login",data:{pageTitle:"登录"},templateUrl:s+"user/login.html",controller:"loginCtrl"}).state("page.password",{url:"user/password",data:{pageTitle:"修改密码",showBack:!0},templateUrl:s+"user/password.html",controller:"userPassCtrl"}).state("page.editcustomer",{url:"edit/:customer_id",data:{pageTitle:"编辑客户",tabIndex:c.crm,showBack:!0},templateUrl:s+"custorm/editcustomer.html",controller:"EditCustomerController"}).state("page.crm",{url:"crm/:invite_id",data:{pageTitle:"客户管理",tabIndex:c.crm,showBack:!0,showMapRight:!0},templateUrl:function(){return s+"custorm/list.html"},controller:"crmCtrl"}).state("page.potlist",{url:"potlist/:invite_id",data:{pageTitle:"潜在客户",tabIndex:c.crm,showBack:!0},templateUrl:s+"custorm/potlist.html",controller:"PotlistController"}).state("page.openpot",{url:"openpot/:potid",data:{pageTitle:"添加客户",tabIndex:c.crm,showBack:!0,showTips:!0},templateUrl:s+"custorm/openpot.html",controller:"OpenpotController"}).state("page.editpot",{url:"editpot/:potid",data:{pageTitle:"编辑客户",tabIndex:c.crm,showBack:!0,showTips:!0},templateUrl:s+"custorm/editpot.html",controller:"EditpotController"}).state("page.manage",{url:"manage",data:{pageTitle:"客户管理",tabIndex:c.crm,showMap:!0,showAddCustomer:!0},templateUrl:function(){return n()?s+"custorm/list.html":s+"custorm/manage.html"},controllerProvider:function(){return n()?"crmCtrl":"manageController"}}).state("page.custorm",{url:"custorm",data:{pageTitle:"添加客户",showBack:!0},templateUrl:function(){return s+"custorm/create.html"},controller:"custormCtrl"}).state("page.potential",{url:"potential",data:{pageTitle:"潜在客户",tabIndex:c.custorm,showBack:!0},templateUrl:s+"custorm/potential.html",controller:"PotentialController"}).state("page.userCenter",{url:"user/center",templateUrl:s+"user/center.html",controller:"UserCenterCtrl",data:{pageTitle:"个人中心",tabIndex:c.more,showBack:!0}}).state("page.seainfodetail",{url:"seainfo/{uid:int}",templateUrl:s+"cdetail/seainfo.html",controller:"SeainfoController",data:{pageTitle:"客户详情",tabIndex:c.crm,showBack:!0}}).state("page.more",{url:"more",templateUrl:s+"more/more.html",controller:"MoreController",data:{pageTitle:"更多",tabIndex:c.more}}).state("page.visit",{url:"visit",templateUrl:function(){return n()?s+"visit/bd.index.html":s+"visit/bdm.index.html"},controllerProvider:function(){return n()?"BdIndexCtrl":"BdmIndexCtrl"},data:{pageTitle:"拜访",tabIndex:c.visit,showAddVisit:!0}}).state("page.visit-bd",{url:"visit/bd/{bd:int}",templateUrl:s+"visit/bd.history.html",controller:"BdIndexCtrl",data:{pageTitle:" 拜访",tabIndex:c.visit,showAddVisit:!0}}).state("page.visit-add",{url:"visit/add/{shop:string}",templateUrl:s+"visit/add.html",controller:"VisitAddCtrl",data:{pageTitle:"添加拜访",tabIndex:c.visit,showBack:!0,backState:"page.visit"}}).state("page.visit-modify",{url:"visit/modify/{vid:int}/{date:string}",templateUrl:s+"visit/modify.html",controller:"VisitModifyCtrl",data:{pageTitle:"修改拜访日期",showBack:!0,tabIndex:c.visit,backState:"page.visit"}}).state("page.visit-customer",{url:"visit/customer/{vid:int}/{uid:int}/{pid:int}",templateUrl:s+"visit/customer.html",controller:"VisitCustomerCtrl",data:{pageTitle:"进店拜访",tabIndex:c.visit,showBack:!0,backState:"page.visit"}}).state("page.visit-customer-info",{url:"visit/customerInfo/{vid:int}",templateUrl:s+"visit/customer.info.html",controller:"VisitCustomerInfoCtrl",data:{pageTitle:"拜访记录",showBack:!0,tabIndex:c.visit,backState:"page.visit"}}).state("page.visit-add-customer",{url:"visit/addCustomer",templateUrl:s+"visit/add.customer.html",controller:"VisitAddCustomerCtrl",data:{pageTitle:"私海客户",tabIndex:c.visit,showBack:!0,backState:"page.visit-add"}}).state("page.customerdetail",{url:"cdetail/{uid:int}",data:{pageTitle:"客户详情",tabIndex:c.crm,showBack:!0,backState:"page.manage"},views:{"":{templateUrl:s+"cdetail/cdetailnav.html",controller:"CdetailNavController"},"@page.customerdetail":{templateUrl:s+"cdetail/cdetailinfo.html",controller:"CdetailInfoController"}}}).state("page.customerdetail.cdetailhistory",{url:"/his",data:{pageTitle:"历史归属",tabIndex:c.crm,showBack:!0},templateUrl:s+"cdetail/cdetailhis.html",controller:"CdetailHisController"}).state("page.cdetailhistory",{url:"{uid:int}/history",data:{pageTitle:"历史归属",tabIndex:c.crm,showBack:!0},templateUrl:s+"cdetail/history.html",controller:"HisController"}).state("page.customerdetail.trends",{url:"/trends",data:{pageTitle:"客户详情",tabIndex:c.crm,showBack:!0,backState:"page.manage"},templateUrl:s+"cdetail/trends.html",controller:"CtrendsController"}).state("page.customerdetail.orderdetail",{url:"/order/{order_number}",data:{pageTitle:"订单详情",tabIndex:c.crm,showBack:!0,backState:null},templateUrl:s+"cdetail/orderdetail.html",controller:"CtrendsOrderController"}).state("page.customerdetail.accountChecking",{url:"/accountchecking",data:{pageTitle:"客户详情",tabIndex:c.crm,showBack:!0,backState:"page.manage"},templateUrl:s+"cdetail/accountchecking.html",controller:"AccountCheckingController"}).state("page.customerdetail.acdetail",{url:"/acdetail/:account_id",data:{pageTitle:"对账管理",tabIndex:c.crm,showBack:!0,backState:null},templateUrl:s+"cdetail/acdetail.html",controller:"AcdetailController"}),t.otherwise("/home"),i.html5Mode(!0)}]),angular.module("dachuwang").config(["$tooltipProvider",function(e){e.setTriggers({click:"mouseleave"})}]),angular.module("dachuwang").provider("appConfigure",{$get:["$location",function(e){var t=e.$$host;return t.indexOf("dachuwang")<0&&(t="crm.dachuwang.net"),{bd_and_am:[12,14],url:"http://api."+t}}]}),angular.module("dachuwang").run(["$templateCache",function(e){e.put("components/footer/footer.html",'<nav class="nav fix-bottom action-nav" ng-controller="footerCtrl"><div class="container"><ul class="nav action-nav actionbar-tabs"><li class="col-xs-{{collen}}" ng-repeat="tab in tabList" ng-class="{active : showType == tab.status}"><a ng-click="changeState(tab.href)"><span class="glyphicon {{tab.glyphicon}}"></span>{{tab.name}}</a></li></ul></div></nav>'),e.put("components/header/header.html",'<header class="head" ng-controller="headerCtrl"><div class="container-fluid"><div class="row head-top"><div class="col-xs-4 backup text-left"><a reback="" ng-show="$state.current.data.showBack"><span class="glyphicon glyphicon-menu-left"></span>&nbsp;返回</a><div class="pull-left" ng-show="$state.current.data.showMap" ng-click="showMap()"><img src="assets/images/icon.png" height="30" width="30"> <span>云图</span></div><em ng-show="!$state.current.data.showBack">&nbsp;</em></div><div class="col-xs-4 listname" ng-bind="$state.current.data.pageTitle"></div><div class="col-xs-4"><div class="pull-right" ng-show="$state.current.data.showMapRight" ng-click="showMap()"><img src="assets/images/icon.png" height="30" width="30"> <span>云图</span></div><div class="pull-right" ng-show="$state.current.data.showAddCustomer" ng-click="addCustomer()"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> <span>添加客户</span></div><div class="pull-right" ng-show="$state.current.data.showAddVisit && roleID!=13" ng-click="addVisit()"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> <span>添加拜访</span><div></div></div></div></div></div></header><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <p class="text-center">{{items.bodyText}}</p> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script>'),e.put("components/page/page.html",'<div ng-include="\'components/header/header.html\'"></div><div ui-view=""></div><div ng-include="\'components/footer/footer.html\'"></div>'),e.put("app/modals/home/askdialog.html",'<div class="modal-body clearfix"><div class="ask_cdetail modal-dialog"><h4>订货金额</h4><p>统计本时间段客户下单金额：</p><p>不包含运费、优惠及押金，不包含退货拒收问题</p><h4>母订单数</h4><p>客户本时间段下单数</p><h4>订货客单价</h4><p>本时间段订货金额/母订单数</p><h4>下单频率</h4><p>本时间段下单天数/本时间段总天数</p></div><button type="button" class="btn btn-success pull-right" ng-click="close()">关闭</button></div>'),e.put("app/modals/home/backflowwater.html",'<div class="modal-header pos-rel"><h3 class="modal-title">新增回款流水</h3><span class="pos-abs to-right-top ft-20 pd-10" ng-click="close()">&times;</span></div><div class="modal-body"><table class="table table-striped"><thead><tr><th>店铺名</th><th>回款流水(元)</th></tr></thead><tbody><tr ng-repeat="item in dataLists"><td>{{item.shop_name}}</td><td>{{item.flow_water/100}}</td></tr></tbody></table><pager total-items="page.total" ng-model="page.currentPage" items-per-page="page.itemsPerPage" previous-text="上一页" next-text="下一页"></pager></div>'),e.put("app/modals/home/newaddorderlists.html",'<div class="modal-header pos-rel"><h3 class="modal-title">新增下单数</h3><span class="pos-abs to-right-top ft-20 pd-10" ng-click="close()">&times;</span></div><div class="modal-body"><table class="table table-striped"><thead><tr><th>店铺名</th><th>下单流水(元)</th></tr></thead><tbody><tr ng-repeat="item in dataLists"><td>{{item.shop_name}}</td><td>{{item.flow_water/100}}</td></tr></tbody></table><pager total-items="page.total" ng-model="page.currentPage" items-per-page="page.itemsPerPage" previous-text="上一页" next-text="下一页"></pager></div>'),e.put("app/modules/cdetail/accountchecking.html",'<div class="mt-nav"><div class="row user_state"><div class="mt-10"><a class="btn btn-xs" ng-class="{\'btn-danger\': filter.index===0,\'btn-default\': filter.index!==0}" ng-click="filter.changeIndex(0)">全部</a> <a class="btn btn-xs" ng-class="{\'btn-danger\': filter.index===2,\'btn-default\': filter.index!==2}" ng-click="filter.changeIndex(2)">未打款</a> <a class="btn btn-xs" ng-class="{\'btn-danger\': filter.index===3,\'btn-default\': filter.index!==3}" ng-click="filter.changeIndex(3)">对账中</a> <a class="btn btn-xs" ng-class="{\'btn-danger\': filter.index===4,\'btn-default\': filter.index!==4}" ng-click="filter.changeIndex(4)">已打款</a> <a class="btn btn-xs" ng-class="{\'btn-danger\': filter.index===5,\'btn-default\': filter.index!==5}" ng-click="filter.changeIndex(5)">已收款</a> <a style="color:black;" class="pull-right" ng-click="func.sift()">筛选<span class="glyphicon glyphicon-filter"></span></a></div><div class="mt-10"><p ng-show="!isParent" class="text-center">子账号无法查看账单</p><table class="table table-striped mb-0" ng-show="!pagination.isProcessing && isParent"><thead><tr><th>账期</th><th>金额(元)</th><th>状态</th></tr></thead><tbody><tr class="fs-13" ng-repeat="item in accountLists" ng-click="func.goDetail(item)"><td>{{item.start_time}}~{{item.end_time}}</td><td>{{item.total_price}}</td><td><span class="label {{func.getStatusClass(item.status_code, item.expire_status)}}">{{func.filterStatus(item.status,item.expire_status)}}</span></td></tr></tbody></table></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-show="!pagination.isProcessing && isParent" ng-click="func.getMore()"><h4 class="text-center">{{pagination.more}}</h4></div></div>'),e.put("app/modules/cdetail/acdetail.html",'<div class="mt-nav"><div ng-show="isLoading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="user_state"><table class="table table-striped" ng-show="!isLoading"><tbody><tr><td>本账期</td><td>{{billing_info.start_time}}&nbsp;&nbsp;&nbsp;{{billing_info.end_time}}</td></tr><tr><td>当前状态</td><td><span class="label {{func.getStatusClass(billing_info.status_code, billing_info.expire_status)}}">{{func.getStatus(billing_info.status, billing_info.expire_status)}}</span></td></tr><tr><td>账期</td><td>{{billing_info.billing_cycle}}</td></tr><tr><td>对账日期</td><td>{{func.getLaterDate(billing_info.end_time)}}</td></tr><tr><td>结款日期</td><td>{{func.getLaterDate(billing_info.end_time,2)}}</td></tr><tr><td>应付款总计</td><td>{{billing_info.total_price}}元</td></tr><tr><td>收款凭证</td><td ng-if="!billing_info.payment_evidence">未上传</td><td ng-if="billing_info.payment_evidence"><a style="color:blue;" ng-click="func.showGraph()">点击查看</a></td></tr><tr><td>结款明细</td><td><a style="color:blue;" ng-click="func.showDetails()">点击查看</a></td></tr></tbody></table><div class="panel panel-default" ng-show="!isLoading"><div class="panel-body row"><div class="col-xs-9"><p>客户姓名：{{customer_info.shop_name}}</p><p>电话号码：{{customer_info.mobile}}</p></div><div class="col-xs-3"><a href="tel:{{customer_info.mobile}}"><span style="font-size:45px; color:#008000;" class="glyphicon glyphicon-earphone"></span></a></div></div></div></div></div>'),e.put("app/modules/cdetail/cdetailhis.html",'<div ng-show="isLoading === false" class="cdetail_wp"><dl class="block cdedl"><dt><span class="pull-right">所属销售</span> <span>时间</span></dt><dd ng-repeat="m in historylist.list"><span class="pull-right">{{m.name}}({{m.role}})</span> {{m.time | date :\'yyyy/MM/dd\'}}</dd><a ng-click="func.goback()" class="btn btn-block btn-success">返回</a></dl></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/cdetailinfo.html",'<div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="cdetail_wp" ng-if="isLoading === false"><accordion close-others="one"><accordion-group is-open="newmsg"><accordion-heading>{{userinfo.newmsg}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : newmsg, \'glyphicon-chevron-right\' : !newmsg}"></i></accordion-heading><div>{{customer.sms}}</div></accordion-group><accordion-group is-open="analysis_open"><accordion-heading>客户分析<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : analysis_open, \'glyphicon-chevron-right\' : !analysis_open}"></i></accordion-heading><div class="row"><div class="col-xs-4"><select class="form-control" ng-model="statistics.analysis_time" ng-options="item.name for item in statistics.analysis_times" ng-click="btnAnalysis(1)"></select></div><div class="col-xs-5"><select class="form-control" ng-model="statistics.analysis_shop" ng-options="item.name for item in statistics.analysis_shops" ng-click="btnAnalysis(2)"></select></div><div class="col-xs-3"><button class="btn btn-danger" ng-click="func.buy_analysis(statistics.analysis_time,statistics.analysis_shop)">查询</button></div></div><div ng-show="is_req_loading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div ng-show="is_show_analysis"><canvas class="mt-10 chart chart-doughnut" data="statistics.analysis_data" labels="statistics.analysis_labels" legend="true"></canvas><div class="analysis_table"><table class="table table-striped"><thead><tr><th>品类</th><th>总金额(元)</th><th>占比</th></tr></thead><tbody><tr ng-repeat="item in statistics.analysis_table"><td>{{item.name}}</td><td>{{item.value/100}}</td><td>{{item.rate}}</td></tr></tbody></table></div><p class="total_data">本时间段统计数据<span ng-click="func.ask_dialog()" class="glyphicon glyphicon-question-sign"></span></p><ul class="list-group"><li class="list-group-item" ng-repeat="item in statistics.buy_data">{{item.name}}<span class="pull-right">{{item.value}}</span></li></ul></div><h5 class="text-center" ng-show="is_show_none">查询时间段内客户并未下单</h5></accordion-group><accordion-group is-open="historymsg"><accordion-heading>{{userinfo.history}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : historymsg, \'glyphicon-chevron-right\' : !historymsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>历史订单数<span class="pull-right">{{history.order_num}}</span></li><li>历史流水金额<span class="c_fs14 pull-right">{{history.order_amount/100 | currency : \'￥\' : 2}}</span></li><li>历史移交记录<span class="pull-right"><span class="glyphicon glyphicon-chevron-right" ng-click="func.history_detail()"></span></span></li></ul></div></accordion-group><accordion-group is-open="basemsg"><accordion-heading>{{userinfo.baseinfo}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : basemsg, \'glyphicon-chevron-right\' : !basemsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>注册时间<span class="pull-right">{{baseinfo.created_time*1000 | date:\'yyyy-MM-dd\'}}</span></li><li>店铺名称<span class="pull-right">{{baseinfo.shop_name}}</span></li><li>客户类型<span class="pull-right">{{baseinfo.customer_type}}</span></li><li>子母账号类型<span class="pull-right">{{baseinfo.account_type}}</span></li><li ng-if="baseinfo.parent_mobile">关联母账号<span class="pull-right">{{baseinfo.parent_mobile}}</span></li><li>客户姓名<span class="pull-right">{{baseinfo.name}}</span></li><li class="mobile-phone">客户手机号<span class="pull-right">{{baseinfo.mobile}}<a class="phone" href="tel:{{baseinfo.mobile}}"><span class="glyphicon glyphicon-earphone ml-10"></span></a></span></li><li>收货人姓名<span class="pull-right">{{baseinfo.recieve_name}}</span></li><li class="mobile-phone">收货人手机号<span class="pull-right">{{baseinfo.recieve_mobile}}<a class="phone" href="tel:{{baseinfo.recieve_mobile}}"><span class="glyphicon glyphicon-earphone ml-10"></span></a></span></li><li>餐饮类别<span class="pull-right">{{baseinfo.shop_type}}</span></li><li>店铺规模<span class="pull-right">{{baseinfo.dimension_name}}</span></li><li>预估日均采购量（果蔬/肉）<span class="pull-right">{{baseinfo.greens_meat_estimated}}</span></li><li>预估日均采购量（米面粮油）<span class="pull-right">{{baseinfo.rice_grain_estimated}}</span></li><li class="address">详细地址<span class="pull-right"><a ng-click="func.view_map()"><span class="glyphicon glyphicon-map-marker ml-10"></span></a></span><span class="pull-right adress_text">{{baseinfo.address}}</span></li><li>配送线路<span class="pull-right">{{baseinfo.line}}</span></li><li>备注<span class="pull-right">{{baseinfo.remark}}</span></li></ul></div><div class="img_b mb-10 clearfix" ng-if="imgurl.length > 0"><div class="img_block"><a ng-click="openmodal(0)"><img width="100%" ng-src="{{imgurl[0].url}}"></a></div></div><div class="btn-group btn-group-justified"><a class="btn btn-success" ng-click="func.edit_customer()">编辑</a> <a class="btn btn-warning" ng-click="func.reset_password()">重置密码</a> <a class="btn btn-info" ng-click="func.new_register_change_shared()">置入公海</a></div></accordion-group></accordion></div>'),e.put("app/modules/cdetail/cdetailnav.html",'<div class="warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-33"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus({{tab.status}});" ui-sref="{{tab.href}}">{{tab.name}}</a></li></ul></div></div><div ui-view=""></div></div>'),e.put("app/modules/cdetail/history.html",'<div ng-show="isLoading === false" class="cdetail_wp"><dl class="block cdedl"><dt><span class="pull-right">所属销售</span> <span>时间</span></dt><dd ng-repeat="m in historylist.list"><span class="pull-right">{{m.name}}({{m.role}})</span> {{m.time | date :\'yyyy/MM/dd\'}}</dd><a ng-click="func.goback()" class="btn btn-block btn-success">返回</a></dl></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/orderdetail.html",'<div ng-show="isLoading === false" class="cdetail_wp clearfix orderinfo_wp"><dl class="orderinfo_dl"><dt>所属销售</dt><dd>{{data.sale_name}}</dd></dl><dl class="orderinfo_dl"><dt>订单编号</dt><dd>{{data.order_number}}</dd></dl><dl class="orderinfo_dl"><dt>订单状态</dt><dd class="label {{data.status_class}}"><span>{{data.status}}</span></dd></dl><dl class="orderinfo_dl"><dt>实收金额</dt><dd>{{data.deal_price | currency : \'&yen;\' : 2}}</dd></dl><dl class="orderinfo_dl"><dt>订单金额</dt><dd>{{data.total_price | currency : \'&yen;\' : 2}}</dd></dl><dl class="orderinfo_dl"><dt>下单时间</dt><dd>{{data.created_time | date: \'yyyy-MM-dd HH:mm:ss\'}}</dd></dl><dl class="orderinfo_dl"><dt>送货时间</dt><dd>{{data.deliver_date | date: \'yyyy-MM-dd\'}} {{data.deliver_time}}</dd></dl><dl class="orderinfo_dl"><dt>送货司机</dt><dd>{{data.driver_name}}</dd></dl><dl class="orderinfo_dl"><dt>送货司机电话</dt><dd ng-if="data.driver_mobile === \'暂无\'">{{data.driver_mobile}}</dd><dd ng-if="data.driver_mobile !== \'暂无\'"><a class="color-black" href="tel:{{data.driver_mobile}}">{{data.driver_mobile}}<span class="glyphicon glyphicon-earphone pdl-10 color-green"></span></a></dd></dl><dl class="orderinfo_dl orderconf"><dt>订单内容</dt><dd ng-repeat="m in data.content"><div><div>{{m.name}}*{{m.quantity}} = {{m.sum_price | currency : \'&yen;\' : 2}}</div><div ng-repeat="v in m.spec">{{v.name}}:{{v.val}}</div></div></dd></dl><a ng-click="func.userback()" class="btn mb-10 btn-block btn-success">返回</a></div><div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div>'),e.put("app/modules/cdetail/seainfo.html",'<div ng-show="isLoading" class="cdetail_load"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="warp-page cdetail_wp" ng-if="isLoading === false"><accordion close-others="one"><accordion-group is-open="historymsg"><accordion-heading>{{userinfo.history}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : historymsg, \'glyphicon-chevron-right\' : !historymsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>历史订单数<span class="pull-right">{{history.order_num}}</span></li><li>历史流水金额<span class="c_fs14 pull-right">{{history.amount/100 | currency : \'￥\' : 2}}</span></li><li>历史移交记录<span class="pull-right">{{history.history_belong}}&nbsp;&nbsp;<span class="glyphicon glyphicon-chevron-right" ng-click="func.history_detail()"></span></span></li></ul></div></accordion-group><accordion-group is-open="basemsg"><accordion-heading>{{userinfo.baseinfo}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\' : basemsg, \'glyphicon-chevron-right\' : !basemsg}"></i></accordion-heading><div class="cdelist"><ul class="list-group"><li>注册时间<span class="pull-right">{{baseinfo.created_time*1000 | date:\'yyyy-MM-dd\'}}</span></li><li>店铺名称<span class="pull-right">{{baseinfo.shop_name}}</span></li><li>客户姓名<span class="pull-right">{{baseinfo.name}}</span></li><li>餐饮类别<span class="pull-right">{{baseinfo.shop_type}}</span></li><li>店铺规模<span class="pull-right">{{baseinfo.dimensions}}</span></li><li>所属系统<span class="pull-right">{{baseinfo.site}}</span></li><li class="address">详细地址<span class="pull-right"><a ng-click="func.view_map()"><span class="glyphicon glyphicon-map-marker ml-10"></span></a></span><span class="pull-right adress_text">{{baseinfo.address}}</span></li><li>配送线路<span class="pull-right">{{baseinfo.line}}</span></li><li>备注<span class="pull-right">{{baseinfo.remark}}</span></li></ul></div><div class="img_b mb-10 clearfix" ng-if="imgurl.length > 0"><div class="img_block" ng-repeat="m in imgurl"><a ng-click="openmodal($index)"><img width="100%" ng-src="{{m.url}}"></a></div></div><div class="btn-group btn-group-justified"><a ng-show="role_id && baseinfo.is_new" class="btn btn-primary" ng-click="func.new_register_change_private()">加入私海</a></div></accordion-group></accordion></div>'),e.put("app/modules/cdetail/showdetails.html",'<div class="modal-header"><h4 class="modal-title">结款明细</h4></div><div class="modal-body"><table class="table table-striped"><thead><tr><th class="w65">店铺名</th><th class="w35">应付金额</th></tr></thead><tbody><tr ng-repeat="item in shopLists"><td>{{item.shop_name}}</td><td>{{item.deal_price}}</td></tr></tbody></table></div><div class="modal-footer"><button class="btn btn-warning" ng-click="func.close()">关闭</button></div>'),e.put("app/modules/cdetail/sift.html",'<div class="modal-header"><h4 class="modal-title">筛选</h4></div><div class="modal-body"><form class="form" novalidate=""><div class="form-group"><label class="control-label">起始时间</label> <input class="form-control" type="text" datepicker-popup="" ng-model="start_time" is-open="datepicker.start.open" close-text="关闭" ng-focus="datepicker.open(\'start\', $event)" current-text="今天" clear-text="清除"></div><div class="form-group"><label class="control-label">结束时间</label> <input class="form-control" type="text" datepicker-popup="" ng-model="end_time" is-open="datepicker.end.open" close-text="关闭" ng-focus="datepicker.open(\'end\', $event)" clear-text="清除"></div></form></div><div class="modal-footer"><button class="btn btn-primary" ng-click="func.ensure()">确认</button> <button class="btn btn-danger" ng-click="func.cancel()">关闭</button></div>'),e.put("app/modules/cdetail/trends.html",'<div class="cdetail_wp"><div class="row user_state"><div><div class="mt10"><select class="form-control mb-10" ng-show="shopLists.length>1" ng-model="currentShop" ng-options="m.shop_name for m in shopLists" ng-change="func.changeShop()"></select><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="起始时间" current-text="今天" clear-text="清除" close-text="关闭"></div><div class="mt-10"><input type="text" is-open="endOpened" datepicker-popup="yyyy-MM-dd" ng-click="endOpen($event)" datepicker-options="endDateOptions" class="form-control" ng-model="endTime" id="endTime" placeholder="结束时间" current-text="今天" clear-text="清除" close-text="关闭"></div><div class="btn-group mt-10 btn-group-justified"><a class="btn btn-success" ng-click="func.sift()">查询</a> <a class="btn btn-info" ng-click="func.clear()">重置</a></div></div></div><div class="row user_state userstate_title"><div class="col-xs-3" style="padding:0 5px;">下单时间</div><div class="col-xs-6">订单编号</div><div class="col-xs-3">状态</div></div><div ng-show="isloading === false"><div class="row user_state" ng-repeat="m in orderlist"><a class="orderinfo" ng-click="func.orderinfo(m)"><div class="col-xs-3">{{m.created_time | date:\'yyyy/MM/dd\'}}</div><div class="col-xs-6">{{m.order_number}}</div><div class="col-xs-3 {{func.getStatusClass(m.status)}}"><span>{{m.status}}</span></div></a></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-show="!pagination.isDone"><h4 class="text-center" ng-click="pagination.nextPage()">点击加载更多...</h4></div><div class="row block pt-10 pb-10" ng-show="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div><div></div></div></div>'),e.put("app/modules/custorm/create.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><div class="mt-10"><h5>请录入客户信息</h5></div><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" ng-change="show_more_account_option()" required=""><option value="">请选择子母账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="urls">（已上传）</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" required=""><option value="">请选择餐饮类别</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">客户手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input name="username" type="text" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人手机号：<a class="btn btn-warning btn-xs" ng-click="getRecieveInfo()">与客户信息一致</a></label><div class="col-sm-10"><input class="form-control" type="text" name="recievemobile" ng-model="info.recievemobile" placeholder="请输入收货人手机号" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人姓名：</label><div class="col-sm-10"><input class="form-control" type="text" name="recievename" ng-model="info.recievename" placeholder="请输入收货人姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="addr.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="addr.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="userGeo.addr" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">提交</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/editcustomer.html",'<div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">编辑客户信息</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="func.create()" novalidate=""><div class="form-group"><label class="col-xs-5 control-label">餐饮类别：</label><div class="col-xs-7"><select class="form-control" name="shop_type" ng-model="shop_type" ng-options="m.name for m in shop_types" required=""><option value="">请选择餐饮类型</option></select></div></div><div class="form-group"><label class="col-xs-5 control-label">店铺规模：</label><div class="col-xs-7"><select class="form-control" name="dimensions" ng-model="dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-xs-5 control-label">收货人姓名</label><div class="col-xs-7"><input class="form-control" type="text" ng-model="recieve_name" name="recieve_name" placeholder="请输入收货人姓名" required=""></div></div><div class="form-group"><label class="col-xs-5 control-label">收货人电话</label><div class="col-xs-7"><input class="form-control" type="text" ng-model="recieve_mobile" name="recieve_mobile" placeholder="请输入收货人电话" required=""></div></div><div class="form-group"><label class="col-xs-5 control-label">预估日均采购量（果蔬/肉）</label><div class="col-xs-7"><select class="form-control" name="greens_meat_estimated" ng-model="greens_meat_estimated" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量</option></select></div></div><div class="form-group"><label class="col-xs-5 control-label">预估日均采购量（米面粮油）</label><div class="col-xs-7"><select class="form-control" name="rice_grain_estimated" ng-model="rice_grain_estimated" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量</option></select></div></div><div class="form-group"><label class="col-xs-4">详细地址</label> <a class="btn btn-warning btn-sm col-xs-offset-4" ng-click="func.choosePlace()">定位客户地址</a><div class="col-sm-12 mt-10"><input class="form-control" type="text" ng-model="address" name="address" required=""></div></div><div class="form-group"><label class="col-sm-5 control-label">备注：</label><div class="col-sm-7"><input type="text" name="remark" ng-model="remark" class="form-control" placeholder="请输入备注"></div></div><div class="img_b mb-10 clearfix"><div class="img_block"><img width="100%" ng-src="{{urls[0]}}"></div></div><div class="form-group" ng-show="isRequesting===false"><div class="col-xs-offset-1 col-xs-9"><a class="btn btn-block btn-warning" ng-click="func.upload()">重新上传照片</a> <button class="btn btn-block btn-info" type="submit">确认修改</button></div></div><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></form></div></div>'),e.put("app/modules/custorm/editpot.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">编辑潜在客户信息</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" ng-change="show_ka()" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" required="" ng-change="show_more_account_option()"><option value="">请选择子母账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="is_uploaded>0">(已上传{{is_uploaded}}张)</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" ng-change="getShop()" required=""><option value="">请选择餐饮类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">请选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">客户手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="username" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人手机号：<a class="btn btn-warning btn-xs" ng-click="getRecieveInfo()">与客户信息一致</a></label><div class="col-sm-10"><input class="form-control" type="text" name="recievemobile" ng-model="info.recievemobile" placeholder="请输入收货人手机号" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人姓名：</label><div class="col-sm-10"><input class="form-control" type="text" name="recievename" ng-model="info.recievename" placeholder="请输入收货人姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="info.direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">确认修改</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/filter.html",'<div class=""><div class="modal-header"><h4 class="modal-title">筛选客户</h4></div><div class="modal-body" style="overflow:hidden;"><form class="form"><div class="form-group row"><label class="control-label col-xs-4">所属地区</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.provinces" ng-model="sift.province" ng-change="func.getLines()" ng-disabled="true"></select></div></div><div class="form-group row"><label class="control-label col-xs-4">配送线路</label><div class="col-xs-8"><select class="form-control input-sm" ng-disabled="!sift.province" ng-options="item.name for item in property.lines" ng-model="sift.line"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">客户规模</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.dimensions" ng-model="sift.dimensions"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">餐饮类别</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.shop_types" ng-model="sift.shop_type"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">客户类型</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.types" ng-model="sift.customer_type"><option value="">全部</option></select></div></div><div class="form-group row"><label class="control-label col-xs-4">下单情况</label><div class="col-xs-8"><select class="form-control input-sm" ng-options="item.name for item in property.order_type" ng-model="sift.order_type"><option value="">全部</option></select></div></div><button class="btn btn-block btn-success" ng-click="func.reset()">重置</button></form></div><div class="modal-footer"><button class="btn btn-primary" type="button" ng-click="func.ensure()" ng-disabled="isloading">确定</button> <button class="btn btn-warning" type="button" ng-click="func.cancel()">取消</button></div></div>'),e.put("app/modules/custorm/list.html",'<div class="warp-page container-fluid"><div class="head-bottom" ng-if="showTabs"><div class="flex-nav"><ul class="sea-flex"><li><select class="form-control input-sm" name="seas" ng-change="seachange(defaultsea)" ng-model="defaultsea" ng-options="m.name for m in oSea" required=""></select></li><li><select class="form-control input-sm" ng-model="$parent.order_field" ng-options="item.name for item in order_fields" ng-change="$parent.show_order_field()"></select></li><li class="chose_btn"><a ng-click="filterfunc()">筛选<span class="glyphicon glyphicon-filter"></span></a></li></ul></div></div><div ng-class="{\'mt-nav\': showTabs}" class="row search_block"><div ng-class="{\'col-xs-12\': !role_id && !role_id13,\'col-xs-9\' : role_id&& !role_id13}" style="padding:10px;"><form class="text-left"><div class="input-group"><input type="text" class="form-control" ng-model="key" placeholder="店铺名称/手机号码"> <a class="input-group-addon" ng-click="search()">搜索</a></div></form></div><div ng-show="role_id && !role_id13" class="col-xs-3" style="padding:18px 0 0 0"><a style="font-size:16px; color:#333;" ng-click="filterfunc()">筛选<span class="glyphicon glyphicon-filter"></span></a></div><p style="text-align : center; background-color : rgba(234, 232, 215, 0.90)">筛选结果：{{siftNumber}} / {{totalNumber}}</p></div><div ng-if="showType != 0 && showType !=4 && showType != 5" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><div><span class="pull-right glyphicon glyphicon-chevron-right shopinfo_icon" ng-click="func.shopInfo(item)"></span> <span class="label label-success pull-right ml-10" ng-if="item.customer_type != 1">KA客户</span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> 店铺名称：{{item.shop_name}}</div></div><div class="col-xs-12 block-col"><p>姓名：{{item.name}}</p></div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col"><div class="row"><div class="col-xs-9 dress_indent">地址：{{item.address}}</div><div class="col-xs-3 icon-button"><a ng-click="viewMap(item)" class="color-red"><span class="glyphicon glyphicon-map-marker"></span>路线</a></div></div></div><div class="col-xs-12 block-col"><div class="row"><div class="col-xs-9">电话：{{item.mobile}}</div><div class="col-xs-3 icon-button"><a href="tel:{{item.mobile}}" class="color-green" ng-click="analysisPhone()"><span class="glyphicon glyphicon-earphone"></span>电话</a></div></div></div><div class="col-xs-12 block-col" ng-if="item.lack && item.lack!=\'\'"><h5 class="color-red">*系统提示：请编辑补全客户信息</h5></div><div class="col-xs-12 block-col hidden"><a class="btn btn-info btn-sm" ng-diasbled="resetClk" ng-click="resetPass({{item.id}})">重置密码</a> <a class="btn btn-success btn-sm" ng-click="editCustomer(item.id)" ng-disabled="loadingGeo">编辑</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==4" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="label label-success pull-right" ng-if="item.customer_type != 1">KA客户</span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p><span>地址：</span>{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.potential_change_private(item)" ng-disabled="change_button">加入私海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==0" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> <span class="label label-success pull-right" ng-if="item.customer_type != 1">KA客户</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p>地址：{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-info btn-sm" ng-click="openUser({{item.id}})">开通</a> <a class="btn btn-success btn-sm" ng-click="editUser({{item.id}})">编辑</a> <a ng-show="!role_id" class="btn btn-danger btn-sm" ng-click="deleteUser({{item.id}})">删除</a> <a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.potential_change_shared(item)" ng-disabled="change_button">置入公海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div><div ng-if="showType==5" infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block new_user_block" ng-repeat="item in list"><div class="col-xs-12 block-col"><span class="pull-right glyphicon glyphicon-chevron-right shopinfo_icon" ng-click="func.shopInfosea(item)"></span> <span class="label label-danger pull-right" ng-if="item.ka_status">{{item.ka_status}}</span> <span class="label label-success pull-right" ng-if="item.customer_type != 1">KA客户</span> 店铺名称：{{item.shop_name}}</div><div class="col-xs-12 block-col"><p>配送线路：{{item.line_name}}</p></div><div class="col-xs-12 block-col dress_indent"><p>地址：{{item.address}}</p></div><div class="col-xs-12 block-col"><a ng-show="!role_id" class="btn btn-primary pull-right btn-sm" ng-click="func.new_register_change_private(item)" ng-disabled="change_button">加入私海</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div></div>'),e.put("app/modules/custorm/manage.html",'<div class="mt-nav warp-page"><div class="list-group"><a class="list-group-item" ng-if="my" ng-click="viewCustom({{my.uid}})"><span class="badge" ng-if="false">{{my.count}}</span><h5>{{my.name}}的客户</h5></a> <a class="list-group-item" ng-repeat="people in mygroup" ng-click="viewCustom({{people.uid}})"><span class="badge" ng-if="false">{{people.count}}</span><h5>{{people.name}}</h5></a></div><div ng-show="isLoading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div>'),e.put("app/modules/custorm/mycustomer.html",'<div class="mt-nav warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus({{tab.status}});" ui-sref="{{tab.href}}">{{tab.name}}</a></li></ul></div></div><div ui-view=""></div></div>'),e.put("app/modules/custorm/openpot.html",'<script type="text/ng-template" id="suborderInfo.html"><div class="modal-body"> <div class="modal-dialog"> <h4>什么是子母账号？</h4> <ul> <li> 母账号： <ul> <li>非连锁店，自主下单，自主结账</li> <li>连锁店总店，分店及总店均由此账号结账</li> </ul> </li> <li> 子账号： <ul> <li>连锁店分店，自主下单，但由总店的母账号统一结账</li> </ul> </li> </ul> </div> </div></script><div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">确认潜在客户信息并开通</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">客户类型：</label><div class="col-sm-10"><select class="form-control" name="customerType" ng-model="customerType" ng-options="m.name for m in types" required=""><option value="">请选择客户类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">子母账号类型：<span class="glyphicon glyphicon-question-sign" ng-click="suborderInfo()"></span></label><div class="col-sm-10"><select class="form-control" name="accountType" ng-model="account_type" ng-options="m.name for m in account_types" ng-change="show_more_account_option()" required=""><option value="">请选择子母账号账号类型</option></select></div></div><div ng-show="show_account_son == true"><div class="form-group"><label class="col-sm-2 control-label">关联母账号：</label><div class="col-sm-10"><input class="form-control" type="text" name="parentmobile" ng-model="parent_mobile" placeholder="请输入关联母账号手机号"></div></div></div><div class="form-group"><label class="control-label col-sm-2">上传客户门店照片：<a class="btn btn-warning btn-sm" ng-click="upload()">上传照片</a><span ng-if="is_uploaded>0">(已上传{{is_uploaded}}张)</span></label></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select name="shop" ng-model="shop" class="form-control" ng-options="m.name for m in shopTypes" required=""><option value="">请选择餐饮类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">请选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺规模：</label><div class="col-sm-10"><select class="form-control" name="dimensions" ng-model="info.dimensions" ng-options="m.name for m in oDimensions" required=""><option value="">请选择店铺规模</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（果蔬/肉）：</label><div class="col-sm-10"><select class="form-control" name="estimateVegetable" ng-model="info.estimateVegetable" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（果蔬/肉）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">预估日均采购量（米面粮油）：</label><div class="col-sm-10"><select class="form-control" name="estimateRice" ng-model="info.estimateRice" ng-options="m.name for m in estimateds" required=""><option value="">请选择预估日均采购量（米面粮油）</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">客户手机号：</label><div class="col-sm-10"><input name="mobile" type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码" ng-pattern="/^1\\d{10}$/" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">客户姓名：</label><div class="col-sm-10"><input type="text" name="username" ng-model="info.name" class="form-control" placeholder="请输入客户姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人手机号：<a class="btn btn-warning btn-xs" ng-click="getRecieveInfo()">与客户信息一致</a></label><div class="col-sm-10"><input class="form-control" type="text" name="recievemobile" ng-model="info.recievemobile" placeholder="请输入收货人手机号" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">收货人姓名：</label><div class="col-sm-10"><input class="form-control" type="text" name="recievename" ng-model="info.recievename" placeholder="请输入收货人姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：</label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required="" ng-disabled="true"><option value="">请选择省份</option></select></div><label class="col-sm-2 control-label">配送线路：</label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">请选择配送线路</option></select></div></div><div class="container form-group"><label class="clearfix control-label">详细地址：<a class="btn btn-warning btn-sm" ng-click="choosePlace()">定位用户地址</a></label></div><div class="input-group w-100"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写详细地址" required=""> <span class="input-group-btn address-fw"><select class="form-control" name="direction" ng-model="info.direction" ng-options="opt as opt.label for opt in dOptions" required=""><option value="">方位</option></select></span></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：</label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：<span class="color-red">选填</span></label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit" ng-show="!isRequesting">确认开通</button><div ng-show="isRequesting"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div></div></form></div></div>'),e.put("app/modules/custorm/potential.html",'<div class="container-fluid block block-col pb-nav pt-nav"><h4 class="pt-10">在这里记录潜在客户信息</h4><h4>还没有获得的信息可以不填</h4><div class="block pt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form" ng-submit="create()" novalidate=""><div class="form-group"><label class="col-sm-2 control-label">所属系统：</label><div class="col-sm-10"><select ng-model="site" class="form-control" ng-options="m.name for m in sites" ng-change="getSite()"><option value="">选择所属系统</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">餐饮类别：</label><div class="col-sm-10"><select ng-model="shop" class="form-control" ng-options="m.name for m in tops" ng-change="getShop()"><option value="">选择商家类别</option></select></div><label class="col-sm-2 control-label" ng-if="shopChilds.length"></label><div class="col-sm-10" ng-if="shopChilds.length"><select ng-model="shopChild" class="form-control" ng-options="m.name for m in shopChilds"><option value="">选择连锁类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="info.mobile" class="form-control" placeholder="请输入手机号码"></div></div><div class="form-group"><label class="col-sm-2 control-label">用户名：</label><div class="col-sm-10"><input type="text" ng-model="info.name" class="form-control" placeholder="请输入用户名"></div></div><div class="form-group"><label class="col-sm-2 control-label">地理位置：<span class="text-red">必填</span></label><div class="col-sm-10"><select name="province" ng-model="info.province" class="form-control" ng-options="m.name for m in provinces" ng-change="getLines();" required=""><option value="">选择省份</option></select></div><label class="col-sm-2 control-label"></label><div class="col-sm-10"><select name="line" ng-model="info.line" class="form-control" ng-options="m.name for m in lines" required=""><option value="">选择配送线路</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：<span class="text-red">必填</span></label><div class="col-sm-10"><input name="address" type="text" ng-model="info.address" class="form-control" placeholder="请填写具体方位，路号，大厦，楼号等信息" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">店铺名称：<span class="text-red">必填</span></label><div class="col-sm-10"><input name="shop_name" type="text" ng-model="info.shop_name" class="form-control" placeholder="请输入店铺名称" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">备注：</label><div class="col-sm-10"><input type="text" ng-model="info.remark" class="form-control" placeholder="请输入备注"></div></div><div class="form-group"><div class="col-sm-10"><button class="btn btn-block btn-info" type="submit">记录</button></div></div></form></div></div>'),e.put("app/modules/custorm/potlist.html",'<div class="warp-page container-fluid"><div class="row block text-center pt-10 pb-10"><h4>总计： {{totalItems}} 家客户</h4></div><div infinite-scroll="pagination.nextPage()" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0"><div class="row block" ng-repeat="item in list"><div class="col-xs-12 block-col"><h5>店铺名称：{{item.shop_name}}</h5></div><div class="col-xs-12 block-col"><h5>地址：{{item.address}}</h5></div><div class="col-xs-12 block-col"><h5>备注：{{item.remark}}</h5></div><div class="col-xs-12 block-col" ng-if="item.mobile"><a href="tel:{{item.mobile}}" class="btn btn-warning">拨打电话:{{item.mobile}}</a></div><div class="col-xs-12 block-col"><a class="btn btn-info btn-sm" ng-click="openUser({{item.id}})">开通</a> <a class="btn btn-success btn-sm" ng-click="editUser({{item.id}})">编辑</a> <a class="btn btn-danger btn-sm" ng-click="deleteUser({{item.id}})">删除</a></div></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="row block pt-10 pb-10" ng-if="pagination.isDone"><h4 class="text-center">{{pagination.more}}</h4></div></div></div>'),e.put("app/modules/home/dblist.html",'<div class="mt-nav warp-page"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabs"><a ng-click="setStatus(\'{{tab.status}}\');">{{tab.name}}</a></li></ul></div></div><div class="list-group mt-nav" ng-show="showLists"><a class="list-group-item" ng-repeat="people in mygroup" ng-click="viewStatistics({{people.uid}})"><h5>{{people.name}}</h5></a></div><div class="" ng-show="showType == 0 && isLoading ==false"><accordion close-others="false"><accordion-group ng-repeat="table in statistics" is-open="openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.list[$index],\'glyphicon-chevron-right\': !openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><tr ng-repeat="item in table.data"><td>{{item.key}}</td><td>{{item.val}}</td></tr></table></accordion-group></accordion></div><div class="mt-nav" ng-show="showTotal"><table class="table table-white table-striped" ng-show="false"><tr><th>统计项</th><th class="text-right">实时数据</th></tr><tr ng-repeat="item in today"><td>{{item.name}}</td><td class="text-right">{{item.data}}</td></tr><tr ng-repeat="item in all"><td class="">{{item.name}}</td><td class="text-right">{{item.data}}</td></tr></table></div><div ng-show="isLoading" class="mt-10"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div>'),e.put("app/modules/home/home.html",'<div class="warp-page"><div class="head-bottom" ng-if="showTabs"><div class="flex-nav"><ul class="flex-center-50"><li ng-class="{active : showType == tab.status}" ng-repeat="tab in tabLists"><a ng-click="func.changeStatus({{tab.status}});">{{tab.name}}</a></li></ul></div></div><div class="mt-nav" ng-if="isloading"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div><div class="mt-nav" ng-if="showType===0 && isloading===false"><accordion close-others="false"><accordion-group ng-repeat="table in statistics" is-open="openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.list[$index],\'glyphicon-chevron-right\': !openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><tr ng-repeat="item in table.data" ng-click="func.showDetail($index, table.heading, item.val)"><td>{{item.key}}</td><td ng-class="{\'td-relative\' : $index >=2 && item.val!==0}">{{item.val}}<span ng-if="$index >=2 && item.val !==0" class="glyphicon glyphicon-chevron-right td-abs"></span></td></tr></table></accordion-group><accordion-group is-open="openstatus.query"><accordion-heading>自选时间段<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': openstatus.query,\'glyphicon-chevron-right\': !openstatus.query}"></i></accordion-heading><form class="form" novalidate="" name="query_form" ng-submit="func.query()"><div class="form-group"><label class="control-label">起始时间</label> <input name="btime" class="form-control" type="text" datepicker-popup="{{date_format}}" ng-model="date.begin_time" is-open="dpicker.begin.status" min-date="{{format.min}}" max-date="{{format.max}}" current-text="今日" clear-text="清除" close-text="关闭" ng-click="func.openDatepicker($event,1)" placeholder="点击选择日期" required=""></div><div class="form-group"><label class="control-label">结束时间</label> <input name="etime" class="form-control" type="text" datepicker-popup="{{date_format}}" ng-model="date.end_time" is-open="dpicker.end.status" min-date="{{format.min}}" max-date="{{format.max}}" current-text="今日" clear-text="清除" close-text="确定" ng-click="func.openDatepicker($event,2)" placeholder="点击选择日期" required=""></div><div class="form-group" ng-if="isquering===false"><button class="btn btn-primary btn-block" type="submit">查询</button></div><div ng-if="isquering===true"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></form><table class="table my-table" ng-show="show_metabolic"><tr ng-repeat="item in metabolic"><td>{{item.key}}</td><td>{{item.val}}</td></tr></table></accordion-group><accordion-group ng-repeat="table in capacity" is-open="capacity_openstatus.list[$index]"><accordion-heading>{{table.heading}}<i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': capacity_openstatus.list[$index],\'glyphicon-chevron-right\': !capacity_openstatus.list[$index]}"></i></accordion-heading><table class="table my-table"><thead><tr><th>类别</th><th>当前</th><th>上限</th></tr></thead><tbody><tr ng-repeat="item in table.data"><td>{{item.key}}</td><td>{{item.val.current}}</td><td>{{item.val.upper}}</td></tr></tbody><tr></tr></table></accordion-group></accordion></div><div class="mt-nav" ng-if="showType!==0"><div class="alert alert-warning" role="alert">正在开发中……</div></div></div>'),e.put("app/modules/more/more.html",'<div class="mt-nav more-body"><div class="list-group"><a class="list-group-item" ui-sref="page.userCenter" ng-click="func.userCenter()">个人中心<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.manual()">用户手册<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.map()">离线地图<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a> <a class="list-group-item" ng-click="func.refresh()">检查更新<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a></div></div>'),e.put("app/modules/user/center.html",'<div class="warp-page container-fluid"><div class="row block"><div class="col-xs-12"><h4>账户信息</h4></div><div class="col-xs-12 block-col"><a ng-href="/user/password" class="text-primary"><h5>修改密码</h5></a></div><div class="col-xs-12 block-col"><h5>姓名：{{uinfo.name}}</h5></div><div class="col-xs-12 block-col"><h5>地址：{{uinfo.address}}</h5></div><div class="col-xs-12 block-col"><h5>电话：{{uinfo.mobile}}</h5></div></div><div class="row block-btn pb-10"><div class="col-xs-12"><a ng-click="logout()" class="btn btn-danger btn-lg btn-block">退出登录</a></div></div></div>'),e.put("app/modules/user/edit.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form class="row block block-col form-horizontal" role="form" ng-submit="save()" ng-controller="UserEditCtrl"><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h5><b>姓名</b></h5></label><div class="col-sm-10"><input type="text" required="" class="input-lg form-control" ng-model="reg.name" name="mobile" id="name" placeholder="请输入您的姓名"></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="address" class="col-sm-2 control-label"><h5><b>地理位置</b></h5></label><div class="col-sm-10"><select ng-model="addr.province" class="input-lg form-control" ng-options="m.name for m in provinces" ng-change="get_child(\'citys\', \'province\');get_market(\'province\')" required=""><option value="">选择省份</option></select><select ng-model="addr.city" ng-options="c.name for c in citys" ng-change="get_child(\'countys\', \'city\');get_market(\'city\')" class="block-space input-lg form-control" required=""><option value="">--选择城市--</option></select><select ng-model="addr.county" ng-options="x.name for x in countys" class="block-space input-lg form-control"><option value="">--选择县--</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="market" class="col-sm-2 control-label"><h5><b>市场位置</b></h5></label><div class="col-sm-10"><select required="" ng-model="addr.market" class="form-control input-lg" ng-options="m.name for m in markets"><option value="">选择市场信息</option></select></div></div><div class="form-group col-xs-12" ng-if="normalUser"><label for="detail_address" class="col-sm-2 control-label"><h5><b>详细地址(档口,饭馆名)</b></h5></label><div class="col-sm-10"><input required="" type="text" class="input-lg form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请输入详细地址"></div></div><div class="form-group col-xs-12"><div class="col-xs-6"><button type="submit" class="btn col-xs-12 btn-success btn-lg">保存</button></div><div class="col-xs-6"><a ng-click="discard()" class="btn btn-danger btn-lg btn-block">取消</a></div></div></form></div>'),e.put("app/modules/user/login.html",'<div class="login_bg container-fluid"><div class="logo"><h3>CRM</h3></div><form class="login-form row block block-col form" name="loginForm" novalidate="" role="form" ng-submit="login()"><div class="form-group col-xs-12"><input type="tel" required="" class="input-md form-control" ng-model="user.mobile" ng-pattern="/^1\\d{10}$/" ng-minlength="11" ng-maxlength="11" name="mobile" id="tel" placeholder="请输入手机号" ng-focus="isL = false"></div><div class="form-group col-xs-12"><input type="password" required="" class="input-md form-control" ng-minlength="6" ng-model="user.password" name="password" id="password" placeholder="请输入密码" ng-focus="isL = false"></div><div class="form-group alert_box pull-left" ng-show="isL && loginForm.$valid && error.message"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li role="alert">{{error.message}}</li></ul></div></div></div><div class="form-group alert_box mg pull-left" ng-show="loginForm.$invalid && loginForm.$dirty && show_error"><div class="col-sm-10"><div class="alert alert-danger min_alert" style="margin-bottom: 0px"><ul><li ng-show="loginForm.mobile.$error.minlength">请输入正确的手机号</li><li ng-show="!loginForm.mobile.$error.minlength && loginForm.mobile.$error.pattern">手机号格式不正确</li><li ng-show="loginForm.mobile.$error.required">手机号必填</li><li ng-show="loginForm.password.$error.minlength">密码至少6位</li><li ng-show="loginForm.password.$error.required">密码必填</li></ul></div></div></div><div class="form-group col-xs-12"><button type="submit" class="btn btn-success btn-md btn-block">登录</button></div></form></div>'),e.put("app/modules/user/password.html",'<div class="warp-page container-fluid"><div class="row block"><form class="form-horizontal" role="form" ng-submit="changePassword()" name="passwordForm"><div class="form-group col-xs-12 pt-10"><label for="password" class="col-sm-2 control-label"><h5><b>旧密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.password" id="password" placeholder="请输入您的旧密码" ng-minlength="6" name="oldpassword"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.oldpassword.$invalid"><small ng-show="passwordForm.oldpassword.$error.minlength">旧密码至少6位</small> <small ng-show="passwordForm.oldpassword.$error.required">旧密码必填</small></div></div></div><div class="form-group col-xs-12"><label for="newpassword" class="col-sm-2 control-label"><h5><b>新密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.newPassword" id="newPassword" placeholder="请输入您的新密码" ng-minlength="6" name="password"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.password.$invalid"><small ng-show="passwordForm.password.$error.minlength">密码至少6位</small> <small ng-show="passwordForm.password.$error.required">密码必填</small></div></div></div><div class="form-group col-xs-12"><label for="newpassword" class="col-sm-2 control-label"><h5><b>重复输入新密码</b></h5></label><div class="col-sm-10"><input type="password" required="" class="input-lg form-control" ng-model="reg.newRePassword" id="newRePassword" ng-blur="passwordCheck()" ng-minlength="6" placeholder="请再次输入您的新密码" name="repassword"><div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$invalid"><small ng-show="passwordForm.repassword.$error.minlength">确认密码至少6位</small> <small ng-show="passwordForm.repassword.$error.required">确认密码必填</small></div></div></div><div class="form-group col-xs-12"><div class="row block-btn col-sm-10"><div class="col-xs-12"><button ng-disabled="checked" type="submit" class="btn btn-block btn-success btn-lg">修改密码</button></div></div></div></form></div></div>'),e.put("app/modules/user/register.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h4>{{items.bodyText}}</h4> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-alert" ng-click="items.close();cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid"><form name="regForm" class="row block block-col form-horizontal" role="form" novalidate="" ng-submit="register()" ng-controller="UserRegisterCtrl"><div class="form-group col-xs-12"><label for="market" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您的身份</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.userType" name="userType" class="form-control input-md" ng-options="m.name for m in types"><option value="">选择身份</option></select><div class="col-xs-12 block-col label label-danger" ng-show="regForm.submitted && regForm.userType.$invalid"><small ng-show="regForm.userType.$error.required">请选择一个注册身份</small></div></div></div><div class="form-group col-xs-12"><label for="tel" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 手机</b></h6></label><div class="col-sm-10"><input type="text" phone-unique="mobile" required="" class="input-md form-control" ng-pattern="/^1[3|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-model="reg.mobile" name="mobile" id="tel" placeholder="请输入您的手机号"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.mobile.$dirty) && regForm.mobile.$invalid"><small ng-show="regForm.mobile.$error.minlength">请输入正确的手机号</small> <small ng-show="!regForm.mobile.$error.minlength && regForm.mobile.$error.pattern">您输入的手机号格式不正确</small> <small ng-show="regForm.mobile.$error.required">请输入您的手机号</small> <small ng-if="regForm.mobile.$error.unique">手机号已被注册</small></div></div></div><div class="form-group col-xs-12"><label for="name" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 姓名</b></h6></label><div class="col-sm-10"><input type="text" required="" class="input-md form-control" ng-model="reg.name" name="name" id="name" placeholder="请输入您的真实姓名"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.name.$dirty) && regForm.name.$invalid"><small ng-show="regForm.name.$error.required">请输入您的姓名</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 您所在的批发市场</b></h6></label><div class="col-sm-10"><select required="" ng-model="addr.city" name="city" ng-options="c.name for c in cities" ng-change="getMarket()" class="block-space form-control input-md"><option value="">选择城市</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.city.$dirty) && regForm.city.$invalid"><small ng-show="regForm.city.$error.required">请选择您所在的城市</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><div class="col-sm-10 col-sm-offset-2"><select required="" ng-model="addr.market" class="form-control input-md" name="market" ng-options="m.name for m in markets"><option value="">选择批发市场</option></select><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.market.$dirty) && regForm.market.$invalid"><small ng-show="regForm.market.$error.required">请选择您所在的批发市场</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 档口位置</b></h6></label><div class="col-sm-10"><input required="" type="text" class="input-md form-control" ng-model="reg.detailAddress" name="detail_address" id="detail_address" placeholder="请描述您在市场里的具体位置"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.detail_address.$dirty) && regForm.detail_address.$invalid"><small ng-show="regForm.detail_address.$error.required">请输入您在市场里的具体位置</small></div></div></div><div class="form-group col-xs-12" ng-if="addr.userType.type == 30"><label for="detail_address" class="col-sm-2 control-label"><h6><b>您的招牌(如 XX果业 )(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.brand" name="brand" id="brand" placeholder="填写您的招牌，树立品牌意识"></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.password" id="password" name="password" placeholder="请输入您的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.password.$dirty) && regForm.password.$invalid"><small ng-show="regForm.password.$error.required">请输入您的密码</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 确认密码</b></h6></label><div class="col-sm-10"><input type="password" required="" class="input-md form-control" ng-model="reg.checkPassword" id="checkPassword" name="repassword" placeholder="请再次输入你的密码"><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$invalid"><small ng-show="regForm.repassword.$error.required">请再次输入您的密码</small></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.repassword.$dirty) && regForm.repassword.$valid && reg.checkPassword != reg.password"><small>两次密码输入不一致</small></div></div></div><div class="form-group col-xs-12"><label for="password" class="col-sm-2 control-label"><h6><b>请输入推荐人的邀请码(选填)</b></h6></label><div class="col-sm-10"><input type="text" class="input-md form-control" ng-model="reg.invite_code" id="checkPassword" name="invite_code" placeholder="请输入大厨网地推人员邀请码"></div></div><div class="form-group col-xs-12"><label for="code" class="col-sm-2 control-label"><h6><b><em class="text-danger">*</em> 验证码</b></h6></label><div class="col-sm-10"><div class="input-group"><input class="input-md form-control" ng-pattern="/^\\d+$/" required="" ng-model="reg.vcode" id="code" type="number" name="code" placeholder="输入短信验证码"><div ng-model="smsinfo" class="input-group-addon btn {{smsdis||smsable}}" ng-disabled="regForm.mobile.$invalid" ng-click="sms()">{{smsinfo || \'获取验证码\'}}</div></div><div class="col-xs-12 block-col label label-danger" ng-show="(regForm.submitted || regForm.code.$dirty) && regForm.code.$invalid"><small ng-show="regForm.code.$error.required">请输入短信验证码</small></div></div></div><div class="checkbox col-xs-12"><div class="row"><div class="col-xs-12"><label class="control-label" ng-init="agree=true"><h6><input type="checkbox" name="agree" id="agree" ng-model="agree"> <a href="/user/agreement">我已阅读并同意用户协议</a></h6></label></div></div></div><div class="col-xs-12 block-btn"><button type="submit" class="btn btn-block btn-success btn-lg" ng-disabled="!agree">注册</button></div></form></div>'),e.put("app/modules/visit/add.customer.html",'<div class="warp-page"><div class="margin-top-10"><div class="input-group"><input type="text" ng-model="vm.searchKey" class="form-control" placeholder="请输入店铺名"> <span class="input-group-addon" ng-click="search()" id="basic-addon2">搜索店铺</span></div></div><accordion close-others="false"><accordion-group is-disabled="true" is-open="true"><accordion-heading>店铺列表：</accordion-heading><div class="cdelist" infinite-scroll="pagination.nextPage();" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="1"><ul class="list-group"><li ng-repeat="item in vm.searchList" ng-click="selectItem(item)">{{item.shop_name}}</li></ul></div><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></accordion-group></accordion></div>'),e.put("app/modules/visit/add.html",'<div class="warp-page container-fluid"><div class="head-bottom"><div class="flex-nav"><ul class="flex-center-50 cdelist"><li ng-repeat="item in tabList" ng-class="{\'active\':item.active}"><a ng-click="tabSwitch(item)">{{item.name}}</a></li></ul></div></div><div ng-if="showItem==0" class="cdetail_load add_plan container-fluid"><div class="row"><div class="col-md-4"><span>拜访日期：</span></div><div class="col-sm-12 mt-10"><p class="input-group"><input type="text" class="form-control" datepicker-popup="" ng-model="vm.selectDate" is-open="status.datePickOpen" min-date="\'1970-06-22\'" max-date="\'2020-06-22\'" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" placeholder="请选择拜访日期"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="openDate($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div></div><div class="row"><div class="col-md-4"><span>私海客户：</span></div><div class="col-sm-12 mt-10"><div class="btn-group btn-group-justified"><a class="btn btn-success" ng-click="statePath()">{{vm.shopName}}<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a></div></div></div><div class="row"><div class="col-md-8"><div class="text-center btn-block-colomn"><a class="btn btn-danger">取消</a> <a class="btn btn-success" ng-click="create()">确定</a></div></div></div></div><div ng-if="showItem==1" class="cdetail_load add_plan container-fluid"><div class="row"><div class="col-md-4"><span>拜访日期：</span></div><div><div class="col-sm-12 mt-10"><input class="form-control ng-pristine ng-valid ng-valid-required ng-touched" type="text" ng-model="vm.selectDate" name="address" ng-disabled="true"></div></div></div><div class="row"><div class="col-md-4"><span>私海客户：</span></div><div class="col-sm-12 mt-10"><div class="btn-group btn-group-justified"><a class="btn btn-success" ng-click="statePath()">{{vm.shopName}}<div class="pull-right"><span class="glyphicon glyphicon-menu-right"></span></div></a></div></div></div><div class="row"><div class="col-md-8"><div class="btn-block-colomn"><a class="btn btn-danger">取消</a> <a class="btn btn-success" ng-click="create()">确定</a></div></div></div></div></div>'),e.put("app/modules/visit/bd.history.html",'<div class="warp-page container-fluid"><div class="head-bottom ng-scope"><div class="flex-nav"><ul class="flex-center-50"><li ng-repeat="item in tabList" ng-class="{\'active\':item.active}"><a ng-click="tabSwitch(item)">{{item.name}}</a></li></ul></div></div><div ng-if="showItem==1" infinite-scroll="pagination.nextPage();" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0" class="row margin-top-50"><ul class="list-group ul-bd-index" ng-repeat="item in list"><li>店铺名称：<span>{{item.shop_name}}</span></li><li>拜访日期：<span>{{item.visit_date}}</span></li></ul><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div><div ng-if="showItem==2" class="row margin-top-60"><md-date td-call-back="cellClick()" list-tags="calendarLists" is-normal="0"></md-date></div></div>'),e.put("app/modules/visit/bd.index.html",'<div class="warp-page container-fluid"><div class="head-bottom ng-scope"><div class="flex-nav"><ul class="flex-center-50"><li ng-repeat="item in tabList" ng-class="{\'active\':item.active}"><a ng-click="tabSwitch(item)">{{item.name}}</a></li></ul></div></div><div ng-if="showItem==1" infinite-scroll="pagination.nextPage();" infinite-scroll-disabled="pagination.isDone || pagination.isProcessing" infinite-scroll-distance="0" class="row margin-top-50"><ul class="list-group ul-bd-index" ng-repeat="item in list"><li>店铺名称：<span>{{item.shop_name}}</span></li><li>拜访日期：<span>{{item.visit_date}}</span></li><li><div ng-show="item.status==1" class="btn-group btn-group-justified"><a class="btn btn-success" ng-href="/visit/customer/{{item.id}}/{{item.user_id}}/{{item.is_potential}}">进店拜访</a> <a class="btn btn-warning" ng-href="/visit/modify/{{item.id}}/{{item.visit_date}}">修改日期</a> <a class="btn btn-info" ng-click="delete(item.id)">删除</a></div><div ng-show="item.status!=1" class="btn-group btn-group-justified"><a class="btn btn-success" ng-href="/visit/customerInfo/{{item.id}}">查看拜访记录</a></div></li></ul><div ng-show="pagination.isProcessing"><div class="loading_spinner"><div class="loading_bounce1"></div><div class="loading_bounce2"></div><div class="loading_bounce3"></div></div></div></div><div ng-if="showItem==2" class="row margin-top-60"><md-date td-call-back="cellClick()" list-tags="calendarLists" is-normal="0"></md-date></div></div>'),e.put("app/modules/visit/bdm.index.html",'<div class="warp-page container-fluid"><div class="head-bottom ng-scope"><div class="flex-nav"><ul class="flex-center-33"><li ng-repeat="item in tabList" ng-class="{\'active\':item.active}"><a ng-click="tabSwitch(item)">{{item.name}}</a></li></ul></div></div><div class="cdetail_load margin-top-10"><ul class="list-group"><li ng-click="statePath(item)" class="list-group-item" ng-repeat="item in list"><span class="badge" style="background:#009688;">{{item.count}}</span> {{item.bd_name}}</li></ul></div></div>'),e.put("app/modules/visit/customer.html",'<div class="warp-page customerVisitClass container-fluid"><div class="bd-customer-ul-list"><div><ul id="customer-column"><li>店铺名称：{{info.shop_name}}</li><li>拜访日期：{{info.visit_date}}</li></ul></div><div id="customerType"><div>客户关系品类：</div><ul class="clearfix"><li ng-repeat="item in focusCategories"><label><input type="checkbox" ng-model="item.checked" ng-click="checkClick(item,1)"> <span>{{item.name}}</span></label></li></ul></div><div id="questionType"><div>意见类型：</div><ul class="clearfix"><li ng-repeat="item in suggestions"><label><input type="checkbox" ng-model="item.checked" ng-click="checkClick(item,2)"> <span>{{item.name}}</span></label></li></ul></div><div class="row" id="remarkText"><span>备注：</span> <input type="text" ng-model="remark" value=""></div><div class="row" id="btnCustomerList"><div class="col-md-8"><div class="btn-block-colomn"><a class="btn btn-danger" ng-click="reset()">重置</a> <a class="btn btn-success" ng-if="stateVid != 0" ng-click="update()">确定</a> <a class="btn btn-success" ng-if="stateVid == 0" ng-click="create()">确定</a></div></div></div></div></div>'),e.put("app/modules/visit/customer.info.html",'<div class="warp-page customerVisitClass container-fluid"><div class="bd-customer-ul-list"><div><ul id="customer-column"><li>店铺名称：{{info.shop_name}}</li><li>拜访日期：{{info.visit_date}}</li></ul></div><div id="customerType"><div>客户关系品类：</div><ul class="clearfix"><li ng-repeat="item in focusCategories"><label><input type="checkbox" ng-checked="true" ng-disabled="true"> <span>{{item.name}}</span></label></li></ul></div><div id="questionType"><div>意见类型：</div><ul class="clearfix"><li ng-repeat="item in suggestions"><label><input type="checkbox" ng-checked="true" ng-disabled="true"> <span>{{item.name}}</span></label></li></ul></div><div class="row" id="remarkText"><span>备注：</span> <input type="text" ng-model="info.remarks" value=""></div></div></div>'),e.put("app/modules/visit/modify.html",'<div class="warp-page container-fluid"><div class="head-bottom ng-scope"><div class="flex-nav"><ul class="flex-center-100"><li>修改前日期：<span class="span-color-red">{{updateBeforeDate}}</span></li></ul></div></div><div class="row margin-top-40"><md-date td-call-back="cellClick()" is-normal="1"></md-date></div></div>')
}]);