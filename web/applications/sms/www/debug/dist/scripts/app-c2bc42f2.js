"use strict";angular.module("hop",["angularFileUpload","ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","dachu.widget"]),angular.module("hop").controller("LoginCtrl",["$scope","req","$location","$cookieStore",function(t,e,s,a){t.user={mobile:"",password:""},t.message={text:"",status:""},t.login=function(){if(t.loginForm.$invalid)return t.loginForm.submitted=!0,!1;var s=function(s){return 0!==parseInt(s.status)?(t.error={cls:"alert alert-danger",msg:s.msg},!1):(a.put("type",s.info.type),a.put("id",s.info.id),localStorage.setItem("access",s.access),e.redirect(e.refer),void 0)};e.getdata("user/login","POST",s,t.user)}}]),angular.module("hop").controller("UserListCtrl",["$location","dialog","req","$scope",function(t,e,s,a){a.dateOptions={formatYear:"yy",startingDay:1},a.endDateOptions={formatYear:"yy",startingDay:1},a.endOpened=a.opened=!1,a.open=function(t){t.preventDefault(),t.stopPropagation(),a.opened=!0},a.endOpen=function(t){t.preventDefault(),t.stopPropagation(),a.endOpened=!0};var o=function(){s.getdata("user/role_list","POST",function(t){0==t.status&&(a.role_list=t.role_list)})},l=function(){var t=a.role?a.role.id:0,e={roleId:t,searchValue:a.searchValue,startTime:Date.parse(a.startTime),endTime:Date.parse(a.endTime),currentPage:a.paginationConf.currentPage,itemsPerPage:a.paginationConf.itemsPerPage};s.getdata("user/lists","POST",function(t){0==t.status&&(a.paginationConf.totalItems=t.total,a.list=t.list)},e)};a.paginationConf={currentPage:1,itemsPerPage:50},a.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),a.search=function(){l()},a.reset=function(){a.searchValue="",a.startTime="",a.endTime="",l()},a.setStatus=function(t,o){var l="禁用";1==o&&(l="启用"),e.tips({actionText:"确定",bodyText:"确定"+l+"["+a.list[t].name+"]账号吗?",ok:function(){s.getdata("user/toggle_status","POST",function(s){0==s.status?(e.tips({bodyText:"操作成功！"}),a.list[t].status=o):e.tips({bodyText:"操作失败！"})},{uid:a.list[t].id,status:o})}})},a.resetPassword=function(t){e.tips({actionText:"确定",bodyText:"确定重置用户["+a.list[t].name+"]的密码吗?",ok:function(){s.getdata("user/reset_password","POST",function(t){e.tips(0==t.status?{bodyText:"密码重置成功！"}:{bodyText:"密码重置失败！"})},{uid:a.list[t].id})}})},a.delete=function(t){e.tips({actionText:"确定",bodyText:"确定删除用户["+a.list[t].name+"]吗?",ok:function(){s.getdata("user/delete","POST",function(t){0==t.status?(e.tips({bodyText:"删除成功！"}),l()):e.tips({bodyText:"删除失败！"+t.msg})},{id:a.list[t].id})}})};var n=function(){var e=t.$$host,s="http://api.dachuwang.com/";0!==e.indexOf("hop.dachuwang.com")&&(s="http://api.dachuwang.net/");var o=s+"hop/user/export_data?1=1";a.role&&(o+="&userType="+a.role.id),a.status&&(o+="&status="+a.status),a.key&&(o+="&key="+a.key),a.startTime&&(o+="&startTime="+Date.parse(a.startTime)),a.endTime&&(o+="&endTime="+Date.parse(a.endTime)),window.open(o)};a.exportData=function(){e.tips({headerText:"导出数据",actionText:"确定",bodyText:"确定导出数据吗?",ok:function(){n()}})},o()}]),angular.module("hop").controller("UserEditCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,s,a,o){var l=function(){a.id=o.id;var t={id:a.id};s.getdata("user/edit_input","POST",function(t){0==t.status&&(a.data=t.info,a.dept_list=t.dept_list,a.role_list=t.role_list,a.province_list=t.province_list,angular.forEach(a.dept_list,function(e){e.id==t.info.dept_id&&(a.data.dept=e)}),angular.forEach(a.role_list,function(e){e.id==t.info.role_id&&(a.data.role=e)}),angular.forEach(a.province_list,function(e){e.id==t.info.province_id&&(a.data.province=e)}))},t)};a.edit=function(){if(a.show_error=!0,a.basic_form.$setDirty(),!a.basic_form.$invalid){var t={id:a.data.id,deptId:a.data.dept.id,roleId:a.data.role.id,name:a.data.name,mobile:a.data.mobile,provinceId:a.data.province.id,address:a.data.address};s.getdata("/user/edit","POST",function(t){0==t.status?(e.tips({bodyText:"修改用户成功！"}),s.redirect("/user/list")):e.tips({bodyText:"修改用户失败。"})},t)}},l()}]),angular.module("hop").controller("UserCreateCtrl",["$location","dialog","req","$scope","$stateParams",function(t,e,s,a){var o=function(){s.getdata("/user/create_input","POST",function(t){0==t.status&&(a.dept_list=t.dept_list,a.role_list=t.role_list,a.province_list=t.province_list)})};a.create=function(){if(a.show_error=!0,a.basic_form.$setDirty(),!a.basic_form.$invalid){var t={deptId:a.data.dept.id,roleId:a.data.role.id,name:a.data.name,mobile:a.data.mobile,provinceId:a.data.province.id,address:a.data.address};s.getdata("/user/create","POST",function(t){0==t.status?(e.tips({bodyText:"添加用户成功！"}),s.redirect("/user/list")):e.tips({bodyText:"添加用户失败。"})},t)}},o()}]),angular.module("hop").controller("SubjectAddCtrl",["$rootScope","$scope","req","$upload","daChuLocal","dialog",function(t,e,s,a,o,l){e.title="新建专题",e.dateOptions={formatYear:"yy",startingDay:1},e.endDateOptions={formatYear:"yy",startingDay:1},e.endOpened=e.opened=!1,e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0},e.endOpen=function(t){t.preventDefault(),t.stopPropagation(),e.endOpened=!0},e.initValues={name:"添加",value:"",id:"",icon:"glyphicon-plus",cls:"btn-info",clk:"addProduct"},e.products=[e.initValues],e.addProduct=function(t,s){void 0==s&&(s="");var a={name:"删除",value:s,id:"",icon:"glyphicon-minus",cls:"btn-danger",clk:"remove"};e.products.push(a)},e.remove=function(t){var s=e.products.indexOf(t);e.products.splice(s,1)},e.showProduct=function(t){var a=(e.products.indexOf(t),{locationId:e.location.id,searchVal:t.value});s.getdata("product/manage","POST",function(e){t.products=e.list},a)},e.selectProduct=function(t,s){var a=e.products.indexOf(s);e.products[a].id=t.id,e.products[a].value=t.title+"|"+t.sku_number+"|"+t.price+"/"+t.unit,s.products=""};var n=function(){s.getdata("subject/input_options","GET",function(t){0===parseInt(t.status)&&(e.locationInfo=t.list.locations,e.siteSrcs=t.list.sites,e.site=e.siteSrcs[0],e.location=e.locationInfo[0],e.subjectTypes=t.list.subject_type,e.subjectType=e.subjectTypes[0])})};e.link_url="",n(),e.$watch("detailImg",function(){void 0!=e.files&&e.upload("detailUploads","detailImg")}),e.$watch("files",function(){void 0!=e.files&&e.upload("imgUploads","files")}),e.upload=function(t,s){var l=[];angular.forEach(e[s],function(s){a.upload({url:"http://img.dachuwang.com/upload?bucket=sku",file:s,fileFormDataName:"files[]"}).progress(function(t){var e=parseInt(100*t.loaded/t.total);s.progressPercentage=e}).success(function(a){s.dataUrl=a.files[0].url,l.push(s),e[t]=l,o.set(t,e[t])})})},e.add=function(a){if(a.$invalid||!e.imgUploads)return void l.tips({bodyText:"请填写完整信息！"});var o={pic_url:"",banner_url:"",detail_img:"",site_id:1,location_id:1,products:[],startTime:"",endTime:"",subjectType:"",title:""};o.pic_url=e.imgUploads[0].dataUrl,e.detailUploads&&(o.detail_img=e.detailUploads[0].dataUrl),o.site_id=e.site.id,o.location_id=e.location.id,o.title=e.name,o.startTime=Date.parse(e.startTime)/1e3,o.endTime=Date.parse(e.endTime)/1e3,o.subjectType=e.subjectType.id,angular.forEach(e.products,function(t){parseInt(t.id)>0&&o.products.push(t.id)}),2==o.subjectType&&(o.banner_url=o.pic_url,o.pic_url=""),t.is_loading=!0,s.getdata("subject/save","POST",function(e){t.is_loading=!1,alert(e.msg),s.redirect("/subject")},o)},e.picCancel=function(t,s){var a="detailUploads";0===parseInt(s)&&(a="imgUploads");var l=e[a].indexOf(t);e[a].splice(l,1),e[a]&&o.set(a,e[a])}}]),angular.module("hop").controller("SubjectCtrl",["$rootScope","$scope","req",function(t,e,s){e.title="专题列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.status="all";var a=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,status:e.status};t.is_loading=!0,s.getdata("subject/lists","POST",function(s){t.is_loading=!1,e.advs=s.list,e.paginationConf.totalItems=s.total},a)};a(),e.search=function(){a()},e.reset=function(){e.key="",a()},e.filterByStatus=function(t){e.status=t,a()},e.setStatus=function(t,a){s.getdata("subject/set_status","POST",function(s){var o=e.advs.indexOf(t);e.advs[o].status=a,alert(s.msg)},{id:t.id,status:a})}}]),angular.module("hop").controller("storageCtrl",["$rootScope","$filter","$scope","req","dialog","appConfigure","$cookieStore",function(t,e,s,a,o,l,n){s.edit_storage=function(t){t.editing=!0},s.cancel_storage=function(){i()},s.save_storage=function(e){t.is_loading=!0,a.getdata("/stock/update","POST",function(e){t.is_loading=!1,0==e.status&&(s.dialog({bodyText:e.msg}),i())},e)},s.locations=[{name:"sku货号",type:"sku_number"},{name:"仓库id",type:"warehouse_id"}],s.site_url=l.url,s.status="all";var i=function(){var t=n.get("productCookie")||"";s.key=t;var e=0;"undefined"!=typeof s.locate&&(e=parseInt(s.locate.id));var o={currentPage:s.paginationConf.currentPage,itemsPerPage:s.paginationConf.itemsPerPage,searchVal:s.key,searchType:s.location.type,status:s.status};a.getdata("stock/lists","POST",function(t){s.products=t.list,s.paginationConf.totalItems=t.total_count},o)};s.title="库存管理",s.paginationConf={currentPage:1,itemsPerPage:50},s.search=function(){n.put("productCookie",s.key),i()},s.reset=function(){n.remove("productCookie"),s.key="",i()},s.filterByStatus=function(t){s.status=t,i()},s.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),s.dialog=o.tips,s.setstatus=function(t,e,o){s.products[o].status=e,a.getdata("product/set_status","POST",function(){s.dialog(1===parseInt(e)?{bodyText:"商品已设置为有货，将在商城展示。"}:{bodyText:"商品已设置为无货，将不在商城展示。"})},{status:e,id:t})}}]),angular.module("hop").controller("RecommendAddCtrl",["$rootScope","$scope","req","$upload","daChuLocal","dialog",function(t,e,s,a,o,l){e.title="新建首页推荐",e.dateOptions={formatYear:"yy",startingDay:1},e.endDateOptions={formatYear:"yy",startingDay:1},e.endOpened=e.opened=!1,e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0},e.endOpen=function(t){t.preventDefault(),t.stopPropagation(),e.endOpened=!0},e.initValues={name:"添加",value:"",id:"",icon:"glyphicon-plus",cls:"btn-info",clk:"addProduct"},e.products=[e.initValues],e.addProduct=function(t,s){void 0==s&&(s="");var a={name:"删除",value:s,id:"",icon:"glyphicon-minus",cls:"btn-danger",clk:"remove"};e.products.length<5?e.products.push(a):alert("首页推荐必须为5个商品")},e.remove=function(t){var s=e.products.indexOf(t);e.products.splice(s,1)},e.showProduct=function(t){var a=(e.products.indexOf(t),{locationId:e.location.id,customerType:e.defaultType.value,searchVal:t.value});s.getdata("product/manage","POST",function(e){t.products=e.list},a)},e.selectProduct=function(t,s){var a=e.products.indexOf(s);e.products[a].id=t.id,e.products[a].value=t.title+"|"+t.sku_number+"|"+t.price+"/"+t.unit,s.products=""};var n=function(){s.getdata("recommend/input_options","GET",function(t){0===parseInt(t.status)&&(e.locationInfo=t.list.locations,e.customerTypeOptions=t.list.customer_type_options,e.defaultType=e.customerTypeOptions[0],e.siteSrcs=t.list.sites,e.site=e.siteSrcs[0],e.location=e.locationInfo[0])})};n(),e.add=function(a){if(a.$invalid)return void l.tips({bodyText:"请填写完整信息！"});var o={site_id:1,location_id:1,products:[],startTime:"",customerType:e.defaultType.value,endTime:"",title:""};return o.site_id=e.site.id,o.location_id=e.location.id,o.title=e.name,o.startTime=Date.parse(e.startTime)/1e3,o.endTime=Date.parse(e.endTime)/1e3,angular.forEach(e.products,function(t){parseInt(t.id)>0&&o.products.push(t.id)}),5!==o.products.length?(alert("商品必须为五个"),!1):(t.is_loading=!0,void s.getdata("recommend/save","POST",function(e){t.is_loading=!1,alert(e.msg),s.redirect("/recommend")},o))}}]),angular.module("hop").controller("RecommendCtrl",["$rootScope","$scope","req",function(t,e,s){e.title="首页推荐列表",e.paginationConf={currentPage:1,itemsPerPage:15},e.status="all";var a=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,status:e.status};t.is_loading=!0,s.getdata("recommend/lists","POST",function(s){t.is_loading=!1,e.advs=s.list,e.paginationConf.totalItems=s.total},a)};a(),e.search=function(){a()},e.reset=function(){e.key="",a()},e.filterByStatus=function(t){e.status=t,a()},e.setStatus=function(t,a){s.getdata("recommend/set_status","POST",function(s){var o=e.advs.indexOf(t);e.advs[o].status=a,alert(s.msg)},{id:t.id,status:a})}}]),angular.module("hop").controller("ProductSnapCtrl",["$rootScope","$scope","$stateParams","appConfigure","rpc",function(t,e,s,a,o){e.title="商品快照列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.site_url=a.url,e.status="all";var l=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,productId:s.productId};t.is_loading=!0,o.load("/product_snapshot/lists","POST",a).then(function(s){t.is_loading=!1,e.products=s.list,e.paginationConf.totalItems=s.total})};e.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l)}]),angular.module("hop").controller("ProductPriceCtrl",["$rootScope","$scope","dialog","appConfigure","$cookieStore","$filter","rpc",function(t,e,s,a,o,l,n){var i=o.get("type");100==i?e.showSync=!0:10==i&&(e.showSync=!1),e.paginationConf={currentPage:1,itemsPerPage:50};var c=function(){e.paginationConf.currentPage=1,e.paginationConf.itemsPerPage=50};e.locations=[{id:0,name:"全国"}],e.categories=[{id:0,name:"全部分类"}],function(){n.load("product/list_price_options").then(function(t){e.locations=e.locations.concat(t.cities),e.categories=e.categories.concat(t.categories),e.location=e.locations[0],e.category=e.categories[0]},function(t){alert(t)})}(),e.sync=function(){s.tips({bodyText:"是否确认同步所有价格更改到线上？",actionText:"确认",closeText:"取消",ok:function(){b()}})},e.title="商品改价待同步列表",e.isEdit=!1,e.editName="编辑",e.edit=function(){1==e.isEdit?(e.title="商品改价待同步列表",e.editName="编辑",e.isEdit=!1,c(),e.products=[],p()):(e.title="商品改价列表",e.editName="返回",e.isEdit=!0,c(),e.products=[],m())},e.save=function(t){var e="";if(0!=t.price){var s=u(t.dest_price);s.status||(e+="普通客户:"+s.errorMessage)}else s={status:!0};s.status?d(t):r(e)};var d=function(t){var e="",a=l("money")(t.dest_price,2);if(0!=t.price){if(t.dest_price<=t.price/2||t.dest_price>=2*t.price||t.dest_price==t.price)var o="price-danger";e+='<div class="alert alert-warning '+o+' ">'+t.title+"<br>普通客户价格 从 "+t.price+" 元 改为："+a+" 元; </div>"}s.tips({bodyText:e+"是否确认？",actionText:"确认",closeText:"取消",ok:function(){g(t,a)}})},r=function(t){s.tips({bodyText:t})},u=function(t){var e=!1,s="";return t&&0!=t||(s+="价格不能为空！请重新填写<br>"),isNaN(t)&&(s+="价格不能是非数字！请重新填写<br>"),""===s&&(e=!0),{status:e,errorMessage:s}},p=function(){var t={skuNumber:e.key?e.key:"",categoryId:e.category?e.category.id:"",locationId:e.location?e.location.id:"",currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage};n.load("/product/list_changed_prices","POST",t).then(function(t){e.products=t.list,e.paginationConf.totalItems=t.total},function(t){alert(t)})},m=function(){var t={skuNumber:e.key?e.key:"",categoryId:e.category?e.category.id:"",locationId:e.location?e.location.id:"",currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage};n.load("/product/list_prices","POST",t).then(function(t){e.products=t.list,e.paginationConf.totalItems=t.total},function(t){alert(t)})},g=function(t,e){var a={productId:t.product_id,destPrice:e};n.load("/product/update_price","POST",a).then(function(t){0==t.status&&(s.tips({bodyText:"价格更改成功！"}),m())},function(t){alert(t)})},b=function(){n.load("/product/sync_prices").then(function(t){0==t.status&&(s.tips({bodyText:"价格批量同步成功！"}),p())},function(t){alert(t)})};e.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",function(){1==e.isEdit?m():p()}),e.key="",e.search=function(){return isNaN(e.key)&&""!=e.key?void s.tips({bodyText:"货号不能是非数字！请重新填写"}):void(e.isEdit?m():p())},e.reset=function(){e.key="",e.location=e.locations[0],e.category=e.categories[0],e.isEdit?m():p()}}]),angular.module("hop").controller("ProductCtrl",["$rootScope","$scope","daChuLocal","req","dialog","appConfigure","$cookieStore",function(t,e,s,a,o,l,n){e.site_url=l.url,e.status="all";var i=function(){var o=n.get("productCookie")||"";e.key=o;var l=0;"undefined"!=typeof e.locate&&(l=parseInt(e.locate.id));var i={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,locationId:s.get("locate")?s.get("locate").id:l,status:e.status};t.is_loading=!0,a.getdata("/product/manage","POST",function(a){if(t.is_loading=!1,e.products=a.list,e.locations=a.location,e.customer_type_options=a.customer_type_options,s.get("locate")){var o=s.get("locate");angular.forEach(a.location,function(t){t.id==o.id&&(e.locate=t)})}else e.locate=a.location[0];e.paginationConf.totalItems=a.total},i)};e.title="商品列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.search=function(){s.set("locate",e.locate),n.put("productCookie",e.key),i()},e.reset=function(){n.remove("productCookie"),e.key="",i()},e.filterByStatus=function(t){e.status=t,i()},e.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",i),e.dialog=o.tips,e.setstatus=function(t,s,o){e.products[o].status=s,a.getdata("product/set_status","POST",function(){e.dialog(1===parseInt(s)?{bodyText:"商品已设置为有货，将在商城展示。"}:{bodyText:"商品已设置为无货，将不在商城展示。"})},{status:s,id:t})}}]),angular.module("hop").controller("ProductEditCtrl",["$rootScope","$scope","req","$stateParams","$location","$cookieStore","dialog","daChuLocal","daChuTimer",function(t,e,s,a,o,l,n){e.productsChild=[];var i=a.productId;e.title="添加货物",e.product={title:"",id:i,skuNumber:"",advWords:"",price:50,marketPrice:80,singlePrice:3,unitName:"",isRound:1,storage:"",buyLimit:0,lineId:[0],visiable:1,closeUnit:"",status:1},e.rounds=[{name:"是",val:1,checked:1},{name:"否",val:0,checked:0}],e.init={unit:"",closeUnit:"",skuNumber:"",isRound:!0,productStatus:""};var c=function(){s.getdata("product/edit","POST",function(t){0===parseInt(t.status)&&(e.product.skuNumber=t.info.sku_number,e.product.title=t.info.title,e.product.status=t.info.status,e.init.unitId=t.info.unit_id,e.init.isRound=parseInt(t.info.is_round)?!0:!1,e.init.closeUnitId=t.info.close_unit,e.product.advWords=t.info.adv_words,e.product.price=t.info.price,e.product.lineId=t.info.line_id.split(","),e.product.visiable=t.info.visiable,e.product.buyLimit=t.info.buy_limit,e.product.storage=t.info.storage,e.product.locationId=t.info.location_id,e.product.marketPrice=t.info.market_price,e.product.singlePrice=t.info.single_price,e.product.default_type=t.info.customer_type,e.product.default_collect_type=t.info.collect_type,e.product.customerVisiable=t.info.customer_visiable,e.getSkuInfo(1))},{id:i})};c(),e.getSkuInfo=function(a){0==parseInt(a)&&(e.product.skuNumber=""),""!=e.product.skuNumber&&(t.is_loading=!0,s.getdata("product/get_sku_info","POST",function(s){t.is_loading=!1,0===parseInt(s.status)?(e.info=s.info,e.locations=s.location,e.allLines=s.line_options,e.visiables=s.visiable_options,e.customerVisiableOptions=s.customer_visiable_options,angular.forEach(e.customerVisiableOptions,function(t){t.value==e.product.customerVisiable&&(e.init.customerVisiable=t)}),e.customer_type_options=s.customer_type_options,e.collect_type_options=s.collect_type_options,e.product.default_type?angular.forEach(e.customer_type_options,function(t){t.value==e.product.default_type&&(e.default_type=t)}):e.default_type=0!=s.customer_type_options.length?s.customer_type_options[0]:!1,e.product.default_collect_type?angular.forEach(e.collect_type_options,function(t){t.value==e.product.default_collect_type&&(e.default_collect_type=t)}):e.default_collect_type=0!=s.collect_type_options.length?s.collect_type_options[0]:!1,i&&(angular.forEach(s.info.product_status,function(t){t.status==e.product.status&&(e.init.productStatus=t)}),angular.forEach(e.locations,function(t){t.id==e.product.locationId&&(e.init.location=t)}),angular.forEach(e.visiables,function(t){t.id==e.product.visiable&&(e.init.visiable=t)}),angular.forEach(s.info.units,function(t){t.id==e.init.unitId&&(e.init.unit=t),t.id==e.init.closeUnitId&&(e.init.closeUnit=t)}),e.lines=s.line_options[e.init.location.id],angular.forEach(e.lines,function(t){-1!=e.product.lineId.indexOf(t.id)&&(t.checked=!0)})),void 0==e.init.visiable&&(e.init.visiable=e.visiables[0])):n.tips({bodyText:s.msg})},{skuNumber:e.product.skuNumber}))},e.selectCity=function(){e.lines=e.allLines[e.init.location.id]},e.select_type=function(t){e.default_type=t},e.select_collect_type=function(t){e.default_collect_type=t},e.add=function(){if(e.product.unitName=e.init.unit.name,e.product.status=e.init.productStatus.status,e.product.closeUnit=e.init.closeUnit.name,e.product.locationId=e.init.location.id,e.product.visiable=e.init.visiable.id,e.product.customerType=e.default_type?e.default_type.value:1,e.product.collectType=e.default_collect_type?e.default_collect_type.value:1,e.product.customerVisiable=e.init.customerVisiable.value,""==e.product.title)return void alert("标题为空");var a=[];2==e.product.visiable?angular.forEach(e.lines,function(t){void 0!=t.checked&&t.checked===!0&&a.push(t.id)}):a=[0],e.product.lineId=a,e.product.isRound=e.init.isRound?1:0,t.is_loading=!0,s.getdata("/product/save","POST",function(e){t.is_loading=!1,0===parseInt(e.status)?(n.tips({bodyText:"保存成功！"}),s.redirect("/product")):n.tips({bodyText:"保存失败，请稍后重试。"})},e.product)}}]),angular.module("hop").controller("ProductDetailCtrl",["$rootScope","$scope","req","$stateParams","$location","$cookieStore","dialog","daChuLocal","daChuTimer",function(t,e,s,a,o,l,n){e.productsChild=[];var i=a.productId;e.title="商品详情",e.product={title:"",id:i,skuNumber:"",advWords:"",price:50,marketPrice:80,singlePrice:3,unitName:"",isRound:1,storage:"",buyLimit:0,lineId:[0],visiable:1,closeUnit:"",status:1},e.rounds=[{name:"是",val:1,checked:1},{name:"否",val:0,checked:0}],e.init={unit:"",closeUnit:"",skuNumber:"",isRound:!0,productStatus:""};var c=function(){s.getdata("product/detail","POST",function(t){0===parseInt(t.status)&&(e.log_list=t.log_list,e.product.skuNumber=t.info.sku_number,e.product.title=t.info.title,e.product.status=t.info.status,e.init.unitId=t.info.unit_id,e.init.isRound=parseInt(t.info.is_round)?!0:!1,e.init.closeUnitId=t.info.close_unit,e.product.advWords=t.info.adv_words,e.product.price=t.info.price,e.product.lineId=t.info.line_id.split(","),e.product.visiable=t.info.visiable,e.product.buyLimit=t.info.buy_limit,e.product.storage=t.info.storage,e.product.locationId=t.info.location_id,e.product.marketPrice=t.info.market_price,e.product.singlePrice=t.info.single_price,e.product.default_type=t.info.customer_type,e.product.default_collect_type=t.info.collect_type,e.product.opLog=t.info.workflow_log,e.getSkuInfo(1))},{id:i})};c(),e.getSkuInfo=function(a){0==parseInt(a)&&(e.product.skuNumber=""),""!=e.product.skuNumber&&(t.is_loading=!0,s.getdata("product/get_sku_info","POST",function(s){t.is_loading=!1,0===parseInt(s.status)?(e.info=s.info,e.locations=s.location,e.allLines=s.line_options,e.visiables=s.visiable_options,e.customer_type_options=s.customer_type_options,e.collect_type_options=s.collect_type_options,e.product.default_type?angular.forEach(e.customer_type_options,function(t){t.value==e.product.default_type&&(e.default_type=t)}):e.default_type=0!=s.customer_type_options.length?s.customer_type_options[0]:!1,e.product.default_collect_type?angular.forEach(e.collect_type_options,function(t){t.value==e.product.default_collect_type&&(e.default_collect_type=t)}):e.default_collect_type=0!=s.collect_type_options.length?s.collect_type_options[0]:!1,i&&(angular.forEach(s.info.product_status,function(t){t.status==e.product.status&&(e.init.productStatus=t)}),angular.forEach(e.locations,function(t){t.id==e.product.locationId&&(e.init.location=t)}),angular.forEach(e.visiables,function(t){t.id==e.product.visiable&&(e.init.visiable=t)}),angular.forEach(s.info.units,function(t){t.id==e.init.unitId&&(e.init.unit=t),t.id==e.init.closeUnitId&&(e.init.closeUnit=t)}),e.lines=s.line_options[e.init.location.id],angular.forEach(e.lines,function(t){-1!=e.product.lineId.indexOf(t.id)&&(t.checked=!0)})),void 0==e.init.visiable&&(e.init.visiable=e.visiables[0])):n.tips({bodyText:s.msg})},{skuNumber:e.product.skuNumber}))}}]),angular.module("hop").controller("ProductAddCtrl",["$rootScope","$scope","req","$location","$cookieStore","dialog","daChuLocal","daChuTimer",function(t,e,s,a,o,l){e.productsChild=[],e.title="添加货物",e.product={title:"",skuNumber:"",advWords:"",price:50,marketPrice:80,singlePrice:3,unitName:"",isRound:0,closeUnit:"",storage:-1,lineId:0,visiable:1,customerVisiable:0,buyLimit:0,status:1},e.rounds=[{name:"是",val:1,checked:1},{name:"否",val:0,checked:0}],e.init={unit:"",closeUnit:"",skuNumber:"",isRound:!1,productStatus:""},e.getSkuInfo=function(a){0==parseInt(a)&&(e.init.skuNumber="",e.info=""),""!=e.init.skuNumber&&(e.product.skuNumber=e.init.skuNumber,t.is_loading=!0,s.getdata("product/get_sku_info","POST",function(s){t.is_loading=!1,0===parseInt(s.status)?(e.info=s.info,e.locations=s.location,e.visiables=s.visiable_options,e.init.location=s.location[0],e.init.visiable=s.visiable_options[0],e.init.customerVisiable=s.customer_visiable_options[0],e.customerVisiableOptions=s.customer_visiable_options,e.lines=s.line_options[e.init.location.id],e.allLines=s.line_options,e.init.line=e.lines[0],e.init.unit=s.info.units[1],e.init.closeUnit=s.info.units[0],e.init.productStatus=s.info.product_status[1],e.customer_type_options=s.customer_type_options,e.collect_type_options=s.collect_type_options,e.default_type?angular.forEach(e.customer_type_options,function(t){t.value==e.default_type.value&&(e.default_type=t)}):e.default_type=s.customer_type_options&&0!=s.customer_type_options.length?s.customer_type_options[0]:!1,e.default_collect_type?angular.forEach(e.collect_type_options,function(t){t.value==e.default_collect_type.value&&(e.default_collect_type=t)}):e.default_collect_type=s.collect_type_options&&0!=s.collect_type_options.length?s.collect_type_options[0]:!1):l.tips({bodyText:s.msg})},{skuNumber:e.product.skuNumber}))},e.select_type=function(t){e.default_type=t},e.select_collect_type=function(t){e.default_collect_type=t},e.add=function(){e.product.unitName=e.init.unit.name,e.product.closeUnit=e.init.closeUnit.name,e.product.status=e.init.productStatus.status,e.product.locationId=e.init.location.id,e.product.visiable=e.init.visiable.id,e.product.customerVisiable=e.init.customerVisiable.value,e.product.customerType=e.default_type?e.default_type.value:1,e.product.collectType=e.default_collect_type?e.default_collect_type.value:1;var a=[];return 2==e.product.visiable?angular.forEach(e.lines,function(t){void 0!=t.checked&&t.checked===!0&&a.push(t.id)}):a=[0],""==e.product.title?void alert("标题为空"):(e.product.lineId=a,e.product.isRound=e.init.isRound?1:0,t.is_loading=!0,void s.getdata("/product/save","POST",function(e){t.is_loading=!1,0===parseInt(e.status)?(l.tips({bodyText:"保存成功！"}),s.redirect("/product")):l.tips({bodyText:"保存失败，请稍后重试。"})},e.product))},e.selectCity=function(){e.lines=e.allLines[e.init.location.id]}}]),angular.module("hop").controller("MemberRebateCtrl",["$location","dialog","req","$scope",function(t,e,s,a){a.status="all",a.locations=[{id:0,name:"全国"}];var o=function(){s.getdata("member_rebate/list_options","POST",function(t){0==t.status&&(a.locations=a.locations.concat(t.cities),a.location=a.locations[0])})};o(),a.keyList=[{name:"手机号",val:"mobile"},{name:"姓名",val:"name"},{name:"店铺名称",val:"shop_name"}],a.searchKey=a.keyList[0];var l=function(){var t=a.location?a.location.id:0,e={provinceId:t,key:a.key,currentPage:a.paginationConf.currentPage,itemsPerPage:a.paginationConf.itemsPerPage};void 0!=a.customerType&&(e.customer_type=a.customerType.value),s.getdata("member_rebate/lists","POST",function(t){0==t.status&&(a.paginationConf.totalItems=t.total,a.list=t.list)},e)};a.paginationConf={currentPage:1,itemsPerPage:15},a.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",l),a.search=function(){l()},a.reset=function(){a.key="",a.location=a.locations[0],l()}}]),angular.module("hop").controller("MemberRebateEditCtrl",["$location","dialog","req","$scope","$stateParams","$cookieStore",function(t,e,s,a,o){var l=function(){return{getRebateInfo:function(){s.getdata("member_rebate/edit_input","POST",function(t){if(0==t.status){a.info=t.info,a.categories=t.categories,a.groupCategories=[];var e=[];a.categories.length>0&&(a.categories.filter(function(t,s){if(e.push(t),(s+1)%2==0){var o=angular.copy(e);a.groupCategories.push({group:o}),e.length=[]}}),e.length>0&&a.groupCategories.push({group:e})),a.originGroupCategories=angular.copy(a.groupCategories)}},{id:o.customerId})}}},n={init:function(){a.openLightboxModal=function(){},l().getRebateInfo()},saveRebate:function(){e.tips({actionText:"确定",bodyText:"确定设置客户折扣吗?",ok:function(){s.getdata("member_rebate/edit","POST",function(t){e.tips(0==t.status?{bodyText:"设置成功！"}:{bodyText:"设置失败！"+t.msg})},{customerId:o.customerId,rebateGroup:a.groupCategories})}})},"goto":function(t){$state.go(t)},open:function(t){t.preventDefault(),t.stopPropagation(),a.model_order.opened=!0},endOpen:function(t){t.preventDefault(),t.stopPropagation(),a.model_order.endOpened=!0},initParam:function(){a.status="-1",a.model_order.searchValue="",a.model_order.startTime="",a.model_order.endTime=""},reset:function(){a.groupCategories=angular.copy(a.originGroupCategories)},back:function(){history.go(-1)}};n.init(),a.func=n}]),angular.module("hop").controller("HomeAchieveCtrl",["dialog","req","$scope","$modal","$window","$cookieStore","HopAuth",function(t,e,s){s.data="",e.getdata("hop/summary/index","GET",function(t){0==t.status&&(s.data=t.data)})}]),angular.module("hop").controller("HomeCtrl",["$scope",function(t){t.awesomeThings=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Bootstrap",url:"http://getbootstrap.com/",description:"Bootstrap is the most popular HTML, CSS, and JS framework for developing responsive, mobile first projects on the web.",logo:"bootstrap.png"},{title:"Angular UI Bootstrap",url:"http://angular-ui.github.io/bootstrap/",description:"Bootstrap components written in pure AngularJS by the AngularUI Team.",logo:"ui-bootstrap.png"},{title:"Stylus",url:"http://learnboost.github.io/stylus/",description:"Stylus is a revolutionary new language, providing an efficient, dynamic, and expressive way to generate CSS. Supporting both an indented syntax and regular CSS style.",logo:"stylus.png"}],angular.forEach(t.awesomeThings,function(t){t.rank=Math.random()})}]),angular.module("hop").controller("CustomerCouponAddCtrl",["$scope","$stateParams","req","$upload","daChuLocal","dialog",function(t,e,s,a,o,l){t.title="发放券码";var n=function(){s.getdata("coupon/info","POST",function(e){0===parseInt(e.status)&&(t.couponName=e.info.title,t.locationId=e.info.location_id,t.siteId=e.info.site_id,t.siteName=e.info.site_cn,t.couponNums=1,t.locationName=e.info.location_cn,t.visiables=e.info.visiables,t.visiable=e.info.visiables[0])},{id:e.couponId})};n(),t.initValues={name:"添加",value:"",id:"",icon:"glyphicon-plus",cls:"btn-info",clk:"addUser"},t.users=[t.initValues],t.remove=function(e){var s=t.users.indexOf(e);t.users.splice(s,1)},t.addUser=function(e,s){void 0==s&&(s="");var a={name:"删除",value:s,id:"",icon:"glyphicon-minus",cls:"btn-danger",clk:"remove"};t.users.push(a)},t.showUsers=function(e){var a=(t.users.indexOf(e),{locationId:t.locationId,siteId:t.siteId,searchVal:e.value});
s.getdata("customer/manage","POST",function(t){e.users=t.list},a)},t.selectUser=function(e,s){var a=t.users.indexOf(s);t.users[a].id=e.id,t.users[a].value=e.mobile+"|"+e.shop_name,s.users=""},t.add=function(a){if(a.$invalid)return void l.tips({bodyText:"请填写完整信息！"});var o={couponId:e.couponId,mobiles:[],visiable:t.visiable.id};angular.forEach(t.users,function(t){""!=t.value&&o.mobiles.push(t.value)}),s.getdata("customer_coupon/create","POST",function(t){alert(t.msg),0===parseInt(t.status)&&s.redirect("/customer/coupon")},o)}}]),angular.module("hop").controller("CustomerCouponCtrl",["$scope","req",function(t,e){t.title="用户券码列表",t.paginationConf={currentPage:1,itemsPerPage:50},t.status="all";var s=function(){var s={currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage,searchVal:t.key,status:t.status};e.getdata("customer_coupon/lists","POST",function(e){t.coupons=e.list,t.paginationConf.totalItems=e.total},s)};t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",s),t.search=function(){s()},t.reset=function(){t.key=""},t.filterByStatus=function(e){t.status=e,s()},t.setStatus=function(s,a){e.getdata("customer_coupon/set_status","POST",function(e){var o=t.coupons.indexOf(s);t.coupons[o].status=a,alert(e.msg)},{id:s.id,status:a})}}]),angular.module("hop").controller("CouponRuleAddCtrl",["$scope","req","$upload","daChuLocal","dialog",function(t,e,s,a,o){t.title="规则生成";var l=function(){e.getdata("coupon_rules/input_options","GET",function(e){t.ruleTypes=e.list.rules_type,t.ruleType=t.ruleTypes[0]})};l(),t.add=function(s){if(s.$invalid)return void o.tips({bodyText:"请填写完整信息！"});2==t.ruleType.id&&(t.requireAmount=0);var a={title:t.name,ruleType:t.ruleType.id,requireAmount:t.requireAmount,minusAmount:t.minusAmount};e.getdata("coupon_rules/create","POST",function(t){alert(t.msg)},a)}}]),angular.module("hop").controller("CouponRuleCtrl",["$scope","req",function(t,e){t.title="规则列表",t.paginationConf={currentPage:1,itemsPerPage:50},t.status="all";var s=function(){var s={currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage,searchVal:t.key,status:t.status};e.getdata("coupon_rules/lists","POST",function(e){t.couponRules=e.list,t.paginationConf.totalItems=e.total},s)};t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",s),t.search=function(){s()},t.reset=function(){t.key="",s()},t.filterByStatus=function(e){t.status=e,s()},t.setStatus=function(s,a){e.getdata("coupon_rules/set_status","POST",function(e){var o=t.couponRules.indexOf(s);t.couponRules[o].status=a,alert(e.msg)},{id:s.id,status:a})}}]),angular.module("hop").controller("CouponAddCtrl",["$scope","$stateParams","req","$upload","daChuLocal","dialog",function(t,e,s,a,o,l){t.title="发券活动创建",t.dateOptions={formatYear:"yy",startingDay:1},t.endDateOptions={formatYear:"yy",startingDay:1},t.endOpened=t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.endOpen=function(e){e.preventDefault(),e.stopPropagation(),t.endOpened=!0},t.initValues={name:"添加",value:"",id:"",icon:"glyphicon-plus",cls:"btn-info",clk:"addProduct"},t.products=[],t.products.push(t.initValues),t.category=[],t.category.push(t.initValues),t.addProduct=function(t,e){if((!e||e.length)&&e){var s={name:"删除",value:"",id:"",icon:"glyphicon-minus",cls:"btn-danger",clk:"remove"};e.push(s)}},t.remove=function(t,e){if((!e||e.length)&&e){var s=e.indexOf(t);e.splice(s,1)}},t.showProduct=function(e,a){var o=(t.products.indexOf(e),{locationId:t.location.id,searchVal:e.value}),l=function(t,e){s.getdata(t,"POST",function(t){e&&e(t)},o)};"product"==a&&l("product/manage",function(t){e.products=t.list}),"category"==a&&l("coupon/get_category_info",function(t){e.category=t})},t.selectProduct=function(e,s,a){var o={name:"添加",value:"",id:"",icon:"glyphicon-plus",cls:"btn-info",clk:"addProduct"};if("product"==a){t.category=[o];var l=t.products.indexOf(s);t.products[l].id=e.id,t.products[l].value=e.title+"|"+e.sku_number+"|"+e.price+"/"+e.unit,s.products=""}if("category"==a){t.products=[o];var l=t.category.indexOf(s);t.category[l].id=e.id,t.category[l].value=e.name,s.category=""}},t.getReslut=function(t){var e=[];return angular.forEach(t,function(t){parseInt(t.id)>0&&e.push(t.id)}),e};var n=function(){s.getdata("coupon/input_options","POST",function(e){0===parseInt(e.status)&&(t.ruleInfo=e.list.ruleInfo,t.name=e.list.ruleInfo,t.couponNums=1,t.locationInfo=e.list.location,t.siteSrcs=e.list.sites,t.lineOptions=e.list.line_options,t.visiables=e.list.visiable_options,t.visiable=e.list.visiable_options[0],t.couponObjects=e.list.couponObjects,t.couponTriggers=e.list.couponTriggers,t.couponTrigger=e.list.couponTriggers[0],t.site=t.siteSrcs[0],t.location=t.locationInfo[0],t.lines=t.lineOptions[t.location.id])},{id:e.ruleId})};t.link_url="",n(),t.add=function(a){if(a.$invalid)return void l.tips({bodyText:"请填写完整信息！"});var o={title:t.name,ruleId:e.ruleId,couponNums:t.couponNums,siteId:t.site.id,locationId:t.location.id,products:[],categories:[],validTime:"",invalidTime:"",visiable:t.visiable.id,couponTriggerId:t.couponTrigger.id};t.products.length&&t.products[0].id>0?o.products=t.getReslut(t.products):o.categories=t.getReslut(t.category),o.validTime=Date.parse(t.startTime)/1e3,o.invalidTime=Date.parse(t.endTime)/1e3,o.couponTriggerId=t.couponTrigger.id,s.getdata("coupon/create","POST",function(t){alert(t.msg),s.redirect("/coupon")},o)},t.selectCity=function(){t.lines=t.allLines[t.init.location.id]},t.setStatus=function(e,a){s.getdata("coupon/set_status","POST",function(s){var o=t.coupons.indexOf(e);t.coupons[o].status=a,alert(s.msg)},{id:e.id,status:a})}}]),angular.module("hop").controller("CouponCtrl",["$scope","req",function(t,e){t.title="券码列表",t.paginationConf={currentPage:1,itemsPerPage:50},t.status="all";var s=function(){var s={currentPage:t.paginationConf.currentPage,itemsPerPage:t.paginationConf.itemsPerPage,searchVal:t.key,status:t.status};e.getdata("coupon/lists","POST",function(e){t.coupons=e.list,t.paginationConf.totalItems=e.total},s)};t.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",s),t.search=function(){s()},t.reset=function(){t.key="",s()},t.filterByStatus=function(e){t.status=e,s()},t.setStatus=function(s,a){e.getdata("coupon/set_status","POST",function(e){var o=t.coupons.indexOf(s);t.coupons[o].status=a,alert(e.msg)},{id:s.id,status:a})}}]),angular.module("hop").controller("AdsPosCtrl",["$rootScope","$scope","req",function(t,e,s){e.title="广告位列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.status="all";var a=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,status:e.status};t.is_loading=!0,s.getdata("ads_position/lists","POST",function(s){t.is_loading=!1,e.positions=s.list,e.paginationConf.totalItems=s.total},a)};a(),e.search=function(){a()},e.reset=function(){e.key="",a()},e.filterByStatus=function(t){e.status=t,a()},e.setStatus=function(t,a){s.getdata("ads_position/set_status","POST",function(s){var o=e.positions.indexOf(t);e.positions[o].status=a,alert(s.msg)},{id:t.id,status:a})}}]),angular.module("hop").controller("AdsPosCreateCtrl",["$rootScope","$scope","req",function(t,e,s){e.title="添加广告位";var a=function(){s.getdata("ads_position/input_options","GET",function(t){0===parseInt(t.status)&&(e.options=t.list,e.pos_status=e.options.status[0])})};a(),e.pos={title:"",status:1},e.add=function(){e.pos.status=e.pos_status.value,t.is_loading=!0,s.getdata("ads_position/save","POST",function(e){t.is_loading=!1,alert(e.msg),0==e.status&&s.redirect("/position")},e.pos)}}]),angular.module("hop").controller("AdvCreateCtrl",["$rootScope","$scope","$filter","req","$upload","daChuLocal","dialog",function(t,e,s,a,o,l,n){e.title="添加广告",e.loginStatus=[{status:0,name:"全部用户"},{status:1,name:"登陆用户"},{status:1,show_line:!0,name:"指定线路用户"}],e.getLoginStatus=function(t){e.show_line=t.show_line?!0:!1},e.dateOptions={formatYear:"yy",startingDay:1},e.endDateOptions={formatYear:"yy",startingDay:1},e.endOpened=e.opened=!1,e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0},e.endOpen=function(t){t.preventDefault(),t.stopPropagation(),e.endOpened=!0};var i=function(){a.getdata("ads/input_options","GET",function(t){0===parseInt(t.status)&&(e.positions=t.list.positions,e.locationInfo=t.list.locations,e.siteSrcs=t.list.sites,e.site=e.siteSrcs[0],e.location=e.locationInfo[0],e.catemap=t.list.catemaps,e.cateMaps=e.catemap[e.site.id][e.location.id],e.advStatus=t.list.adv_status,e.advsStatus=e.advStatus[0],e.line=t.list.line_options,e.line_default=e.line[804])})};e.link_url="",i(),e.getMaps=function(){e.cateMaps=e.catemap[e.site.id][e.location.id],e.line_default=e.line[e.location.id],console.log(e.location.id)},e.$watch("files",function(){void 0!=e.files&&e.upload("imgUploads","files")}),e.upload=function(t,s){var a=[];angular.forEach(e[s],function(s){o.upload({url:"http://img.dachuwang.com/upload?bucket=sku",file:s,fileFormDataName:"files[]"}).progress(function(t){var e=parseInt(100*t.loaded/t.total);s.progressPercentage=e}).success(function(o){s.dataUrl=o.files[0].url,s.pic_size=s.size+"bytes",a.push(s),e[t]=a,l.set(t,e[t])})})},e.add=function(s){if(s.$invalid||!e.imgUploads)return void n.tips({bodyText:"请填写完整信息！"});var o={pic_url:"",detail_img:"",site_id:1,location_id:1,title:"",pos_id:"",link_url:"",line_id:[]};o.pic_url=e.imgUploads[0].dataUrl,e.detailUploads&&(o.detail_img=e.detailUploads[0].dataUrl),o.site_id=e.site.id,o.location_id=e.location.id,o.title=e.name,angular.forEach(e.line_default,function(t){t.checked&&o.line_id.push(t.id)}),o.needLogin=e.m.status,o.onlineTime=Date.parse(e.startTime)/1e3,o.offlineTime=Date.parse(e.endTime)/1e3,o.link_url=e.catemap_s?"page.list({cateId:"+e.catemap_s.origin_id+"})":e.link_url,angular.forEach(e.line_default,function(){}),angular.forEach(e.positions,function(t){t.checked&&(o.pos_id+=t.id+",")}),t.is_loading=!0,a.getdata("ads/save","POST",function(e){t.is_loading=!1,alert(e.msg),0==e.status&&a.redirect("/ads")},o)},e.picCancel=function(t,s){var a="detailUploads";0===parseInt(s)&&(a="imgUploads");var o=e[a].indexOf(t);e[a].splice(o,1),e[a]&&l.set(a,e[a])}}]),angular.module("hop").controller("AdsCtrl",["$rootScope","$scope","req",function(t,e,s){e.title="广告列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.status="all";var a=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,status:e.status};t.is_loading=!0,s.getdata("ads/lists","POST",function(s){t.is_loading=!1,e.advs=s.list,e.paginationConf.totalItems=s.total},a)};e.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",a),e.search=function(){a()},e.reset=function(){e.key="",a()},e.filterByStatus=function(t){e.status=t,a()},e.setStatus=function(t,a){s.getdata("ads/set_status","POST",function(s){var o=e.advs.indexOf(t);e.advs[o].status=a,alert(s.msg)},{id:t.id,status:a})}}]),angular.module("hop").controller("ActivityAddCtrl",["$scope","req","rpc","$upload","daChuLocal",function(t,e,s){t.title="发布运营活动";var a=function(){e.getdata("promotion/input_options","GET",function(e){0===parseInt(e.status)&&(t.locationInfo=e.list.locations,t.location=e.list.locations[0],t.type=e.list.types,t.firstOptions=e.list.first_options,t.isFirst=t.firstOptions[1],t.groups=e.list.order_groups,t.groups.push({id:-1,name:"新增分组..."}),t.showNewGroup=!1,t.orderGroup=t.groups[0],t.newCustomerOptions=e.list.new_customer_options,t.isNewCustomer=t.newCustomerOptions[0])})};a(),t.changeGroup=function(){t.showNewGroup=-1==t.orderGroup.id?!0:!1},t.dateOptions={formatYear:"yy",startingDay:1},t.endDateOptions={formatYear:"yy",startingDay:1},t.latestOptions={formatYear:"yy",startingDay:1},t.endOpened=t.latestOpened=t.opened=!1,t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.endOpen=function(e){e.preventDefault(),e.stopPropagation(),t.endOpened=!0},t.latestOpen=function(e){return void 0==t.endTime||void 0==t.startTime?(alert("请先选择活动时间范围"),!1):(e.preventDefault(),e.stopPropagation(),void(t.latestOpened=!0))},t.add=function(){var a={title:"",location_id:1,rule:"",startTime:"",endTime:"",latestDeliverTime:"",categoryNames:"",categoryLimitNum:0,group_id:""};a.location_id=t.location.id,a.rule=t.rule,a.title=t.name,a.startTime=Date.parse(t.startTime)/1e3,a.endTime=Date.parse(t.endTime)/1e3,a.latestDeliverTime=Date.parse(t.latestDeliverTime)/1e3,a.categoryNames=t.categoryNames?t.categoryNames:"",a.categoryLimitNum=t.categoryLimitNum?t.categoryLimitNum:0,a.ruleType=t.ruleType?t.ruleType.id:0,a.isFirst=t.isFirst?t.isFirst.id:1,a.isNewCustomer=t.isNewCustomer?t.isNewCustomer.id:0,a.groupId=t.orderGroup?t.orderGroup.id:1;var o=!0;return-1==a.groupId&&(a.groupId=-1,a.groupName=t.newGroupName,""==t.newGroupName?(alert("请输入新分组名称"),o=!1):angular.forEach(t.groups,function(e){e.name==t.newGroupName&&(alert('分组名称"'+t.newGroupName+'"已存在！请重新填写。'),o=!1)})),o?a.title?t.ruleType?void s.load("promotion/save","POST",a).then(function(t){alert(t.msg),e.redirect("/activity")},function(t){alert(t)}):(alert("请选择活动类型"),!1):(alert("请输入活动标题"),!1):!1}}]),angular.module("hop").controller("ActivityCtrl",["$rootScope","$scope","rpc",function(t,e,s){e.title="运营活动列表",e.paginationConf={currentPage:1,itemsPerPage:50},e.status="all";var a=function(){var a={currentPage:e.paginationConf.currentPage,itemsPerPage:e.paginationConf.itemsPerPage,searchVal:e.key,status:e.status};t.is_loading=!0,s.load("promotion/lists","POST",a).then(function(s){t.is_loading=!1,e.advs=s.list,e.paginationConf.totalItems=s.total})};a(),e.search=function(){a()},e.reset=function(){e.key="",a()},e.filterByStatus=function(t){e.status=t,a()},e.setStatus=function(t,e){s.load("promotion/set_status","POST",{id:t.id,status:e}).then(function(){t.status=e})}}]),angular.module("hop").controller("TopCtrl",["$scope","$cookieStore","$location","HopAuth",function(t,e,s,a){if(t.status={isopen:!1},a.auth(),t.isLogin=a.isLogin,t.title="销售管理系统",t.isLogin){var o=e.get("type");100===parseInt(o)?t.userInfo="超级管理员":10==parseInt(o)?t.userInfo="运营":11===parseInt(o)?t.userInfo="财务":103===parseInt(o)&&(t.userInfo="仓管"),t.toggleDropdown=function(e){e.preventDefault(),e.stopPropagation(),t.status.isopen=!t.status.isopen},t.logout=function(){a.logout()},t.changePwd=function(){a.pwd()}}else s.path("/login")}]),angular.module("hop").controller("SidebarCtrl",["$scope","$location","$cookieStore",function(t,e,s){t.selectedItem=null,t.changeUrl=function(e){t.selectedItem=e};var a=parseInt(s.get("type")),o={name:"商品管理",val:[{name:"商品列表",val:"home.product"},{name:"库存管理",val:"home.storage"},{name:"商品改价",val:"home.productPrice"},{name:"KA定价策略",val:"home.memberRebate"}]},l={name:"广告管理",val:[{name:"广告管理",val:"home.ads"},{name:"广告位管理",val:"home.adsPosition"}]},n={name:"运营活动管理",val:[{name:"促销活动管理",val:"home.activity"},{name:"首页推荐",val:"home.recommend"},{name:"专题列表",val:"home.subject"}]},i={name:"优惠券管理",val:[{name:"规则控制器",val:"home.couponRule"},{name:"发券活动管理",val:"home.coupon"},{name:"券码管理",val:"home.customerCoupon"}]};t.urls=100===a?[o,l,n,i]:[o,l,n]}]),angular.module("hop").controller("NavbarCtrl",["$scope","$cookieStore","$location",function(t,e,s){t.currentUrl=s.$$url.split("_")[0],t.status={isopen:!1},t.title="SMS"}]),angular.module("hop").factory("daChuTimer",function(){var t={getNow:function(){return parseInt((new Date).getTime()/1e3)},cacheTime:30};return{getNow:t.getNow,setCacheTime:function(e){t.cacheTime=parseInt(e)},compare:function(e){var s=this.getNow();return parseInt(e)+t.cacheTime>s?!0:!1}}}),angular.module("hop").factory("rpc",["$http","$q","$location","$cookieStore","appConfigure","daChuLocal",function(t,e,s,a,o,l){return{load:function(s,a,n){var i=this,c=e.defer();return void 0==a&&(a="POST"),t({url:o.url+"/"+s+"?r="+Math.random(),method:a,cache:!1,withCredentials:!0,data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){t&&-100===t.status?(l.remove("token"),c.reject("您还未登录，请先登录。"),i.redirect("/user/login",i.refer)):t&&0===t.status?c.resolve(t):c.reject(t&&0!==t.status?t.msg:"请求失败，请检查网络。")}).error(function(t){c.reject(t)}),c.promise},init:s,refer:"/",redirect:function(t,e){return void 0!=e?this.refer=e:""==t&&s.path(this.refer),s.path(t),!1}}}]),angular.module("hop").factory("req",["$http","$location","$cookieStore","appConfigure",function(t,e,s,a){var o=(e.$$host,a.url);return{getdata:function(e,a,l,n){void 0==a&&(a="POST");var i=this;t({url:o+"/"+e+"?r="+Math.random(),method:a,cache:!1,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n}).success(function(t){t&&-100===t.status&&(s.remove("id"),s.remove("type"),i.redirect("/user/login")),l(t)})},init:e,refer:"/",redirect:function(t,s){void 0!=s?this.refer=s:""==t&&e.path(this.refer),e.path(t)}}}]),angular.module("hop").factory("pagination",function(){var t={page:1,isProcessing:!1,processingText:"努力加载中...",isDone:!1,more:"点击加载更多",callback:null};return t.nextPage=function(){t.isProcessing||t.isDone||(t.more="正在加载更多...",t.isProcessing=!0,t.page++,t.callback&&t.callback(function(e){e?(t.isDone=!0,t.more="没有更多了"):t.more="点击加载更多",t.isProcessing=!1}))},t.init=function(e){t.page=1,t.isProcessing=!1,t.isDone=!1,t.more="点击加载更多",t.callback=e},t}),angular.module("hop").factory("daChuLocal",function(){var t={get:function(t){return JSON.parse(localStorage.getItem(t))},set:function(t,e){localStorage.setItem(t,JSON.stringify(e))}};return t}),angular.module("hop").factory("dialog",["$modal",function(t){var e=function(e,s){var a={headerText:"提示信息",bodyText:"设置成功",closeText:"关闭"},o={templateUrl:"myModalContent.html"};angular.extend(o,s),angular.extend(a,e);t.open({templateUrl:o.templateUrl,controller:"ModalInstanceCtrl",resolve:{items:function(){return a}}})};return{tips:e}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","items",function(t,e,s){t.items=s,t.selected={item:t.items[0]},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("hop").factory("HopPermit",["req",function(){var t=[100,10,11,12,103],e={menus:{},checkType:function(e){return-1!==t.indexOf(e)?!0:!1}};return{getPermit:function(t){return e.checkType(t)?!0:!1}}}]).factory("HopAuth",["HopPermit","$cookieStore","req","dialog",function(t,e,s,a){var o={isLogin:!1,getAuth:function(){var s=parseInt(e.get("type"));return t.getPermit(s)?(this.isLogin=!0,!0):(this.isLogin=!1,!1)},changePwd:function(t){var o=this;o.isLogin&&a.tips({headerText:"修改密码",actionText:"修改密码",ok:function(l){return l.newRePassword!=l.newPassword?!1:(angular.isDefined(t)||(t=e.get("id")),s.getdata("user/update_password","POST",function(t){0===parseInt(t.status)?(a.tips({bodyText:t.msg}),o.isLogin=!1,e.remove("type"),e.remove("id"),s.redirect("/user/login")):a.tips({bodyText:t.msg})},l),!1)}},{templateUrl:"password.html"})}};return{isLogin:o.isLogin,auth:o.getAuth,info:{id:e.get("id"),type:e.get("type")},logout:function(){s.getdata("user/logout","GET",function(){e.remove("type"),e.remove("id"),s.redirect("/login")})},pwd:o.changePwd}}]),angular.module("hop").filter("unsafe",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]),angular.module("hop").filter("money",function(){return function(t,e){return t=parseFloat(t)||0,e=0/0!=parseInt(e)?parseInt(e):1,t.toFixed(e)}}),angular.module("dachu.widget",[]).directive("dachuPagination",[function(){return{restrict:"EA",template:'<div class="page-list"><ul class="pagination" ng-show="conf.totalItems > 0"><li ng-class="{disabled: conf.currentPage == 1}" ng-click="prevPage()"><span>&laquo;</span></li><li ng-repeat="item in pageList track by $index" ng-class="{active: item == conf.currentPage, separate: item == \'...\'}" ng-click="changeCurrentPage(item)"><span>{{ item }}</span></li><li ng-class="{disabled: conf.currentPage == conf.numberOfPages}" ng-click="nextPage()"><span>&raquo;</span></li></ul><div class="page-total" ng-show="conf.totalItems > 0">第<input type="text" ng-model="jumpPageNum"  ng-keyup="jumpToPage($event)"/>页 每页<select ng-model="conf.itemsPerPage" ng-options="option for option in conf.perPageOptions " ng-change="changeItemsPerPage()"></select>/共<strong>{{ conf.totalItems }}</strong>条</div><div class="no-items" ng-show="conf.totalItems <= 0">暂无数据</div></div>',replace:!0,scope:{conf:"="},link:function(t){function e(){t.conf.currentPage=parseInt(t.conf.currentPage)?parseInt(t.conf.currentPage):1,t.conf.totalItems=parseInt(t.conf.totalItems),t.conf.rememberPerPage?(parseInt(localStorage[t.conf.rememberPerPage])||(localStorage[t.conf.rememberPerPage]=parseInt(t.conf.itemsPerPage)?parseInt(t.conf.itemsPerPage):15),t.conf.itemsPerPage=parseInt(localStorage[t.conf.rememberPerPage])):t.conf.itemsPerPage=parseInt(t.conf.itemsPerPage)?parseInt(t.conf.itemsPerPage):15,t.conf.numberOfPages=Math.ceil(t.conf.totalItems/t.conf.itemsPerPage),t.conf.currentPage<1&&(t.conf.currentPage=1),t.conf.currentPage>t.conf.numberOfPages&&(t.conf.currentPage=t.conf.numberOfPages),t.jumpPageNum=t.conf.currentPage;for(var e,s=t.conf.perPageOptions.length,a=0;s>a;a++)parseInt(t.conf.perPageOptions[a])==parseInt(t.conf.itemsPerPage)&&(e=!0);if(e||t.conf.perPageOptions.push(t.conf.itemsPerPage),t.conf.perPageOptions.sort(function(t,e){return t-e}),t.pageList=[],t.conf.numberOfPages<=t.conf.pagesLength)for(a=1;a<=t.conf.numberOfPages;a++)t.pageList.push(a);else{var o=(t.conf.pagesLength-1)/2;if(t.conf.currentPage<=o){for(a=1;o+1>=a;a++)t.pageList.push(a);t.pageList.push("..."),t.pageList.push(t.conf.numberOfPages)}else if(t.conf.currentPage>t.conf.numberOfPages-o){for(t.pageList.push(1),t.pageList.push("..."),a=o+1;a>=1;a--)t.pageList.push(t.conf.numberOfPages-a);t.pageList.push(t.conf.numberOfPages)}else{for(t.pageList.push(1),t.pageList.push("..."),a=Math.ceil(o/2);a>=1;a--)t.pageList.push(t.conf.currentPage-a);for(t.pageList.push(t.conf.currentPage),a=1;o/2>=a;a++)t.pageList.push(t.conf.currentPage+a);t.pageList.push("..."),t.pageList.push(t.conf.numberOfPages)}}t.conf.onChange&&t.conf.onChange(),t.$parent.conf=t.conf}t.changeCurrentPage=function(e){"..."!==e&&(t.conf.currentPage=e)},t.conf.pagesLength=parseInt(t.conf.pagesLength)?parseInt(t.conf.pagesLength):9,t.conf.pagesLength%2===0&&(t.conf.pagesLength=t.conf.pagesLength-1),t.conf.perPageOptions||(t.conf.perPageOptions=[10,15,20,30,50]),t.prevPage=function(){t.conf.currentPage>1&&(t.conf.currentPage-=1)},t.nextPage=function(){t.conf.currentPage<t.conf.numberOfPages&&(t.conf.currentPage+=1)},t.jumpToPage=function(){t.jumpPageNum=t.jumpPageNum.replace(/[^0-9]/g,""),""!==t.jumpPageNum&&(t.conf.currentPage=t.jumpPageNum)},t.changeItemsPerPage=function(){t.conf.rememberPerPage&&localStorage.removeItem(t.conf.rememberPerPage)},t.$watch(function(){var e=t.conf.currentPage+" "+t.conf.totalItems+" ";return e+=t.conf.rememberPerPage&&localStorage[t.conf.rememberPerPage]?localStorage[t.conf.rememberPerPage]:t.conf.itemsPerPage},e)}}}]),angular.module("hop").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,s){var a="app/modules";t.state("home",{url:"/",templateUrl:a+"/home/home.html",controller:"HomeCtrl"}).state("home.product",{url:"product",templateUrl:a+"/product/list.html",controller:"ProductCtrl"}).state("home.storage",{url:"storage",templateUrl:a+"/storage/list.html",controller:"storageCtrl"}).state("home.productPrice",{url:"product/price",templateUrl:a+"/product/price.html",controller:"ProductPriceCtrl"}).state("home.productAdd",{url:"product/add",templateUrl:a+"/product/add.html",controller:"ProductAddCtrl"}).state("home.productEdit",{url:"product/{productId:[0-9]{1,}}",templateUrl:a+"/product/add.html",controller:"ProductEditCtrl"}).state("home.productDetail",{url:"product/detail/{productId:[0-9]{1,}}",templateUrl:a+"/product/detail.html",controller:"ProductDetailCtrl"}).state("home.productSnap",{url:"product/snapshot/{productId:[0-9]{1,}}",templateUrl:a+"/product/snapshot.html",controller:"ProductSnapCtrl"}).state("home.memberRebate",{url:"memberRebate/list",templateUrl:a+"/memberRebate/list.html",controller:"MemberRebateCtrl"}).state("home.memberRebateEdit",{url:"memberRebate/edit/{customerId:[0-9]{1,}}",templateUrl:a+"/memberRebate/edit.html",controller:"MemberRebateEditCtrl"}).state("home.adsCreate",{url:"ads/create",templateUrl:a+"/ads/add.html",controller:"AdvCreateCtrl"}).state("home.ads",{url:"ads",templateUrl:a+"/ads/list.html",controller:"AdsCtrl"}).state("home.posCreate",{url:"position/create",templateUrl:a+"/adsPosition/add.html",controller:"AdsPosCreateCtrl"}).state("home.adsPosition",{url:"position",templateUrl:a+"/adsPosition/list.html",controller:"AdsPosCtrl"}).state("home.activity",{url:"activity",templateUrl:a+"/activity/list.html",controller:"ActivityCtrl"}).state("home.actCreate",{url:"activity/add",templateUrl:a+"/activity/add.html",controller:"ActivityAddCtrl"}).state("home.subject",{url:"subject",templateUrl:a+"/subjects/list.html",controller:"SubjectCtrl"}).state("home.subCreate",{url:"subject/add",templateUrl:a+"/subjects/add.html",controller:"SubjectAddCtrl"}).state("home.recommend",{url:"recommend",templateUrl:a+"/recommends/list.html",controller:"RecommendCtrl"}).state("home.recommendCreate",{url:"recommend/add",templateUrl:a+"/recommends/add.html",controller:"RecommendAddCtrl"}).state("home.coupon",{url:"coupon",templateUrl:a+"/coupon/list.html",controller:"CouponCtrl"}).state("home.couponAdd",{url:"coupon/create/{ruleId:[0-9]{1,}}",templateUrl:a+"/coupon/add.html",controller:"CouponAddCtrl"}).state("home.couponRule",{url:"coupon_rule",templateUrl:a+"/coupon_rules/list.html",controller:"CouponRuleCtrl"}).state("home.couponRuleAdd",{url:"coupon_rule/create",templateUrl:a+"/coupon_rules/add.html",controller:"CouponRuleAddCtrl"}).state("home.customerCoupon",{url:"customer/coupon",templateUrl:a+"/customer_coupon/list.html",controller:"CustomerCouponCtrl"}).state("home.customerCouponAdd",{url:"customer_coupon/create/{couponId:[0-9]{1,}}",templateUrl:a+"/customer_coupon/add.html",controller:"CustomerCouponAddCtrl"}).state("login",{url:"/login",templateUrl:a+"/user/login.html",controller:"LoginCtrl"}),e.otherwise("/"),s.html5Mode(!0)}]),angular.module("hop").provider("appConfigure",{$get:["$location",function(t){var e=t.$$host;return e.indexOf("dachuwang")<0&&(e="sms.dachuwang.net"),{url:"http://api."+e}}]}),angular.module("hop").run(["$templateCache",function(t){t.put("components/navbar/navbar.html",'<div ng-show="is_loading" class="loading-mask"><em></em></div><nav class="navbar navbar-inverse navbar-fixed-top" ng-controller="TopCtrl"><script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 ng-bind-html="items.bodyText | unsafe"></h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok();cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><script type="text/ng-template" id="password.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <form class="row block block-col form-horizontal" role="form" name="passwordForm"> <div class="form-group col-xs-12"> <label for="password" class="col-sm-2 control-label"> <h5> <b>旧密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.password" id="password" placeholder="请输入您的旧密码" ng-minlength="6" name="oldpassword"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.oldpassword.$dirty && passwordForm.oldpassword.$invalid"> <small ng-show="passwordForm.oldpassword.$error.minlength">旧密码至少6位</small> <small ng-show="passwordForm.oldpassword.$error.required">旧密码必填</small> </div> </div> </div> <div class="form-group col-xs-12"> <label for="newpassword" class="col-sm-2 control-label"> <h5> <b>新密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.newPassword" id="newPassword" placeholder="请输入您的新密码" ng-minlength="6" name="password"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.password.$dirty && passwordForm.password.$invalid"> <small ng-show="passwordForm.password.$error.minlength">密码至少6位</small> <small ng-show="passwordForm.password.$error.required">密码必填</small> </div> </div> </div> <div class="form-group col-xs-12"> <label for="newpassword" class="col-sm-2 control-label"> <h5> <b>输入新密码</b> </h5> </label> <div class="col-sm-10"> <input type="password" required class="input-lg form-control" ng-model="reg.newRePassword" id="newRePassword" ng-minlength="6" placeholder="请再次输入您的新密码" name="repassword"> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$dirty && passwordForm.repassword.$invalid"> <small ng-show="passwordForm.repassword.$error.minlength">确认密码至少6位</small> <small ng-show="passwordForm.repassword.$error.required">确认密码必填</small> </div> <div class="col-xs-12 block-col label label-danger" ng-show="passwordForm.repassword.$dirty && passwordForm.repassword.$valid && reg.newRePassword != reg.newPassword"> <small>两次密码不一致</small> </div> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(reg);cancel()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="container-fluid" ng-controller="NavbarCtrl"><div class="navbar-header" style="width:100%;"><a style="padding-right:0;" href="javascript:history.back()" class="glyphicon navbar-brand glyphicon-chevron-left"></a> <a href="/" class="navbar-brand">{{title}}</a><div ng-if="isLogin"><ul class="nav navbar-nav navbar-right"><li class="dropdown" dropdown=""><a href="/" class="dropdown-toggle" dropdown-toggle="">{{userInfo}}<span class="caret"></span></a><ul class="dropdown-menu"><li ng-click="changePwd()"><a href="#">修改密码</a></li><li ng-click="logout()"><a href="#">登出</a></li><div class="mobile_menu" ng-controller="SidebarCtrl"><ul ng-repeat="url in urls"><li ng-repeat="item in url.val"><a ng-href="{{item.val}}" ng-class="{\'active\': item.val==currentUrl}" class="nav-li-child">{{item.name}}</a></li></ul></div></ul></li></ul></div></div></div></nav><div class="nav-mt"></div>'),t.put("components/navbar/navsidebar.html",'<div class="col-xs-2 sidebar" ng-controller="SidebarCtrl"><ul class="nav nav-sidebar"><li role="presentation" ng-click="changeUrl(item.val)"><a ng-href="/" ng-class="{\'active\': currentUrl==\'/\'}" class="nav-li">首页</a></li></ul><ul class="nav nav-sidebar" ng-repeat="url in urls"><li><h4 class="nav-li">{{url.name}}</h4></li><li ng-repeat="item in url.val" ng-click="changeUrl(item.val)"><a ui-sref="{{item.val}}" ng-class="{\'active\': item.val===selectedItem}" class="nav-li-child">{{item.name}}</a></li></ul></div>'),t.put("app/modules/activity/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属城市</b></td><td class="success col-xs-12"><select ng-model="location" class="col-xs-4 input-md form-control" ng-options="m.name for m in locationInfo" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动分组</b></td><td class="success col-xs-6"><select ng-model="orderGroup" class="col-xs-4 input-md form-control" ng-options="m.name for m in groups" required="" ng-change="changeGroup()"></select><input type="text" ng-model="newGroupName" ng-show="showNewGroup" class="form-control" name="name_group" id="name_group" placeholder="请输入分组名称，例如：蔬菜肉类7.15"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动标题</b></td><td class="success col-xs-12"><input type="text" ng-model="name" class="form-control"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动类型</b></td><td class="success col-xs-12"><select ng-model="ruleType" class="form-control" ng-options="m.name for m in type" required=""><option value="">请选择活动类型</option></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动规则</b></td><td class="success col-xs-12"><input type="text" ng-model="rule" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入规则例如，119-10（代表满119减20）"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动开始时间</b></td><td class="success col-xs-12"><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 活动结束时间</b></td><td class="success col-xs-12"><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 最晚配送时间</b></td><td class="success col-xs-12"><input type="text" ng-model="latestDeliverTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="latestOptions" ng-click="latestOpen($event)" min-date="startTime" is-open="latestOpened" id="latestTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 是否只限首单</b></td><td class="success col-xs-12"><select ng-model="isFirst" class="form-control" ng-options="m.name for m in firstOptions" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 是否只限新客</b></td><td class="success col-xs-12"><select ng-model="isNewCustomer" class="form-control" ng-options="m.name for m in newCustomerOptions" required=""></select></td></tr><tr><td class="active col-xs-2"><b>参加活动的分类名称</b></td><td class="success col-xs-12"><input type="text" class="col-xs-4 input-md form-control" ng-model="categoryNames" placeholder="请输入参加活动的分类名称，多个分类用“|”分隔"></td></tr><tr><td class="active col-xs-2"><b>下单时至少需同时包含几个分类</b></td><td class="success col-xs-12"><input type="text" class="col-xs-4 input-md form-control" ng-model="categoryLimitNum" placeholder="请输入数字，0或不填为不限制"></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add()">保存</button></div><div class="col-xs-6"><button type="reset" reback="" class="btn btn-block btn-default btn-md">返回</button></div></td></tr></table></div></div><div class="block-title"></div>'),t.put("app/modules/activity/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.actCreate">发布运营活动</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已下线 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入活动名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td><h5><em class="text-danger">活动id</em></h5></td><td class="text-center"><h5>活动名称</h5></td><td class="text-center"><h5>活动时间</h5></td><td class="text-center"><h5>最晚配送时间</h5></td><td class="text-center"><h5>活动规则</h5></td><td class="text-center"><h5>状态</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in advs"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5>{{item.act_start_time}}/{{item.act_end_time}}</h5></td><td class="text-center"><h5>{{item.latest_deliver_time}}</h5></td><td class="text-center"><h5>{{item.rule}}</h5></td><td class="text-center"><h5><span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-danger" ng-if="item.status == 0">已下线</span></h5></td><td class="text-center"><h5>{{item.location_cn}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-show="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-show="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/activity/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/ads/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="form-horizontal" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 选择广告位</b></td><td class="success col-xs-12"><label ng-repeat="pos in positions"><input ng-model="pos.checked" type="checkbox"> {{pos.title}} &nbsp;</label></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 广告名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="name" required=""></td></tr><tr><td><em class="text-danger">*</em>上传banner图片</td><td><div class="col-xs-12"><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">上传banner图片</span></span> <span class="alert text-danger"><span class="glyphicon glyphicon-pencil m-r-5"></span>banner图片将展示在所选广告位</span></div><div class="panel panel-default" ng-if="imgUploads.length"><div class="panel-heading">当前banner图片</div><div class="panel-body"><table class="table table-striped files"><tr ng-repeat="files in imgUploads"><td><div class="col-xs-6 col-md-3"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"></div></td><td>{{files.name}}</td><td><div class="btn btn-warning cancel" ng-click="picCancel(files, 0)"><i class="glyphicon glyphicon-ban-circle"></i> <span>取消</span></div></td></tr></table></div></div></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>上线时间</b></td><td class="success col-xs-12"><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" required="" max-date="endTime" ng-model="startTime" id="startTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>下线时间</b></td><td class="success col-xs-12"><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" min-date="startTime" required="" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属站点</b></td><td class="success col-xs-12"><select ng-model="site" class="col-xs-4 input-md form-control" ng-options="m.name for m in siteSrcs" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属城市</b></td><td class="success col-xs-12"><select ng-model="location" class="col-xs-4 input-md form-control" ng-options="m.name for m in locationInfo" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 可见性</b></td><td class="success col-xs-12"><select ng-init="m = loginStatus[0]" ng-model="m" class="col-xs-4 input-md form-control" ng-options="m.name for m in loginStatus" ng-change="getLoginStatus(m)" required=""></select></td></tr><tr ng-show="show_line"><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属线路</b></td><td class="success col-xs-12"><div class="checkbox inline col-xs-3" ng-repeat="m in line_default"><label><input type="checkbox" ng-model="m.checked"> {{m.name}}</label></div></td></tr><tr><td class="active col-xs-2"><b>选择映射分类</b></td><td class="success col-xs-12"><div class="col-xs-2 p-0"><select ng-model="catemap_s" class="input-md form-control inline" ng-options="m.name for m in cateMaps | filter : vm.filters.name"><option value="">--选择映射分类--</option></select></div><div class="col-xs-3 input-group pull-left p-0"><div class="input-group-addon"><span class="glyphicon glyphicon-search"></span></div><input type="text" ng-model="vm.filters.name" class="form-control" placeholder="输入货物名进行过滤"></div><span class="text-danger col-xs-7 line_h_34"><span class="glyphicon glyphicon-pencil m-r-5"></span>选择映射分类后，banner将链接到选中分类的list页面</span></td></tr><tr ng-show="!catemap_s"><td class="active col-xs-2"><b>自定义连接</b></td><td class="success col-xs-12"><div class="col-xs-5 p-0"><input class="form-control" placeholder="/subject/xxx (xx为专题id)" type="text" ng-model="link_url"></div><span class="text-danger col-xs-7 line_h_34"><span class="glyphicon glyphicon-pencil m-r-5"></span> 专题url格式:/subject/1</span></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/ads/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.adsCreate">发布广告</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已下线 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入广告名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td><h5><em class="text-danger">广告id</em></h5></td><td class="text-center"><h5>广告名称</h5></td><td class="text-center"><h5>图片</h5></td><td class="text-center"><h5>广告位</h5></td><td class="text-center"><h5>广告状态</h5></td><td class="text-center"><h5>所属站点</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>上线时间</h5></td><td class="text-center"><h5>下线时间</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in advs"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5><img ng-src="{{item.pic_url}}" class="thumbnail" width="80"></h5></td><td class="text-center"><h5 ng-repeat="pos_cn in item.pos_cn">{{item.pos_cn[0]}}</h5></td><td class="text-center"><h5><span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-info" ng-if="item.status == 2">待上线</span> <span class="label label-danger" ng-if="item.status == 0">已手动下线</span> <span class="label label-warning" ng-if="item.status == 3">已过期</span></h5></td><td class="text-center"><h5>{{item.site_cn}}</h5></td><td class="text-center"><h5>{{item.location_cn}}</h5><h5>{{item.line_cn}}</h5></td><td class="text-center"><h5>{{item.online_time}}</h5></td><td class="text-center"><h5>{{item.offline_time}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/ads/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/adsPosition/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 广告名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="pos.title" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 广告位状态</b></td><td class="success col-xs-12"><select ng-model="pos_status" class="col-xs-4 input-md form-control" ng-options="m.name for m in options.status" required=""></select></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add()">保存</button></div><div class="col-xs-6"></div></td></tr></table></div></div><div class="block-title"></div>'),t.put("app/modules/adsPosition/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.posCreate">发布广告位</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[\'all\']}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已启用 <span class="badge">{{total[1]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已禁用 <span class="badge">{{total[0]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入广告位描述"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td><h5><em class="text-danger">广告位id</em></h5></td><td class="text-center"><h5>广告位名称</h5></td><td class="text-center"><h5>广告位状态</h5></td><td class="text-center"><h5>上一次更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in positions"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5><span class="label label-success" ng-if="item.status == 1">已启用</span> <span class="label label-danger" ng-if="item.status == 0">已禁用</span></h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">禁用广告位</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">启用广告位</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/adsPosition/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/coupon/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="form-horizontal" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 规则信息</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="ruleInfo" disabled="" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 券活动名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="name" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 券码发放次数</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="couponNums" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属系统</b></td><td class="success col-xs-12"><select ng-model="site" class="col-xs-4 input-md form-control" ng-options="m.name for m in siteSrcs" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>所属城市</b></td><td class="success col-xs-12"><select ng-model="location" class="col-xs-4 input-md form-control" ng-options="m.name for m in locationInfo" ng-change="selectCity()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 可见性</b></td><td class="success col-xs-12"><select ng-model="visiable" class="col-xs-4 input-md form-control" ng-options="m.name for m in visiables" required=""></select></td></tr><tr ng-show="visiable.id == 2"><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属线路</b></td><td class="success col-xs-12"><div class="checkbox col-xs-3" ng-repeat="line in lines"><label><input type="checkbox" ng-model="line.checked"> {{line.name}}</label></div></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>有效时间段</b></td><td class="success col-xs-12"><div class="input-group"><span class="input-group-addon">从</span> <input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" max-date="endTime" ng-model="startTime" id="startTime" placeholder="点击获取时间" required=""> <span class="input-group-addon">至</span> <input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" min-date="startTime" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间" required=""></div></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>触发类型</b></td><td class="success col-xs-12"><select ng-model="couponTrigger" class="col-xs-4 input-md form-control" ng-options="m.name for m in couponTriggers" required=""></select></td></tr><tr><td class="active col-xs-2"><b>优惠对象</b></td><td class="success col-xs-12"><select ng-model="couponObject" class="col-xs-4 input-md form-control" ng-options="m.name for m in couponObjects"><option value="">--选择优惠对象--</option></select></td></tr><tr ng-if="couponObject.id == 1"><td class="active col-xs-2"><b><em class="text-danger">*</em>添加分类</b></td><td class="success col-xs-12"><div ng-repeat="item in category"><div class="col-xs-8"><input type="text" ng-model="item.value" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入分类名称或者分类id" ng-change="showProduct(item , \'category\')"><div ng-if="item.category"><ul class="list-group col-xs-12"><li class="list-group-item" ng-click="selectProduct(mitem, item , \'category\')" ng-repeat="mitem in item.category"><i class="text-danger">{{mitem.id}}</i>|<span class="text-default">{{mitem.name}}</span></li></ul></div></div><div class="col-xs-4"><span class="btn btn-lg {{item.cls}}" ng-click="{{item.clk}}(item , category)"><span class="glyphicon {{item.icon}}">{{item.name}}</span></span></div></div></td></tr><tr ng-if="couponObject.id == 2"><td class="active col-xs-2"><b><em class="text-danger">*</em>添加商品</b></td><td class="success col-xs-12"><div ng-repeat="item in products"><div class="col-xs-8"><input type="text" ng-model="item.value" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入商品名称或者sku" ng-change="showProduct(item , \'product\')"><div ng-if="item.products"><ul class="list-group col-xs-12"><li class="list-group-item" ng-click="selectProduct(mitem, item , \'product\')" ng-repeat="mitem in item.products"><i class="text-danger">{{mitem.sku_number}}</i>|<span>{{mitem.title}}</span>|<span class="text-default">{{mitem.price}}/{{mitem.unit}}</span></li></ul></div></div><div class="col-xs-4"><span class="btn btn-lg {{item.cls}}" ng-click="{{item.clk}}(item , products)"><span class="glyphicon {{item.icon}}">{{item.name}}</span></span></div></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/coupon/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待审核 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已生效 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已失效 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入券活动名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">券活动id</em></h5></td><td class="text-center"><h5>券活动名称</h5></td><td class="text-center"><h5>券活动类型</h5></td><td class="text-center"><h5>券活动状态</h5></td><td class="text-center"><h5>所属站点</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>可发放次数</h5></td><td class="text-center"><h5>已用数量</h5></td><td class="text-center"><h5>优惠券触发类型</h5></td><td class="text-center"><h5>优惠对象</h5></td><td class="text-center"><h5>有效时间段</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in coupons"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5 class="label label-warning">{{item.rule_type}}</h5></td><td class="text-center"><h5><span class="label label-default" ng-if="item.status == 2">待审核</span> <span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-danger" ng-if="item.status == 0">已下线</span></h5></td><td class="text-center"><h5>{{item.site_cn}}</h5></td><td class="text-center"><h5>{{item.location_cn}}</h5></td><td class="text-center"><h5>{{item.coupon_nums}}</h5></td><td class="text-center"><h5>{{item.coupon_used_nums}}</h5></td><td class="text-center"><h5>{{item.coupon_trigger_cn}}</h5></td><td class="text-center"><h5>{{item.category_cn}}</h5></td><td class="text-center"><h5><span class="label label-success">{{item.valid_time}}</span>至<span class="label label-success">{{item.invalid_time}}</span></h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a> <a ng-if="item.status == 1 && item.coupon_nums > 0 && item.coupon_type != 2" class="btn btn-info btn-sm btn_mb5" ui-sref="home.customerCouponAdd({couponId:item.id})">发券</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/coupon/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/coupon_rules/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 规则名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="name" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 规则类型</b></td><td class="success col-xs-12"><select ng-model="ruleType" class="col-xs-4 input-md form-control" ng-options="m.name for m in ruleTypes" required=""></select></td></tr><tr ng-show="ruleType.id==1"><td class="active col-xs-2"><b><em class="text-danger">*</em> {{ruleType.name}}规则</b></td><td class="success col-xs-12"><div class="input-group"><span class="input-group-addon">满</span> <input type="text" ng-model="requireAmount" class="form-control" aria-label="requireAmount"> <span class="input-group-addon">元，减</span> <input type="text" ng-model="minusAmount" class="form-control" aria-label="minusAmount"> <span class="input-group-addon">元</span></div></td></tr><tr ng-show="ruleType.id == 2"><td class="active col-xs-2"><b><em class="text-danger">*</em>{{ruleType.name}}规则</b></td><td class="success col-xs-12"><div class="input-group"><input type="text" ng-model="minusAmount" class="form-control" aria-label="minusAmount"> <span class="input-group-addon">元{{ruleType.name}}</span></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/coupon_rules/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.couponRuleAdd">发布规则</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待审核 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已下线 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入规则名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">规则id</em></h5></td><td class="text-center"><h5>规则名称</h5></td><td class="text-center"><h5>规则类型</h5></td><td class="text-center"><h5>规则状态</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in couponRules"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5>{{item.rule_type_cn}}</h5></td><td class="text-center"><h5><span class="label label-default" ng-if="item.status == 2">待审核</span> <span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-danger" ng-if="item.status == 0">已下线</span></h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a> <a ng-if="item.status == 1" class="btn btn-info btn-sm btn_mb5" ui-sref="home.couponAdd({ruleId:item.id})">发布券活动</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/coupon_rules/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/customer_coupon/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="form-horizontal" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 券活动信息</b></td><td class="success col-xs-12">{{couponName}}</td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属系统</b></td><td class="success col-xs-12">{{siteName}}</td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>所属城市</b></td><td class="success col-xs-12">{{locationName}}</td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 可见性</b></td><td class="success col-xs-12"><select ng-model="visiable" class="col-xs-4 input-md form-control" ng-options="m.name for m in visiables" required=""></select></td></tr><tr ng-if="visiable.id == 2"><td class="active col-xs-2"><b><em class="text-danger">*</em>添加指定用户</b></td><td class="success col-xs-12"><div ng-repeat="item in users"><div class="col-xs-8"><input type="text" ng-model="item.value" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入用户手机号"><div ng-if="item.products"><ul class="list-group col-xs-12"><li class="list-group-item" ng-click="selectUser(mitem, item)" ng-repeat="mitem in item.users"><i class="text-danger">{{mitem.mobile}}</i>|<span>{{mitem.shop_name}}</span></li></ul></div></div><div class="col-xs-4"><span class="btn btn-lg {{item.cls}}" ng-click="{{item.clk}}(item)"><span class="glyphicon {{item.icon}}">{{item.name}}</span></span></div></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/customer_coupon/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已禁用 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'3\');" ng-class="{\'btn-info\': status == \'3\'}" class="btn">已使用 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">可使用 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">不可用 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'4\');" ng-class="{\'btn-info\': status == \'4\'}" class="btn">已过期 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="用户手机号"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">券活动id</em></h5></td><td class="text-center"><h5>客户信息</h5></td><td class="text-center"><h5>券码</h5></td><td class="text-center"><h5>券码状态</h5></td><td class="text-center"><h5>所属站点</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>减免信息</h5></td><td class="text-center"><h5>有效时间段</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in coupons"><td><h5><em class="text-danger">{{item.id}}({{item.detail.rule_type_cn}})</em></h5></td><td class="text-center"><h5>{{item.customer_info.shop_name}}（{{item.customer_info.mobile}}）</h5></td><td class="text-center"><h5>{{item.coupon_code}}</h5></td><td class="text-center"><h5><span ng-if="item.status == 0" class="label label-info">{{item.status_cn}}</span> <span ng-if="item.status == 1" class="label label-success">{{item.status_cn}}</span> <span ng-if="item.status == 2" class="label label-default">{{item.status_cn}}</span> <span ng-if="item.status == 3" class="label label-warning">{{item.status_cn}}</span> <span ng-if="item.status == 4" class="label label-danger">{{item.status_cn}}</span></h5></td><td class="text-center"><h5>{{item.detail.site_cn}}</h5></td><td class="text-center"><h5>{{item.detail.location_cn}}</h5></td><td class="text-center"><h5 ng-if="item.require_amount > 0">满{{item.require_amount}} 元减免{{item.minus_amount}}元</h5><h5 ng-if="item.require_amount == 0">减免{{item.minus_amount}}元</h5></td><td class="text-center"><h5>{{item.detail.valid_time}}至{{item.detail.invalid_time}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">禁用</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/customer_coupon/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/home/achieve.html",'<div class="container-fluid" ng-controller="HomeAchieveCtrl"><div ng-include="\'components/navbar/navbar.html\'"></div><div id="row block-title"><div ng-include="\'components/navbar/navsidebar.html\'"></div><div class="col-xs-offset-2 col-xs-10"><div class="row block block-col text-center" ng-if="data==\'\'"><h5>暂无记录</h5></div><div ng-if="data"><table class="table table-bordered table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center"><h5>今日新增供应商</h5></td><td class="text-center"><h5>{{data.today_new_seller}}</h5></td><td class="text-center"><h5>总供应商</h5></td><td class="text-center"><h5>{{data.total_seller}}</h5></td></tr><tr><td class="text-center"><h5>今日新增采购商</h5></td><td class="text-center"><h5>{{data.today_new_buyer}}</h5></td><td class="text-center"><h5>总采购商</h5></td><td class="text-center"><h5>{{data.total_buyer}}</h5></td></tr><tr><td class="text-center"><h5>今日订单数</h5></td><td class="text-center"><h5>{{data.today_new_order}}</h5></td><td class="text-center"><h5>总订单数</h5></td><td class="text-center"><h5>{{data.total_order}}</h5></td></tr><tr><td class="text-center"><h5>今日订单金额</h5></td><td class="text-center"><h5>{{data.today_deal_amount}}&nbsp;元</h5></td><td class="text-center"><h5>总订单金额</h5></td><td class="text-center"><h5>{{data.total_deal_amount}}&nbsp;元</h5></td></tr><tr><td class="text-center"><h5>今日新商品数</h5></td><td class="text-center"><h5>{{data.today_new_product}}</h5></td><td class="text-center"><h5>总商品数</h5></td><td class="text-center"><h5>{{data.total_product}}</h5></td></tr></tbody></table></div></div></div></div>'),t.put("app/modules/home/home.html",'<div class="container-fluid" ng-controller="HomeCtrl"><div ng-include="\'components/navbar/navbar.html\'"></div><div id="row block-title"><div ng-include="\'components/navbar/navsidebar.html\'"></div><div ui-view=""></div></div></div>'),t.put("app/modules/memberRebate/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>客户详情</h5></div><tabs><pane title="基本信息"><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><tbody><tr><td class="text-center" width="10%"><h5>店铺名称</h5></td><td class="text-center" width="30%"><h5>{{info.shop_name}}</h5></td><td class="text-center" width="10%"><h5>所属系统</h5></td><td class="text-center" width="30%"><h5>{{info.site_name}}</h5></td><td class="text-center" rowspan="3"><image-box url="{{ info.image[0].url }}"><image-modal show="0" url="{{ info.image[0].url}},{{info.image[1].url }}"></image-modal></image-box></td></tr><tr><td class="text-center" width="10%"><h5>客户名称</h5></td><td class="text-center" width="30%"><h5>{{info.name}}</h5></td><td class="text-center" width="10%"><h5>店铺规模</h5></td><td class="text-center" width="30%"><h5>{{info.dimension_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>客户电话</h5></td><td class="text-center" width="30%"><h5>{{info.mobile}}</h5></td><td class="text-center" width="10%"><h5>所属城市</h5></td><td class="text-center" width="30%"><h5>{{info.city_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>注册时间</h5></td><td class="text-center" width="30%"><h5>{{info.created_time}}</h5></td><td class="text-center" width="10%"><h5>详细地址</h5></td><td class="text-center" width="30%"><h5>{{info.address}}</h5></td><td class="text-center" rowspan="3"><image-box url="{{info.image[1].url}}"><image-modal show="1" url="{{ info.image[0].url}},{{info.image[1].url }}"></image-modal></image-box></td></tr><tr><td class="text-center" width="10%"><h5>餐饮类别</h5></td><td class="text-center" width="30%"><h5>{{info.shop_type_name}}</h5></td><td class="text-center" width="10%"><h5>配送路线</h5></td><td class="text-center" width="30%"><h5>{{info.line_name}}</h5></td></tr><tr><td class="text-center" width="10%"><h5>所属销售</h5></td><td class="text-center" width="30%"><h5><p ng-if="info.sale.name">BD:{{info.sale.name}}</p><p ng-if="info.sale.mobile">电话:{{info.sale.mobile}}</p></h5></td><td class="text-center" width="10%"><h5>备注信息</h5></td><td class="text-center" width="30%"><h5>{{info.remark}}</h5></td></tr></tbody></table></div></pane></tabs><div><h3>配置折扣表</h3><h4>一级分类：</h4></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><tbody><tr><td class="text-center" width="10%"><h5>分类名称</h5></td><td class="text-center" width="30%"><h5>折扣率</h5></td><td class="text-center" width="10%"><h5>分类名称</h5></td><td class="text-center" width="30%"><h5>折扣率</h5></td></tr><tr ng-repeat="cate in groupCategories"><td class="text-center" width="10%"><h5>{{cate.group[0].name}}</h5></td><td class="text-center" width="30%"><div class="input-group"><input type="number" class="form-control" ng-model="cate.group[0].rebate"><div class="input-group-addon">%</div></div></td><td class="text-center" width="10%" ng-if="cate.group[1]"><h5>{{cate.group[1].name}}</h5></td><td class="text-center" width="30%" ng-if="cate.group[1]"><div class="input-group"><input type="number" class="form-control" ng-model="cate.group[1].rebate"><div class="input-group-addon">%</div></div></td></tr></tbody></table></div><div class="col-xs-12 btn-group form-group text-center"><button class="btn col-xs-2 btn-lg btn-warning" ng-click="func.reset();" type="reset">重置</button> <button class="btn col-xs-2 btn-lg btn-success" ng-click="func.saveRebate();">保存</button> <button class="btn col-xs-2 btn-lg btn-default" ng-click="func.back();">返回</button></div></div></div></div>'),t.put("app/modules/memberRebate/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>KA折扣列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select ng-model="location" class="form-control" ng-options="location.name for location in locations"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键字</div><input type="text" ng-model="key" class="form-control" placeholder="请输入关键字"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-4"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td class="text-center"><h5>KA商户名称</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>折扣详情</h5></td><td class="text-center"><h5>最后修改时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in list" class="text-center"><td><h5>{{item.shop_name}}</h5></td><td><h5>{{item.mobile}}</h5></td><td><span ng-repeat="rebate in item.rebates">{{rebate.category_name}} {{rebate.rebate}}%<br ng-show="($index + 1) % 2 == 0"></span></td><td><h5>{{item.operator}}<br>{{item.rebate_updated_time}}</h5></td><td><h5><a class="btn btn-success btn-sm btn_mb5" ng-href="/memberRebate/edit/{{item.id}}">编辑</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/product/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div ng-if="!product.id" class="row block mt-10 ml-default bs-callout"><form class="form-inline"><div class="form-group"><div class="input-group"><span class="input-group-addon" id="sizing-addon1">货号</span> <input type="text" ng-model="init.skuNumber" class="form-control" aria-describedby="sizing-addon1"></div><button ng-click="getSkuInfo(1)" class="btn btn-primary">检索</button> <button ng-click="getSkuInfo(0)" class="btn btn-danger">重置</button></div></form></div><form class="form-horizontal" novalidate="" role="form" id="addForm" name="addForm"><div ng-if="info" class="row block ml-default bs-callout form-horizontal"><table class="table white_bg"><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 采集类型</b></div><div class="col-xs-7 success"><select ng-model="default_collect_type" class="form-control" ng-change="select_collect_type(default_collect_type)" ng-options="item.name for item in collect_type_options"></select></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品货号</b></div><div class="col-xs-7 success"><input class="form-control" type="text" ng-model="product.skuNumber" required="" readonly=""></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> sku内部名称</b></div><div class="col-xs-7 success"><span>{{info.name}}</span></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品名称</b></div><div class="col-xs-7 success"><input class="form-control" type="text" ng-model="product.title" required=""></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b>描述和卖点</b></div><div class="col-xs-7 success"><input class="form-control" type="text" ng-model="product.advWords"></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> sku所属分类</b></div><div class="col-xs-7 success"><span class="">{{info.cate_name}}</span></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 售卖城市</b></div><div class="col-xs-7 success"><select ng-model="init.location" class="col-xs-4 input-md form-control" ng-options="location.name for location in locations" ng-change="selectCity()" required=""></select></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 客户类型可见</b></div><div class="col-xs-7 success"><select ng-model="init.customerVisiable" class="form-control" ng-options="item.name for item in customerVisiableOptions"></select></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 线路可见性</b></div><div class="col-xs-7 success"><select ng-model="init.visiable" class="col-xs-4 input-md form-control" ng-options="visiable.name for visiable in visiables" required=""></select></div></td></tr><tr ng-show="init.visiable.id == 2"><td class="col-xs-12" colspan="2"><div class="col-xs-2"><b><em class="text-danger">*</em> 所属线路</b></div><div class="col-xs-10 success"><div class="checkbox col-xs-3" ng-repeat="line in lines"><label><input type="checkbox" ng-model="line.checked"> {{line.name}}</label></div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 预定价</b></div><div class="col-xs-7 success"><div class="input-group"><input class="form-control inline" type="text" ng-model="product.price" required=""> <span class="input-group-addon" id="sizing-addon1">元</span></div></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 市场价</b></div><div class="col-xs-7 success"><div class="input-group"><input class="form-control" type="text" ng-model="product.marketPrice" required=""> <span class="input-group-addon" id="sizing-addon1">元</span></div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 售卖单位</b></div><div class="col-xs-7 success"><select ng-model="init.unit" class="col-xs-4 input-md form-control" ng-options="m.name for m in info.units" required=""></select></div></td><td class="col-xs-6"><div class="col-xs-5"><b>显示‘约’</b></div><div class="col-xs-7 success"><div class="checkbox"><label><input type="checkbox" ng-checked="init.isRound" ng-model="init.isRound"></label></div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b>每人限购</b></div><div class="col-xs-7 success"><div class="input-group"><input class="form-control" type="text" ng-model="product.buyLimit"> <span class="input-group-addon" id="sizing-addon1">{{init.unit.name}}</span></div></div></td><td class="col-xs-6"><div class="col-xs-5"><b>限购总数(-1代表无限购)</b></div><div class="col-xs-7 success"><div class="input-group"><input class="form-control" type="text" ng-model="product.storage"> <span class="input-group-addon" id="sizing-addon1">{{init.unit.name}}</span></div></div></td></tr><tr ng-if="info.spec.length"><td class="col-xs-6"><div class="col-xs-5"><b>基础属性</b></div><div class="col-xs-7 success"><h5 ng-repeat="item in info.spec" class="text-default">{{item.name}}: {{item.val}}</h5></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品上架状态</b></div><div class="col-xs-7 success"><select ng-model="init.productStatus" class="col-xs-4 input-md form-control" ng-options="m.name for m in info.product_status" required=""></select></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add()">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/product/detail.html",'<div class="col-xs-offset-2"><form class="form-horizontal" novalidate="" role="form" id="addForm" name="addForm"><div ng-if="info" class="row block ml-default bs-callout form-horizontal"><table class="table white_bg"><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 客户类型</b></div><div class="col-xs-7 success">{{default_type.name}}</div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 采集类型</b></div><div class="col-xs-7 success">{{default_collect_type.name}}</div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品货号</b></div><div class="col-xs-7 success">{{product.skuNumber}}</div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> sku所属分类</b></div><div class="col-xs-7 success"><span class="">{{info.cate_name}}</span></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> sku内部名称</b></div><div class="col-xs-7 success"><span>{{info.name}}</span></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品名称</b></div><div class="col-xs-7 success">{{product.title}}</div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b>描述和卖点</b></div><div class="col-xs-7 success">{{product.advWords}}</div></td><td class="col-xs-6"><div class="col-xs-5"><b>显示‘约’</b></div><div class="col-xs-7 success"><div class="checkbox"><label><input type="checkbox" ng-checked="init.isRound" ng-model="init.isRound"></label></div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 售卖城市</b></div><div class="col-xs-7 success">{{init.location.name}}</div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 可见性</b></div><div class="col-xs-7 success">{{init.visiable.name}}</div></td></tr><tr ng-show="init.visiable.id == 2"><td class="col-xs-12" colspan="2"><div class="col-xs-2"><b><em class="text-danger">*</em> 所属线路</b></div><div class="col-xs-10 success"><div class="checkbox col-xs-3" ng-repeat="line in lines"><label><input type="checkbox" readonly="" ng-model="line.checked"> {{line.name}}</label></div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 预定价</b></div><div class="col-xs-7 success"><div class="input-group">{{product.price}} 元</div></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 市场价</b></div><div class="col-xs-7 success"><div class="input-group">{{product.marketPrice}} 元</div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 售卖单位</b></div><div class="col-xs-7 success">{{init.unit.name}}</div></td><td class="col-xs-6"><div class="col-xs-5"><b>库存(-1代表充足库存)</b></div><div class="col-xs-7 success"><div class="input-group">{{product.storage}} {{init.unit.name}}</div></div></td></tr><tr><td class="col-xs-6"><div class="col-xs-5"><b>每人限购</b></div><div class="col-xs-7 success"><div class="input-group">{{product.buyLimit}} {{init.unit.name}}</div></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 结算单价</b></div><div class="col-xs-7 success"><div class="input-group">{{product.singlePrice}} 元 {{init.closeUnit.name}}</div></div></td></tr><tr ng-if="info.spec.length"><td class="col-xs-6"><div class="col-xs-5"><b>基础属性</b></div><div class="col-xs-7 success"><h5 ng-repeat="item in info.spec" class="text-default">{{item.name}}: {{item.val}}</h5></div></td><td class="col-xs-6"><div class="col-xs-5"><b><em class="text-danger">*</em> 商品上架状态</b></div><div class="col-xs-7 success">{{init.productStatus.name}}</div></td></tr></table><table class="table table-striped"><colgroup><col class="col-xs-3"><col class="col-xs-6"><col class="col-xs-3"></colgroup><tbody><tr><td class="text-center" colspan="3"><h5>商品操作日志</h5></td></tr><tr><td class="text-center"><h5><strong>处理时间</strong></h5></td><td class="text-center"><h5><strong>操作人</strong></h5></td></tr><tr><td class="text-center"><h5>{{product.opLog.created_time}}</h5></td><td class="text-center"><h5>[{{product.opLog.operator}}]</h5></td></tr></tbody></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/product/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.productAdd">发布商品</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上架 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待上架 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已下架 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><select ng-model="locate" class="form-control" ng-options="location.name for location in locations"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入商品名或货号"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">货号</em></h5></td><td class="text-center"><h5>商品名称</h5></td><td class="text-center"><h5>售卖价/市场价/单位</h5></td><td class="text-center"><h5>限购总数/每人限购</h5></td><td class="text-center"><h5>商品描述</h5></td><td class="text-center"><h5>城市可见</h5></td><td class="text-center"><h5>客户-线路可见</h5></td><td class="text-center"><h5>上一次更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in products"><td><h5><em class="text-danger">{{item.sku_number}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5><h5 ng-show="item.collect_type == 1" class="label label-default">预采</h5><h5 ng-show="item.collect_type == 2" class="label label-success">现采</h5><h5><span class="label label-success" ng-if="item.status == 1">已上架</span> <span class="label label-default" ng-if="item.status == 2">待上架</span> <span class="label label-danger" ng-if="item.status == 0">已下架</span></h5></td><td class="text-center"><h5><span ng-if="item.is_round == 1">约</span>{{item.price}}/{{item.market_price}} 元/{{item.unit}}</h5></td><td class="text-center"><h5 ng-if="item.storage">{{item.storage_cn}}</h5><h5 ng-if="item.buy_limit">{{item.buy_limit_cn}}</h5></td><td class="text-left text-danger"><h5 ng-repeat="it in item.spec">{{it.name}} : {{it.val}}</h5></td><td class="text-center"><h5>{{item.location_name}}</h5></td><td><h5 ng-if="item.visiable == 2">{{item.line_cn}}</h5><h5 ng-if="item.visiable != 2">{{item.visiable_cn}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5 ng-if="item.is_active == 1"><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setstatus({{item.id}}, 0, $index)">下架商品</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setstatus({{item.id}}, 1, $index)">上架商品</a> <a class="btn btn-primary btn_mb5 btn-sm" ui-sref="home.productEdit({productId:item.id})">编辑商品</a></h5><h5><a class="btn btn-info btn-sm btn_mb5" ui-sref="home.productDetail({productId:item.id})">商品详情</a> <a class="btn btn-info btn-sm btn_mb5" ui-sref="home.productSnap({productId:item.id})">商品快照</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/product/price.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">城市</div><select ng-model="location" class="form-control" ng-options="location.name for location in locations"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">分类</div><select ng-model="category" ng-selected="category" class="form-control" ng-options="category.name for category in categories"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">货号</div><input type="text" ng-model="key" class="form-control" placeholder="请输入货号"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="bs-callout"><button ng-show="showSync && !isEdit" class="btn btn-info m-block" ng-click="sync();">确认同步</button> <button class="btn m-block" ng-class="{true: \'btn-info\', false: \'btn-warning\'}[isEdit]" ng-click="edit();">{{editName}}</button></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">货号</em></h5></td><td class="text-center"><h5>商品名称</h5></td><td class="text-center"><h5>所属分类</h5></td><td class="text-center"><h5>城市</h5></td><td class="text-center"><h5>现价<br>(普通客户)</h5></td><td class="text-center"><h5>调整后价格<br>(普通用户)</h5></td><td class="text-center"><h5>更新时间</h5></td><td ng-show="isEdit" class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in products" class="text-center"><td><h5><em class="text-danger">{{item.sku_number}}</em></h5></td><td><h5 ng-if="isEdit">{{item.title}}</h5><h5 ng-if="!isEdit">{{item.product_name}}</h5></td><td><h5>{{item.top_category_name}}</h5></td><td><h5>{{item.location_name}}</h5></td><td><h5 ng-if="item.price != 0"><span ng-if="item.is_round == 1">约</span>{{item.price}} 元</h5><h5 ng-if="item.price == 0">--</h5></td><td><h5 ng-if="item.price != 0"><div class="input-group"><div ng-if="item.is_round == 1" class="input-group-addon">约</div><input ng-disabled="!isEdit" class="form-control" ng-model="item.dest_price"><div class="input-group-addon">元</div></div></h5><h5 ng-if="item.price == 0">--</h5></td><td><h5>{{item.operator}}<br>{{item.updated_time}}</h5></td><td ng-show="isEdit"><h5><a ng-if="1 == 1" class="btn btn-warning btn-sm btn_mb5" ng-click="save(item)">保存</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/product/snapshot.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">货号</em></h5></td><td class="text-center"><h5>商品名称</h5></td><td class="text-center"><h5>售卖价/市场价/单位</h5></td><td class="text-center"><h5>限购总数/每人限购</h5></td><td class="text-center"><h5>商品描述</h5></td><td class="text-center"><h5>城市可见</h5></td><td class="text-center"><h5>客户-线路可见</h5></td><td class="text-center"><h5>上一次更新时间</h5></td><td class="text-center"><h5>操作人</h5></td></tr></thead><tbody><tr ng-repeat="item in products"><td><h5><em class="text-danger">{{item.sku_number}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5><h5 ng-show="item.collect_type == 1" class="label label-default">预采</h5><h5 ng-show="item.collect_type == 2" class="label label-success">现采</h5><h5><span class="label label-success" ng-if="item.status == 1">已上架</span> <span class="label label-default" ng-if="item.status == 2">待上架</span> <span class="label label-danger" ng-if="item.status == 0">已下架</span></h5></td><td class="text-center"><h5><span ng-if="item.is_round == 1">约</span>{{item.price}}/{{item.market_price}} 元/{{item.unit}}</h5></td><td class="text-center"><h5 ng-if="item.storage">{{item.storage_cn}}</h5><h5 ng-if="item.buy_limit">{{item.buy_limit_cn}}</h5></td><td class="text-left text-danger"><h5 ng-repeat="it in item.spec">{{it.name}} : {{it.val}}</h5></td><td class="text-center"><h5>{{item.location_name}}</h5></td><td><h5 ng-if="item.visiable == 2">{{item.line_cn}}</h5><h5 ng-if="item.visiable != 2">{{item.visiable_cn}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5>{{item.operator}}</h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/product/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/recommends/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 客户类型</b></td><td class="success col-xs-12"><select ng-model="defaultType" class="form-control" ng-options="item.name for item in customerTypeOptions"></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 首页推荐名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="name" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属系统</b></td><td class="success col-xs-12"><select ng-model="site" class="col-xs-4 input-md form-control" ng-options="m.name for m in siteSrcs" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>所属城市</b></td><td class="success col-xs-12"><select ng-model="location" class="col-xs-4 input-md form-control" ng-options="m.name for m in locationInfo" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>上线时间</b></td><td class="success col-xs-12"><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" max-date="endTime" ng-model="startTime" id="startTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>下线时间</b></td><td class="success col-xs-12"><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" min-date="startTime" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>添加商品</b></td><td class="success col-xs-12"><div ng-repeat="item in products"><div class="col-xs-8"><input type="text" ng-model="item.value" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入商品名称或者sku" ng-change="showProduct(item)"><div ng-if="item.products"><ul class="list-group col-xs-12"><li class="list-group-item" ng-click="selectProduct(mitem, item)" ng-repeat="mitem in item.products"><i class="text-danger">{{mitem.sku_number}}</i>|<span>{{mitem.title}}</span>|<span class="text-default">{{mitem.price}}/{{mitem.unit}}</span></li></ul></div></div><div class="col-xs-4"><span class="btn btn-lg {{item.cls}}" ng-click="{{item.clk}}(item)"><span class="glyphicon {{item.icon}}">{{item.name}}</span></span></div></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/recommends/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.recommendCreate">发布首页推荐</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">待下线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'0\');" ng-class="{\'btn-info\': status == \'0\'}" class="btn">已下线 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入推荐名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-4"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">推荐id</em></h5></td><td class="text-center"><h5>推荐名称</h5></td><td class="text-center"><h5>推荐商品</h5></td><td class="text-center"><h5>状态</h5></td><td class="text-center"><h5>所属站点</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>开始时间</h5></td><td class="text-center"><h5>结束时间</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in advs"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td><h5 ng-repeat="product in item.products">{{product.sku_number}}：{{product.title}}({{product.price}}元/{{product.unit}})</h5></td><td class="text-center"><h5><span class="label label-default" ng-if="item.status == 2">待上线</span> <span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-danger" ng-if="item.status == 0">已下线</span></h5></td><td class="text-center"><h5>{{item.site_cn}}</h5></td><td class="text-center"><h5>{{item.location_cn}}</h5></td><td class="text-center"><h5>{{item.online_time_cn}}</h5></td><td class="text-center"><h5>{{item.offline_time_cn}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/recommends/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/storage/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><select ng-init="location = locations[0]" ng-model="location" class="form-control" ng-options="location.name for location in locations"></select></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="输入SKU货号或仓库ID"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"></colgroup><thead><tr><td><h5><em class="text-danger">货号</em></h5></td><td class="text-center"><h5>货品名称</h5></td><td class="text-center"><h5>仓库id</h5></td><td class="text-center"><h5>仓库</h5></td><td class="text-center"><h5>在库库存</h5></td><td class="text-center"><h5>订单库存</h5></td><td class="text-center"><h5>可售库存</h5></td><td class="text-center"><h5>虚拟库存</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in products | filter:filter.sku_number"><td><h5><em class="text-danger">{{item.sku_number}}</em></h5></td><td class="text-center"><h5>{{item.sku_name}}</h5></td><td class="text-center"><h5>{{item.warehouse_id}}</h5></td><td class="text-center"><h5>{{item.warehouse_name}}</h5></td><td class="text-center"><h5>{{item.in_stock}}</h5></td><td class="text-center"><h5>{{item.stock_locked}}</h5></td><td class="text-center"><h5>{{item.sellable}}</h5></td><td class="text-center"><input type="text" ng-if="item.editing" ng-model="item.virtual_stock" class="form-control"><h5 ng-if="!item.editing">{{item.virtual_stock}}</h5></td><td class="text-center"><h5><a class="btn btn-primary btn_mb5 btn-sm" ng-show="!item.editing" ng-click="edit_storage(item)"><span class="glyphicon glyphicon-floppy-open m-r-5"></span>编辑</a> <a class="btn btn-warning btn_mb5 btn-sm" ng-show="item.editing" ng-click="cancel_storage(item)"><span class="glyphicon glyphicon-ban-circle m-r-5"></span>取消</a> <a class="btn btn-success btn_mb5 btn-sm" ng-show="item.editing" ng-click="save_storage(item)"><span class="glyphicon glyphicon-floppy-save m-r-5"></span>保存</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/subjects/add.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <h2 class="text-center">{{items.bodyText}}</h2> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="ok()" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><form class="" novalidate="" role="form" id="addForm" name="addForm"><div class="row block ml-default bs-callout"><table class="table table-striped"><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 专题名称</b></td><td class="success col-xs-12"><input class="form-control" type="text" ng-model="name" required=""></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em> 所属系统</b></td><td class="success col-xs-12"><select ng-model="site" class="col-xs-4 input-md form-control" ng-options="m.name for m in siteSrcs" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>所属城市</b></td><td class="success col-xs-12"><select ng-model="location" class="col-xs-4 input-md form-control" ng-options="m.name for m in locationInfo" ng-change="getMaps()" required=""></select></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>上线时间</b></td><td class="success col-xs-12"><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" max-date="endTime" ng-model="startTime" id="startTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>下线时间</b></td><td class="success col-xs-12"><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" min-date="startTime" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></td></tr><tr><td class="active col-xs-2"><b><em class="text-danger">*</em>专题类型</b></td><td class="success col-xs-12"><select ng-model="subjectType" class="col-xs-4 input-md form-control" ng-options="m.name for m in subjectTypes" required=""></select></td></tr><tr ng-show="subjectType.id == 1"><td>专题图片</td><td><div class="col-xs-12"><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">上传专题图片</span></span></div><div class="panel panel-default" ng-if="imgUploads.length"><div class="panel-heading">当前专题图片</div><div class="panel-body"><table class="table table-striped files"><tr ng-repeat="files in imgUploads"><td><div class="col-xs-6 col-md-3"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"></div></td><td>{{files.name}}</td><td><div class="btn btn-warning cancel" ng-click="picCancel(files, 0)"><i class="glyphicon glyphicon-ban-circle"></i> <span>取消</span></div></td></tr></table></div></div></td></tr><tr ng-show="subjectType.id != 1"><td>banner图片</td><td><div class="col-xs-12"><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="files">上传banner图片</span></span></div><div class="panel panel-default" ng-if="imgUploads.length"><div class="panel-heading">当前banner图片</div><div class="panel-body"><table class="table table-striped files"><tr ng-repeat="files in imgUploads"><td><div class="col-xs-6 col-md-3"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"></div></td><td>{{files.name}}</td><td><div class="btn btn-warning cancel" ng-click="picCancel(files, 0)"><i class="glyphicon glyphicon-ban-circle"></i> <span>取消</span></div></td></tr></table></div></div></td></tr><tr ng-show="subjectType.id != 1"><td>页尾图片</td><td><div class="col-xs-12"><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span class="button" ng-file-select="" ng-model="detailImg">上传页尾图片</span></span></div><div class="panel panel-default" ng-if="detailUploads.length"><div class="panel-heading">当前上传图片</div><div class="panel-body"><table class="table table-striped files"><tr ng-repeat="files in detailUploads"><td><div class="col-xs-6 col-md-3"><img width="100" ng-show="files.dataUrl != null" ng-src="{{files.dataUrl}}" class="thumbnail"></div></td><td>{{files.name}}</td><td><div class="btn btn-warning cancel" ng-click="picCancel(files, 1)"><i class="glyphicon glyphicon-ban-circle"></i> <span>取消</span></div></td></tr></table></div></div></td></tr><tr ng-if="subjectType.id != 1"><td class="active col-xs-2"><b><em class="text-danger">*</em>添加商品</b></td><td class="success col-xs-12"><div ng-repeat="item in products"><div class="col-xs-8"><input type="text" ng-model="item.value" class="form-control" name="name_value" id="name_value" required="" placeholder="请输入商品名称或者sku" ng-change="showProduct(item)"><div ng-if="item.products"><ul class="list-group col-xs-12"><li class="list-group-item" ng-click="selectProduct(mitem, item)" ng-repeat="mitem in item.products"><i class="text-danger">{{mitem.sku_number}}</i>|<span>{{mitem.title}}</span>|<span class="text-default">{{mitem.price}}/{{mitem.unit}}</span></li></ul></div></div><div class="col-xs-4"><span class="btn btn-lg {{item.cls}}" ng-click="{{item.clk}}(item)"><span class="glyphicon {{item.icon}}">{{item.name}}</span></span></div></div></td></tr><tr><td>&nbsp;</td><td><div class="col-xs-6"><button type="submit" class="btn btn-block btn-success btn-md" ng-click="add(addForm)">保存</button></div><div class="col-xs-6"><button type="reset" class="btn btn-block btn-default btn-md" ng-click="reset()">重置</button></div></td></tr></table></div></form></div><div class="block-title"></div>'),t.put("app/modules/subjects/list.html",'<div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>{{title}}</h5></div><div class="bs-callout"><div class="mt-10"><div class="form-group row"><div class="col-xs-4"><a class="btn-block btn btn-info" ui-sref="home.subCreate">发布专题</a></div></div></div><div class="block mt-10"><a ng-click="filterByStatus(\'all\');" ng-class="{\'btn-info\': status == \'all\'}" class="btn">全部 <span class="badge">{{total[4]}}</span></a> <a ng-click="filterByStatus(\'1\');" ng-class="{\'btn-info\': status == \'1\'}" class="btn">已上线 <span class="badge">{{total[2]}}</span></a> <a ng-click="filterByStatus(\'2\');" ng-class="{\'btn-info\': status == \'2\'}" class="btn">已下线 <span class="badge">{{total[2]}}</span></a></div><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><div class="input-group"><div class="input-group-addon">关键词</div><input type="text" ng-model="key" class="form-control" placeholder="请输入专题名称"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset();">重置</button></div></form></div></div><div class="table-responsive" style="margin-top:10px;"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"></colgroup><thead><tr><td><h5><em class="text-danger">专题id</em></h5></td><td class="text-center"><h5>专题名称</h5></td><td class="text-center"><h5>专题类型</h5></td><td class="text-center"><h5>图片</h5></td><td class="text-center"><h5>专题状态</h5></td><td class="text-center"><h5>所属站点</h5></td><td class="text-center"><h5>所属城市</h5></td><td class="text-center"><h5>开始时间</h5></td><td class="text-center"><h5>结束时间</h5></td><td class="text-center"><h5>更新时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody><tr ng-repeat="item in advs"><td><h5><em class="text-danger">{{item.id}}</em></h5></td><td class="text-center"><h5>{{item.title}}</h5></td><td class="text-center"><h5>{{item.subject_type_cn}}</h5></td><td class="text-center"><h5 ng-if="item.pic_url"><img ng-src="http://chart.apis.google.com/chart?cht=qr&amp;chs=300x300&amp;choe=UTF-8&amp;chld=M|1&amp;chl=chu.dachuwang.com/subject/{{item.id}}" class="thumbnail" width="150"></h5></td><td class="text-center"><h5><span class="label label-default" ng-if="item.status == 2">待上线</span> <span class="label label-success" ng-if="item.status == 1">已上线</span> <span class="label label-danger" ng-if="item.status == 0">已下线</span></h5></td><td class="text-center"><h5>{{item.site_cn}}</h5></td><td class="text-center"><h5>{{item.location_cn}}</h5></td><td class="text-center"><h5>{{item.online_time_cn}}</h5></td><td class="text-center"><h5>{{item.offline_time_cn}}</h5></td><td class="text-center"><h5>{{item.updated_time}}</h5></td><td class="text-center"><h5><a ng-if="item.status == 1" class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus(item, 0)">下线</a> <a ng-if="item.status != 1" class="btn btn-success btn-sm btn_mb5" ng-click="setStatus(item, 1)">上线</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div>'),t.put("app/modules/subjects/tips.html",'<script type="text/ng-template" id="myModalContent.html"><div class="modal-header"> <h3 class="modal-title">{{items.headerText}}</h3> </div> <div class="modal-body"> <div class="row form-horizontal"> <div class="col-xs-12 form-group"> <select ng-model="selectCity" ng-change="items.cityChange(selectCity)" class="form-control" ng-options="item.name for item in items.bodyText"> <option value="">请选择所在城市</option> </select> </div> <div class="col-xs-12 form-group"> <select ng-model="selectMarket" class="form-control" ng-options="item.name for item in items.markets"> <option value="">请选择所在市场</option> </select> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" ng-click="items.ok(selectCity, selectMarket);cancel();" ng-if="items.actionText"> {{items.actionText}} </button> <button class="btn btn-warning" ng-click="cancel()">{{items.closeText}}</button> </div></script>'),t.put("app/modules/user/create.html",'<div class="container-fluid" ng-controller="UserCreateCtrl"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>添加用户</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.dept.$error.required">请选择部门！</li><li ng-show="basic_form.role.$error.required">请选择用户角色！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li><li ng-show="basic_form.province.$error.required">请选择所在地！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-2 control-label">所属部门：</label><div class="col-sm-10"><select ng-model="data.dept" class="form-control" name="dept" ng-options="m.pre_name for m in dept_list" required=""><option value="">请选择用户所属部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">用户角色：</label><div class="col-sm-10"><select ng-model="data.role" class="form-control" name="role" ng-options="m.name for m in role_list" required=""><option value="">请选择用户角色类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="data.mobile" name="mobile" class="form-control" placeholder="请输入手机号码" required="" ng-pattern="/^[1-9]{1}[0-9]{10}$/"></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所在地：</label><div class="col-sm-10"><select ng-model="data.province" class="form-control" name="province" ng-options="m.name for m in province_list" ng-change="get_market(\'province\');" required=""><option value="">选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：</label><div class="col-sm-10"><input type="text" ng-model="data.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="create();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/user/edit.html",'<div class="container-fluid"><div class="width_change" id="row block-title"><div class="col-sm-offset-2 col-sm-10 col-xs-12"><div class="bs-callout bs-callout-danger"><h5>编辑用户</h5></div><div class="form-group" ng-show="basic_form.$invalid && basic_form.$dirty && show_error"><div class="col-sm-12"><div class="alert alert-danger"><ul><li ng-show="basic_form.dept.$error.required">请选择部门！</li><li ng-show="basic_form.role.$error.required">请选择用户角色！</li><li ng-show="basic_form.mobile.$error.required">请输入手机号码！</li><li ng-show="basic_form.mobile.$error.pattern">手机号码格式不对！</li><li ng-show="basic_form.name.$error.required">请输入用户姓名！</li><li ng-show="basic_form.province.$error.required">请选择所在地！</li></ul></div></div></div><div class="block mt-10 ml-default"><form class="form-horizontal showcase-form" role="form" id="basic_form" name="basic_form"><div class="form-group"><label class="col-sm-2 control-label">所属部门：</label><div class="col-sm-10"><select ng-model="data.dept" class="form-control" name="dept" ng-options="m.pre_name for m in dept_list" required=""><option value="">请选择用户所属部门</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">用户角色：</label><div class="col-sm-10"><select ng-model="data.role" class="form-control" name="role" ng-options="m.name for m in role_list" required=""><option value="">请选择用户角色类型</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">手机号：</label><div class="col-sm-10"><input type="text" ng-model="data.mobile" name="mobile" class="form-control" placeholder="请输入手机号码" required="" ng-pattern="/^[1-9]{1}[0-9]{10}$/"></div></div><div class="form-group"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-10"><input type="text" name="name" ng-model="data.name" class="form-control" placeholder="请输入姓名" required=""></div></div><div class="form-group"><label class="col-sm-2 control-label">所在地：</label><div class="col-sm-10"><select ng-model="data.province" class="form-control" name="province" ng-options="m.name for m in province_list" ng-change="get_market(\'province\');" required=""><option value="">选择省份</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">详细地址：</label><div class="col-sm-10"><input type="text" ng-model="data.address" class="form-control" placeholder="请输入详细地址"></div></div><div class="form-group"><button class="btn btn-info btn-lg col-sm-3 col-sm-offset-1" ng-click="edit();">提交</button> <button class="btn btn-warning btn-lg col-sm-3 col-sm-offset-1" ng-click="reset()">重置</button></div></form></div></div></div></div>'),t.put("app/modules/user/list.html",'<div class="container-fluid" ng-controller="UserListCtrl"><div class="width_change" id="row block-title"><div class="col-xs-offset-2"><div class="bs-callout bs-callout-danger"><h5>用户列表</h5></div><div class="bs-callout"><div class="block mt-10 ml-default"><form class="form-inline" role="form"><div class="form-group"><select ng-model="role" class="form-control" name="role" ng-options="m.name for m in role_list"><option value="">请选择角色类型</option></select></div><div class="form-group"><div class="input-group"><input type="text" ng-model="searchValue" class="form-control" placeholder="请输入搜索关键词"><div class="input-group-addon">起始时间</div><input type="text" is-open="opened" datepicker-popup="yyyy-MM-dd" ng-click="open($event)" datepicker-options="dateOptions" class="form-control" ng-model="startTime" id="startTime" placeholder="点击获取时间"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon">截止时间</div><input type="text" ng-model="endTime" class="form-control" datepicker-popup="yyyy-MM-dd" datepicker-options="endDateOptions" ng-click="endOpen($event)" is-open="endOpened" id="endTime" placeholder="点击获取时间"></div></div><div class="form-group"><button class="btn-block btn btn-info" ng-click="search();">筛选</button></div><div class="form-group"><button class="btn btn-block btn-warning" ng-click="reset()">重置</button></div><div class="form-group"><button class="btn btn-block btn-primary" ng-click="exportData()">导出数据</button></div><div class="form-group"><a class="btn btn-primary btn-sm" href="/user/create">添加用户</a></div></form></div></div><div style="margin-top:10px;" class="table-responsive"><table class="table table-bordered table-striped table-hover"><colgroup><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-1"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-2"><col class="col-xs-3"></colgroup><thead><tr><td class="text-center"><h5>编号</h5></td><td class="text-center"><h5>姓名</h5></td><td class="text-center"><h5>角色</h5></td><td class="text-center"><h5>手机号</h5></td><td class="text-center"><h5>注册时间</h5></td><td class="text-center"><h5>操作</h5></td></tr></thead><tbody ng-if="list.length===0"><tr><td colspan="8" class="text-center"><h5>暂无数据</h5></td></tr></tbody><tbody ng-if="list.length>0"><tr ng-repeat="item in list"><td class="text-center"><h5>{{item.id}}</h5></td><td class="text-center"><h5>{{item.name}}</h5></td><td class="text-center"><h5>{{item.role}}</h5></td><td class="text-center"><h5>{{item.mobile}}</h5></td><td class="text-center"><h5>{{item.created_time}}</h5></td><td class="text-center"><h5><a class="btn btn-info btn-sm btn_mb5" href="/user/edit/{{item.id}}">编辑用户</a> <a class="btn btn-danger btn-sm btn_mb5" ng-click="setStatus($index, 0)" ng-if="item.status == 1">禁用账号</a> <a class="btn btn-success btn-sm btn_mb5" ng-click="setStatus($index, 1)" ng-if="item.status == 0">启用账号</a> <a class="btn btn-info btn-sm btn_mb5" ng-click="resetPassword($index)">重置密码</a></h5></td></tr></tbody></table></div><nav><dachu-pagination conf="paginationConf"></dachu-pagination></nav></div></div></div>'),t.put("app/modules/user/login.html",'<div class="container-fluid"><div ng-include="\'components/navbar/navbar.html\'" ng-init="isLogin=\'false\'"></div><div class="row login_b show-grid"><div class="col-md-12 col-xs-12"><div class="clogin col-md-4 col-md-offset-4"><h3 class="clogin_h3" ng-controller="TopCtrl">{{title}}</h3><p ng-show="error" class="{{error.cls}}">{{error.msg}}</p><form class="row block block-col form-horizontal" name="loginForm" role="form" novalidate="" ng-submit="login()"><div class="form-group c_loginb col-xs-12"><div class="col-sm-12"><input type="tel" required="" class="input-lg form-control" ng-model="user.mobile" ng-pattern="/^1[3|5|6|7|8|9]\\d{9}$/" ng-minlength="11" ng-maxlength="11" name="mobile" id="tel" placeholder="请输入手机号"><div class="col-xs-12 block-col label label-danger" ng-show="(loginForm.submitted || loginForm.mobile.$dirty) && loginForm.mobile.$invalid"><small ng-show="loginForm.mobile.$error.minlength">请输入正确的手机号</small> <small ng-show="!loginForm.mobile.$error.minlength && loginForm.mobile.$error.pattern">手机号格式不正确</small> <small ng-show="loginForm.mobile.$error.required">手机号必填</small></div></div></div><div class="form-group c_loginb col-xs-12"><div class="col-sm-12"><input type="password" required="" class="input-lg form-control" ng-minlength="6" ng-model="user.password" name="password" id="password" placeholder="请输入密码"><div class="col-xs-12 block-col label label-danger" ng-show="loginForm.submitted && loginForm.password.$invalid"><small ng-show="loginForm.password.$error.minlength">密码至少6位</small> <small ng-show="loginForm.password.$error.required">密码必填</small></div></div></div><div class="form-group col-xs-12"><div class="col-sm-12"><button type="submit" class="btn btn-success btn-block">登录</button></div></div></form></div></div></div></div>')
}]);